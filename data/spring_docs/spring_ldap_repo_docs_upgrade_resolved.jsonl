{"id": "sha256:477cd24e136a77a128d1991789dde1781be97e176bb14bc0cf645eaf382e7fca", "content": "[[adding-missing-overloaded-api-methods]]\n\nThis section covers how to add your own overloaded API methods to implement new functionality.\n\n[[implementing-custom-search-methods]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/adding-missing-overloaded-api-methods.adoc", "title": "adding-missing-overloaded-api-methods", "heading": "adding-missing-overloaded-api-methods", "heading_level": 1, "file_order": 0, "section_index": 0, "content_hash": "477cd24e136a77a128d1991789dde1781be97e176bb14bc0cf645eaf382e7fca", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/adding-missing-overloaded-api-methods.adoc"}}
{"id": "sha256:098f90a18d8da76d64fc9d92439ff78621b98259613118ee1d6b245dd194c30e", "content": "`LdapTemplate` contains several overloaded versions of the most common operations in `DirContext`. However, we have not provided an alternative for each and every method signature, mostly because there are so many of them. We have, however, provided a means to call whichever `DirContext` method you want and still get the benefits that `LdapTemplate` provides.\n\nSuppose you want to call the following `DirContext` method:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nNamingEnumeration search(Name name, String filterExpr, Object[] filterArgs, SearchControls ctls)\n----\n====\n\nThere is no corresponding overloaded method in `LdapTemplate`. The way to solve this is to use a custom `SearchExecutor` implementation, as follows:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic interface SearchExecutor {\n public NamingEnumeration executeSearch(DirContext ctx) throws NamingException;\n}\n----\n====\n\nIn your custom executor, you have access to a `DirContext` object, which you can use to call the method you want. You can then provide a handler that is responsible for mapping attributes and collecting the results. You can, for example, use one of the available implementations of `CollectingNameClassPairCallbackHandler`, which collects the mapped results in an internal list. In order to actually perform the search, you need to call the `search` method in `LdapTemplate` that takes an executor and a handler as arguments. Finally, you need to return whatever your handler has collected. The following example shows how to do all of that:\n\n.A custom search method using `SearchExecutor` and `AttributesMapper`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n ...\n public List search(final Name base, final String filter, final String[] params,\n final SearchControls ctls) {\n **SearchExecutor executor = new SearchExecutor() {\n public NamingEnumeration executeSearch(DirContext ctx) {\n return ctx.search(base, filter, params, ctls);\n }\n };**\n\n CollectingNameClassPairCallbackHandler handler =\n new AttributesMapperCallbackHandler(new PersonAttributesMapper());\n\n ldapTemplate.search(**executor**, handler);\n return handler.getList();\n }\n}\n----\n====\n\nIf you prefer the `ContextMapper` to the `AttributesMapper`, the following example shows what it would look like:\n\n.A custom search method using `SearchExecutor` and `ContextMapper`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n ...\n public List search(final Name base, final String filter, final String[] params,\n final SearchControls ctls) {\n SearchExecutor executor = new SearchExecutor() {\n public NamingEnumeration executeSearch(DirContext ctx) {\n return ctx.search(base, filter, params, ctls);\n }\n };\n\n CollectingNameClassPairCallbackHandler handler =\n **new ContextMapperCallbackHandler(new PersonContextMapper()**);\n\n ldapTemplate.search(executor, handler);\n return handler.getList();\n }\n}\n----\n====\n\nNOTE: When you use the `ContextMapperCallbackHandler`, you must make sure that you have called `setReturningObjFlag(true)` on your `SearchControls` instance.\n\n[[implementing-other-custom-context-methods]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/adding-missing-overloaded-api-methods.adoc", "title": "adding-missing-overloaded-api-methods", "heading": "Implementing Custom Search Methods", "heading_level": 2, "file_order": 0, "section_index": 1, "content_hash": "098f90a18d8da76d64fc9d92439ff78621b98259613118ee1d6b245dd194c30e", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/adding-missing-overloaded-api-methods.adoc"}}
{"id": "sha256:6d88d6784992ff5baf18983399a525196079c877eabbe045a4b400c26fa0c2b2", "content": "In the same manner as for custom `search` methods, you can actually call any method in `DirContext` by using a `ContextExecutor`, as follows:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic interface ContextExecutor {\n public Object executeWithContext(DirContext ctx) throws NamingException;\n}\n----\n====\n\nWhen implementing a custom `ContextExecutor`, you can choose between using the `executeReadOnly()` or the `executeReadWrite()` method. Suppose you want to call the following method:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nObject lookupLink(Name name)\n----\n====\n\nThe method is available in `DirContext`, but there is no matching method in `LdapTemplate`. It is a lookup method, so it should be read-only. We can implement it as follows:\n\n.A custom `DirContext` method using `ContextExecutor`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n ...\n public Object lookupLink(final Name name) {\n ContextExecutor executor = new ContextExecutor() {\n public Object executeWithContext(DirContext ctx) {\n return ctx.lookupLink(name);\n }\n };\n\n return ldapTemplate.executeReadOnly(executor);\n }\n}\n----\n====\n\nIn the same manner, you can perform a read-write operation by using the `executeReadWrite()` method.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/adding-missing-overloaded-api-methods.adoc", "title": "adding-missing-overloaded-api-methods", "heading": "Implementing Other Custom Context Methods", "heading_level": 2, "file_order": 0, "section_index": 2, "content_hash": "6d88d6784992ff5baf18983399a525196079c877eabbe045a4b400c26fa0c2b2", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/adding-missing-overloaded-api-methods.adoc"}}
{"id": "sha256:5f6bb1d23548a47757c33bc67b3b8b1b9d89f89cf85233bbeddaa1c1c018bc5b", "content": "[[community]]\n\nWelcome to the Spring Security Community!\nThis section discusses how you can make the most of our vast community.\n\n[[community-help]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/community.adoc", "title": "community", "heading": "community", "heading_level": 1, "file_order": 1, "section_index": 0, "content_hash": "5f6bb1d23548a47757c33bc67b3b8b1b9d89f89cf85233bbeddaa1c1c018bc5b", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/community.adoc"}}
{"id": "sha256:e7ca9cf450b9826c2b04251ecfdc3779a351139be3581deade22acc71cbcab99", "content": "If you need help with Spring Security, we are here to help.\nThe following are some of the best ways to get help:\n\n* Read through this documentation.\n* Try one of our many https://github.com/spring-projects/spring-ldap-samples[sample applications].\n* Ask a question on https://stackoverflow.com/questions/tagged/spring-security[https://stackoverflow.com] with the `spring-security` tag.\n* Report bugs and enhancement requests at https://github.com/spring-projects/spring-security/issues\n\n[[community-becoming-involved]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/community.adoc", "title": "community", "heading": "Getting Help", "heading_level": 2, "file_order": 1, "section_index": 1, "content_hash": "e7ca9cf450b9826c2b04251ecfdc3779a351139be3581deade22acc71cbcab99", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/community.adoc"}}
{"id": "sha256:fccd5fbd23e026a78ce05f84a3778b1f48b3ed2fd42208eea162d544195ac8f5", "content": "We welcome your involvement in the Spring Security project.\nThere are many ways to contribute, including answering questions on Stack Overflow, writing new code, improving existing code, assisting with documentation, developing samples or tutorials, reporting bugs, or simply making suggestions.\nFor more information, see our https://github.com/spring-projects/spring-security/blob/main/CONTRIBUTING.adoc[Contributing] documentation.\n\n[[community-source]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/community.adoc", "title": "community", "heading": "Becoming Involved", "heading_level": 2, "file_order": 1, "section_index": 2, "content_hash": "fccd5fbd23e026a78ce05f84a3778b1f48b3ed2fd42208eea162d544195ac8f5", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/community.adoc"}}
{"id": "sha256:5e4ca7a7b31affd7ae7485584948d1d42480f5906e780897f97120ce2b1d7e1a", "content": "You can find Spring Security's source code on GitHub at https://github.com/spring-projects/spring-security/\n\n[[community-license]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/community.adoc", "title": "community", "heading": "Source Code", "heading_level": 2, "file_order": 1, "section_index": 3, "content_hash": "5e4ca7a7b31affd7ae7485584948d1d42480f5906e780897f97120ce2b1d7e1a", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/community.adoc"}}
{"id": "sha256:251a9e0afbdacb7567a2da0dc36ab25e54848fa59e7859cb7f1b1ae26ccbeef6", "content": "Spring Security is Open Source software released under the https://www.apache.org/licenses/LICENSE-2.0.html[Apache 2.0 license].", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/community.adoc", "title": "community", "heading": "Apache 2 License", "heading_level": 2, "file_order": 1, "section_index": 4, "content_hash": "251a9e0afbdacb7567a2da0dc36ab25e54848fa59e7859cb7f1b1ae26ccbeef6", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/community.adoc"}}
{"id": "sha256:70451f52bcbd68fd28d74a9053612651eba5aa124f556994e113db19b26c1609", "content": "You can follow https://twitter.com/SpringSecurity[@SpringSecurity] and the https://twitter.com/SpringSecurity/lists/team[Spring Security team] on Twitter to stay up to date with the latest news.\nYou can also follow https://twitter.com/SpringCentral[@SpringCentral] to keep up to date with the entire Spring portfolio.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/community.adoc", "title": "community", "heading": "Social Media", "heading_level": 2, "file_order": 1, "section_index": 5, "content_hash": "70451f52bcbd68fd28d74a9053612651eba5aa124f556994e113db19b26c1609", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/community.adoc"}}
{"id": "sha256:e1f212f1fff38be208e7a34dae7886c57c03e1f91249a2fec8ad26fc43d49093", "content": "[[configuration]]\n\nThe recommended way of configuring Spring LDAP is to use the custom XML configuration namespace. To make this available, you need to include the Spring LDAP namespace declaration in your bean file, as follows:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n **xmlns:ldap=\"http://www.springframework.org/schema/ldap\"**\n xsi:schemaLocation=\"http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd\n **http://www.springframework.org/schema/ldap https://www.springframework.org/schema/ldap/spring-ldap.xsd**\">\n----\n====\n\n[[contextsource-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "configuration", "heading_level": 1, "file_order": 2, "section_index": 0, "content_hash": "e1f212f1fff38be208e7a34dae7886c57c03e1f91249a2fec8ad26fc43d49093", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:bef05320478f511b0e20f58e032f6e226113fe331dde46f40d243cf5e80cb774", "content": "`ContextSource` is defined by using an `<ldap:context-source>` tag.\nThe simplest possible `context-source` declaration requires you to specify a server URL, a username, and a password, as follows:\n\n.Simplest possible context-source declaration\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\n\n<ldap:context-source\n username=\"cn=Administrator\"\n password=\"secret\"\n url=\"ldap://localhost:389\" />\n----\n====\n\nThe preceding example creates an `LdapContextSource` with default values (see the table after this paragraph) and the URL and authentication credentials as specified.\nThe configurable attributes on context-source are as follows (required attributes marked with *):\n\n.ContextSource Configuration Attributes\n[cols=\"2,3,5\"]\n|===\n| Attribute | Default | Description\n\n| `id`\n| `contextSource`\n| The ID of the created bean.\n\n| `username`\n|\n| The username (principal) to use when authenticating with the LDAP server.\n This is usually the distinguished name of an admin user (for example, `cn=Administrator`) but may differ depending on server and authentication method.\n Required if `authentication-source-ref` is not explicitly configured.\n\n| `password`\n|\n| The password (credentials) to use when authenticating with the LDAP server. Required if `authentication-source-ref` is not explicitly configured.\n\n| `url` *\n|\n| The URL of the LDAP server to use. The URL should be in the following format: `ldap://myserver.example.com:389`.\n For SSL access, use the `ldaps` protocol and the appropriate port -- for example, `ldaps://myserver.example.com:636`.\n If you want fail-over functionality, you can specify more than one URL, separated by commas (`,`).\n\n| `base`\n| `LdapUtils.emptyLdapName()`\n| The base DN. When this attribute has been configured, all Distinguished Names supplied to and received from LDAP operations are relative to the specified LDAP path.\n This can significantly simplify working against the LDAP tree. However, there are several occasions when you need to have access to the base path.\n For more information on this, see xref:configuration.adoc#base-context-configuration[Obtaining a Reference to the Base LDAP Path]\n\n| `anonymous-read-only`\n| `false`\n| Defines whether read-only operations are performed by using an anonymous (unauthenticated) context.\n Note that setting this parameter to `true` together with the compensating transaction support is not supported and is rejected.\n\n| `referral`\n| `null`\na| Defines the strategy with which to handle referrals, as described https://docs.oracle.com/javase/jndi/tutorial/ldap/referral/jndi.html[here]. The valid values are:\n\n* `ignore`\n* `follow`\n* `throw`\n\n| `native-pooling`\n| `false`\n| Specify whether native Java LDAP connection pooling should be used. Consider using Spring LDAP connection pooling instead. See xref:pooling.adoc[Pooling Support] for more information.\n\n| `authentication-source-ref`\n| A `SimpleAuthenticationSource` instance.\n| ID of the `AuthenticationSource` instance to use (see xref:configuration.adoc#spring-ldap-custom-principal-credentials-management[Custom Principal and Credentials Management]).\n\n| `authentication-strategy-ref`\n| A `SimpleDirContextAuthenticationStrategy` instance.\n| ID of the `DirContextAuthenticationStrategy` instance to use (see xref:configuration.adoc#spring-ldap-custom-dircontext-authentication-processing[Custom `DirContext` Authentication Processing]).\n\n| `base-env-props-ref`\n|\n| A reference to a `Map` of custom environment properties that should supplied with the environment sent to the `DirContext` on construction.\n|===\n\n[[dircontext-authentication]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "`ContextSource` Configuration", "heading_level": 2, "file_order": 2, "section_index": 1, "content_hash": "bef05320478f511b0e20f58e032f6e226113fe331dde46f40d243cf5e80cb774", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:17063786716e4c57b476aca7404129e6d16fe205020e79c1ce6cce8a06fb1000", "content": "When `DirContext` instances are created to be used for performing operations on an LDAP server, these contexts often need to be authenticated.\nSpring LDAP offers various options for configuring this.\n\nNOTE: This section refers to authenticating contexts in the core functionality of the `ContextSource`, to construct `DirContext` instances for use by `LdapClient` and `LdapTemplate`. LDAP is commonly used for the sole purpose of user authentication, and the `ContextSource` may be used for that as well. That process is discussed in xref:user-authentication.adoc[User Authentication using Spring LDAP].\n\nBy default, authenticated contexts are created for both read-only and read-write operations. You should specify the `username` and `password` of the LDAP user to be used for authentication on the `context-source` element.\n\nNOTE: If `username` is the Distinguished Name (DN) of an LDAP user, it needs to be the full DN of the user from the root of the LDAP tree, regardless of whether a `base` LDAP path has been specified on the `context-source` element.\n\nSome LDAP server setups allow anonymous read-only access. If you want to use anonymous contexts for read-only operations, set the `anonymous-read-only` attribute to `true`.\n\n[[spring-ldap-custom-dircontext-authentication-processing]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "`DirContext` Authentication", "heading_level": 3, "file_order": 2, "section_index": 2, "content_hash": "17063786716e4c57b476aca7404129e6d16fe205020e79c1ce6cce8a06fb1000", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:db41b6200f5666e69bcf47bea94a0e111a28eff1178aa4431b59991d292c908d", "content": "The default authentication mechanism used in Spring LDAP is `SIMPLE` authentication. This means that the principal (as specified by the `username` attribute) and the credentials (as specified by the `password`) are set in the `Hashtable` that is sent to the `DirContext` implementation constructor.\n\nThere are many occasions when this processing is not sufficient. For instance, LDAP Servers are commonly set up to accept communication only on a secure TLS channel. There might be a need to use the particular LDAP Proxy Auth mechanism or other concerns.\n\nYou can specify an alternative authentication mechanism by supplying a `DirContextAuthenticationStrategy` implementation reference to the `context-source` element. To do so, set the `authentication-strategy-ref` attribute.\n\n[[tls]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "Custom `DirContext` Authentication Processing", "heading_level": 4, "file_order": 2, "section_index": 3, "content_hash": "db41b6200f5666e69bcf47bea94a0e111a28eff1178aa4431b59991d292c908d", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:1863381e3fef48f853152c35e59d86c731b89265e0cde09059fe720c77ec55dc", "content": "Spring LDAP provides two different configuration options for LDAP servers that require TLS secure channel communication: `DefaultTlsDirContextAuthenticationStrategy` and `ExternalTlsDirContextAuthenticationStrategy`.\nBoth implementations negotiate a TLS channel on the target connection, but they differ in the actual authentication mechanism.\nWhere `DefaultTlsDirContextAuthenticationStrategy` applies SIMPLE authentication on the secure channel (by using the specified `username` and `password`), the `ExternalTlsDirContextAuthenticationStrategy` uses EXTERNAL SASL authentication, applying a client certificate that is configured by using system properties for authentication.\n\nSince different LDAP server implementations respond differently to explicit shutdown of the TLS channel (some servers require the connection be shut down gracefully, while others do not support it), the TLS `DirContextAuthenticationStrategy` implementations support specifying the shutdown behavior by using the `shutdownTlsGracefully` parameter. If this property is set to `false` (the default), no explicit TLS shutdown happens. If it is `true`, Spring LDAP tries to shut down the TLS channel gracefully before closing the target context.\n\nNOTE: When working with TLS connections, you need to make sure that the native LDAP Pooling functionality (as specified by using the `native-pooling` attribute) is turned off. This is particularly important if `shutdownTlsGracefully` is set to `false`. However, since the TLS channel negotiation process is quite expensive, you can gain great performance benefits by using the Spring LDAP Pooling Support, described in xref:pooling.adoc[Pooling Support].\n\n[[spring-ldap-custom-principal-credentials-management]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "TLS", "heading_level": 5, "file_order": 2, "section_index": 4, "content_hash": "1863381e3fef48f853152c35e59d86c731b89265e0cde09059fe720c77ec55dc", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:64740ee5e48d7f1809c900b0feb0c2f08fb71c83b72eefa5a5c17d6800a92355", "content": "While the user name (that is, the user DN) and password used for creating an authenticated `Context` are statically defined by default (the ones defined in the `context-source` element configuration are used throughout the lifetime of the `ContextSource`), there are several cases where this is not the desired behavior. A common scenario is that the principal and credentials of the current user should be used when performing LDAP operations for that user. You can modify the default behavior by supplying a reference to an `AuthenticationSource` implementation to the `context-source` element by using the `authentication-source-ref` element, instead of explicitly specifying the `username` and `password`. The `AuthenticationSource` is queried by the `ContextSource` for principal and credentials each time an authenticated `Context` is to be created.\n\nIf you use https://spring.io/spring-security[Spring Security], you can make sure the principal and credentials of the currently logged-in user are used at all times by configuring your `ContextSource` with an instance of the `SpringSecurityAuthenticationSource` shipped with Spring Security. The following example shows how to do so:\n\n.Using the SpringSecurityAuthenticationSource\n====\n[source,java,subs=\"verbatim,quotes\"]\n----\n\n<beans>\n...\n <ldap:context-source\n url=\"ldap://localhost:389\"\n authentication-source-ref=\"springSecurityAuthenticationSource\"/>\n\n <bean id=\"springSecurityAuthenticationSource\"\n class=\"org.springframework.security.ldap.authentication.SpringSecurityAuthenticationSource\" />\n...\n</beans>\n----\n====\n\nNOTE: We do not specify any `username` or `password` for. our `context-source` when using an `AuthenticationSource`. These properties are needed only when the default behavior is used.\n\nNOTE: When using the `SpringSecurityAuthenticationSource`, you need to use Spring Security's `LdapAuthenticationProvider` to authenticate the users against LDAP.\n\n[[native-java-ldap-pooling]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "Custom Principal and Credentials Management", "heading_level": 4, "file_order": 2, "section_index": 5, "content_hash": "64740ee5e48d7f1809c900b0feb0c2f08fb71c83b72eefa5a5c17d6800a92355", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:ada38709f2f471c1bea6c3bee448d73607a7327a542ece464d133f959191f96f", "content": "The internal Java LDAP provider provides some very basic pooling capabilities. You can turn this LDAP connection pooling on or off by using the `pooled` flag on `AbstractContextSource`. The default value is `false` (since release 1.3) -- that is, the native Java LDAP pooling is turned off. The configuration of LDAP connection pooling is managed by using `System` properties, so you need to handle this manually, outside of the Spring Context configuration. You can find details of the native pooling configuration https://java.sun.com/products/jndi/tutorial/ldap/connect/config.html[here].\n\nNOTE: There are several serious deficiencies in the built-in LDAP connection pooling, which is why Spring LDAP provides a more sophisticated approach to LDAP connection pooling, described in xref:pooling.adoc[Pooling Support]. If you need pooling functionality, this is the recommended approach.\n\nNOTE: Regardless of the pooling configuration, the `ContextSource#getContext(String principal, String credentials)` method always explicitly does not use native Java LDAP Pooling, in order for reset passwords to take effect as soon as possible.\n\n[[advanced-contextsource-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "Native Java LDAP Pooling", "heading_level": 3, "file_order": 2, "section_index": 6, "content_hash": "ada38709f2f471c1bea6c3bee448d73607a7327a542ece464d133f959191f96f", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:abd6429d1ea6b0213b821f442d233e11b3fba914ac398740a777db98e4f71968", "content": "This section covers more advanced ways to configure a `ContextSource`.\n\n[[custom-dircontext-environment-properties]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "Advanced `ContextSource` Configuration", "heading_level": 3, "file_order": 2, "section_index": 7, "content_hash": "abd6429d1ea6b0213b821f442d233e11b3fba914ac398740a777db98e4f71968", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:f1f4af1331a0d157ecf600b0997013c5f0fc73b108163895ecad932418a9cf35", "content": "In some cases, you might want to specify additional environment setup properties, in addition to the ones directly configurable on `context-source`. You should set such properties in a `Map` and reference them in the `base-env-props-ref` attribute.\n\n[[ldapclient-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "Custom `DirContext` Environment Properties", "heading_level": 4, "file_order": 2, "section_index": 8, "content_hash": "f1f4af1331a0d157ecf600b0997013c5f0fc73b108163895ecad932418a9cf35", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:e5b902d32b92d74d5484ad2af79375c0fa76a5e0be97b8a1443f48efd33c2883", "content": "`LdapClient` is the new interface for calling an LDAP backend. It improves upon `LdapTemplate` in the following ways:\n\n* Provides built-in `Stream` support\n* Provides a simplified API centered around bind (C), search (R), modify (U), unbind (D), and authenticate.\n\n[NOTE]\n`LdapClient` does not yet support ODM.\nIf this is something you need, `LdapTemplate` has this capacity.\nBoth `LdapClient` and `LdapTemplate` can coexist quite nicely in the same application, if needed.\n\nAn `LdapClient` is defined by using the `LdapClient#create` factory method like so:\n\n.Simplest possible LdapClient declaration\n====\n[source,xml]\n----\n<bean id=\"ldapClient\" class=\"org.springframework.ldap.core.LdapClient\" factory-method=\"create\">\n <constructor-arg ref=\"contextSource\" />\n</bean>\n----\n====\n\nThis element references the default `ContextSource`, which is expected to have an ID of `contextSource` (the default for the `context-source` element).\n\nYour `LdapClient` instance can be configured for how to handle certain checked exceptions and what any default `SearchControls` should be used for queries.\n\n[[ldaptemplate-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "`LdapClient` Configuration", "heading_level": 2, "file_order": 2, "section_index": 9, "content_hash": "e5b902d32b92d74d5484ad2af79375c0fa76a5e0be97b8a1443f48efd33c2883", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:c417532beedb543b074c085bacd15765846905e8ee1025ae9fd61c920a8e75bd", "content": "The `LdapTemplate` is defined by using a `<ldap:ldap-template>` element. The simplest possible `ldap-template` declaration is the element by itself:\n\n.Simplest possible ldap-template declaration\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\n<ldap:ldap-template />\n----\n====\n\nThe element by itself creates an `LdapTemplate` instance with the default ID, referencing the default `ContextSource`, which is expected to have an ID of `contextSource` (the default for the `context-source` element).\n\nThe following table describes the configurable attributes on `ldap-template`:\n\n.LdapTemplate Configuration Attributes\n[cols=\"1,1,4a\"]\n|===\n| Attribute | Default | Description\n\n| `id`\n| `ldapTemplate`\n| The ID of the created bean.\n\n| `context-source-ref`\n| `contextSource`\n| The ID of the `ContextSource` instance to use.\n\n| `count-limit`\n| `0`\n| The default count limit for searches. 0 means no limit.\n\n| `time-limit`\n| `0`\n| The default time limit for searches, in milliseconds. 0 means no limit.\n\n| `search-scope`\n| `SUBTREE`\n| The default search scope for searches. The valid values are:\n\n* `OBJECT`\n* `ONELEVEL`\n* `SUBTREE`\n\n| `ignore-name-not-found`\n| `false`\n| Specifies whether a `NameNotFoundException` should be ignored in searches. Setting this attribute to `true` make errors that are caused by an invalid search base be silently swallowed.\n\n| `ignore-partial-result`\n| `false`\n| Specifies whether `PartialResultException` should be ignored in searches. Some LDAP servers have problems with referrals. These should normally be followed automatically. However, if this does not work, it manifests itself with a `PartialResultException`. Setting this attribute to `true` presents a work-around to this problem.\n\n| `odm-ref`\n|\n| The ID of the `ObjectDirectoryMapper` instance to use. The default is a default-configured `DefaultObjectDirectoryMapper`.\n|===\n\n[[base-context-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "`LdapTemplate` Configuration", "heading_level": 2, "file_order": 2, "section_index": 10, "content_hash": "c417532beedb543b074c085bacd15765846905e8ee1025ae9fd61c920a8e75bd", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:975ddf86a7177ea9065441a868b95146648c4fa8787d4560f4e04e3e7010a97d", "content": "As described earlier, you can supply a base LDAP path to the `ContextSource`, specifying the root in the LDAP tree to which all operations are relative. This means that you are working only with relative distinguished names throughout your system, which is typically rather handy. There are, however, some cases in which you may need to have access to the base path in order to be able to construct full DNs, relative to the actual root of the LDAP tree. One example would be when working with LDAP groups (for example, the `groupOfNames` object class). In that case, each group member attribute value needs to be the full DN of the referenced member.\n\nFor that reason, Spring LDAP has a mechanism by which any Spring-controlled bean may be supplied with the base path on startup.\nFor beans to be notified of the base path, two things need to be in place. First, the bean that wants the base path reference needs to implement the `BaseLdapNameAware` interface.\nSecond, you need to define a `BaseLdapPathBeanPostProcessor` in the application context.\nThe following example shows how to implement `BaseLdapNameAware`:\n\n.Implementing `BaseLdapNameAware`\n====\n[source,java,subs=\"verbatim,quotes\"]\n----\npackage com.example.service;\npublic class PersonService implements PersonService**, BaseLdapNameAware** {\n ...\n **private LdapName basePath;\n\n public void setBaseLdapPath(LdapName basePath) {\n this.basePath = basePath;\n }**\n ...\n private LdapName getFullPersonDn(Person person) {\n return LdapNameBuilder.newInstance(**basePath**)\n .add(person.getDn())\n .build();\n }\n ...\n}\n----\n====\n\nThe following example shows how to define a `BaseLdapPathBeanPostProcessor`:\n\n.Specifying a BaseLdapPathBeanPostProcessor in your ApplicationContext\n====\n[source,java,subs=\"verbatim,quotes\"]\n----\n<beans>\n ...\n <ldap:context-source\n username=\"cn=Administrator\"\n password=\"secret\"\n url=\"ldap://localhost:389\"\n base=\"dc=261consulting,dc=com\" />\n ...\n **<bean class=\"org.springframework.ldap.core.support.BaseLdapPathBeanPostProcessor\" />**\n</beans>\n----\n====\n\nThe default behavior of the `BaseLdapPathBeanPostProcessor` is to use the base path of the single defined `BaseLdapPathSource` (`AbstractContextSource`) in the `ApplicationContext`. If more than one `BaseLdapPathSource` is defined, you need to specify which one to use by setting the `baseLdapPathSourceName` property.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/configuration.adoc", "title": "configuration", "heading": "Obtaining a Reference to the Base LDAP Path", "heading_level": 2, "file_order": 2, "section_index": 11, "content_hash": "975ddf86a7177ea9065441a868b95146648c4fa8787d4560f4e04e3e7010a97d", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/configuration.adoc"}}
{"id": "sha256:2942d35cddd8fc3e8490755ca52147df81a9cb31ff35e5f36e69ed9417e9f590", "content": "[[dirobjectfactory]]\n\nA little-known -- and probably underestimated -- feature of the Java LDAP API is the ability to register a `DirObjectFactory` to automatically create objects from found LDAP entries.\nSpring LDAP makes use of this feature to return https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/core/DirContextAdapter.html[`DirContextAdapter`] instances in certain search and lookup operations.\n\n`DirContextAdapter` is a useful tool for working with LDAP attributes, particularly when adding or modifying data.\n\n[[search-and-lookup-using-contextmapper]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "dirobjectfactory", "heading_level": 1, "file_order": 3, "section_index": 0, "content_hash": "2942d35cddd8fc3e8490755ca52147df81a9cb31ff35e5f36e69ed9417e9f590", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:d8c8251f33ca90940e5f932f8a62600dd9adf23afe71d13f49c9574e04a76f8f", "content": "Whenever an entry is found in the LDAP tree, its attributes and Distinguished Name (DN) are used by Spring LDAP to construct a `DirContextAdapter`.\nThis lets us use a https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/core/ContextMapper.html[`ContextMapper`] instead of an `AttributesMapper`\nto transform found values, as follows:\n\n.Searching using a ContextMapper\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n ...\n **private static class PersonContextMapper implements ContextMapper {\n public Object mapFromContext(Object ctx) {\n DirContextAdapter context = (DirContextAdapter)ctx;\n Person p = new Person();\n p.setFullName(context.getStringAttribute(\"cn\"));\n p.setLastName(context.getStringAttribute(\"sn\"));\n p.setDescription(context.getStringAttribute(\"description\"));\n return p;\n }\n }**\n\n public Person findByPrimaryKey(\n String name, String company, String country) {\n Name dn = buildDn(name, company, country);\n return ldapClient.search().name(dn).toObject(**new PersonContextMapper()**);\n }\n}\n----\n====\n\nAs shown in the preceding example, we can retrieve the attribute values directly by name without having to go through the `Attributes` and `Attribute` classes.\nThis is particularly useful when working with multi-value attributes.\nExtracting values from multi-value attributes normally requires looping through a `NamingEnumeration` of attribute values returned from the `Attributes` implementation.\n`DirContextAdapter` does this for you\nin the https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/core/DirContextAdapter.html#getStringAttributes(java.lang.String)[`getStringAttributes()`]\nor https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/core/DirContextAdapter.html#getObjectAttributes(java.lang.String)[`getObjectAttributes()`] methods.\nThe following example uses the `getStringAttributes` method:\n\n.Getting multi-value attribute values using `getStringAttributes()`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nprivate static class PersonContextMapper implements ContextMapper {\n public Object mapFromContext(Object ctx) {\n DirContextAdapter context = (DirContextAdapter)ctx;\n Person p = new Person();\n p.setFullName(context.getStringAttribute(\"cn\"));\n p.setLastName(context.getStringAttribute(\"sn\"));\n p.setDescription(context.getStringAttribute(\"description\"));\n // The roleNames property of Person is an String array\n **p.setRoleNames(context.getStringAttributes(\"roleNames\"));**\n return p;\n }\n}\n----\n====\n\n[[using-abstractcontextmapper]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "Search and Lookup Using `ContextMapper`", "heading_level": 2, "file_order": 3, "section_index": 1, "content_hash": "d8c8251f33ca90940e5f932f8a62600dd9adf23afe71d13f49c9574e04a76f8f", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:dd384dfd55d5ed00ed1d1939ed4e51b896cdcd8952a3cca3cb00b2dec9d862ce", "content": "Spring LDAP provides an abstract base implementation of `ContextMapper`, called https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/core/support/AbstractContextMapper.html[`AbstractContextMapper`].\nThis implementation automatically takes care of the casting of the supplied `Object` parameter to `DirContexOperations`.\nUsing `AbstractContextMapper`, the `PersonContextMapper` shown earlier can thus be re-written as follows:\n\n.Using an `AbstractContextMapper`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nprivate static class PersonContextMapper **extends AbstractContextMapper** {\n public Object **doMapFromContext**(DirContextOperations ctx) {\n Person p = new Person();\n p.setFullName(ctx.getStringAttribute(\"cn\"));\n p.setLastName(ctx.getStringAttribute(\"sn\"));\n p.setDescription(ctx.getStringAttribute(\"description\"));\n return p;\n }\n}\n----\n====\n\n[[adding-and-updating-data-by-using-dircontextadapter]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "Using `AbstractContextMapper`", "heading_level": 3, "file_order": 3, "section_index": 2, "content_hash": "dd384dfd55d5ed00ed1d1939ed4e51b896cdcd8952a3cca3cb00b2dec9d862ce", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:f961a042a5c1cd2bc920f408d946e6d8963617fdc7ad679e6e400708ffd3139d", "content": "`\nWhile useful when extracting attribute values, `DirContextAdapter` is even more powerful for managing the details\ninvolved in adding and updating data.\n\n[[adding-data-by-using-dircontextadapter]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "Adding and Updating Data by Using `DirContextAdapter`", "heading_level": 2, "file_order": 3, "section_index": 3, "content_hash": "f961a042a5c1cd2bc920f408d946e6d8963617fdc7ad679e6e400708ffd3139d", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:955165e358d7c7303620a234c9b0a970702cd62cd46e967e0ddefd9267de4ac7", "content": "The following example uses `DirContextAdapter` to implement an improved implementation of the `create` repository method presented in xref:spring-ldap-basic-usage.adoc#basic-binding-data[Adding Data]:\n\n.Binding using `DirContextAdapter`\n====\n[[example-binding-contextmapper]]\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n ...\n public void create(Person p) {\n Name dn = buildDn(p);\n DirContextAdapter context = new DirContextAdapter(dn);\n\n **context.setAttributeValues(\"objectclass\", new String[] {\"top\", \"person\"});\n context.setAttributeValue(\"cn\", p.getFullname());\n context.setAttributeValue(\"sn\", p.getLastname());\n context.setAttributeValue(\"description\", p.getDescription());**\n\n ldapClient.bind(dn).object(context).execute();\n }\n}\n----\n====\n\nNote that we use the `DirContextAdapter` instance as the second parameter to bind, which should be a `Context`.\nThe third parameter is `null`, since we do not specify the attributes explicitly.\n\nAlso note the use of the `setAttributeValues()` method when setting the `objectclass` attribute values.\nThe `objectclass` attribute is multi-value. Similar to the troubles of extracting muti-value attribute data,\nbuilding multi-value attributes is tedious and verbose work. By using the `setAttributeValues()` method, you can have `DirContextAdapter` handle that work for you.\n\n[[updating-data-by-using-dircontextadapter]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "Adding Data by Using `DirContextAdapter`", "heading_level": 3, "file_order": 3, "section_index": 4, "content_hash": "955165e358d7c7303620a234c9b0a970702cd62cd46e967e0ddefd9267de4ac7", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:4655733851d32f483988e24b4f483a316ecb09a95733b9a9be2d2e7af165c344", "content": "We previously saw that updating by using `modifyAttributes` is the recommended approach, but that doing so requires us to perform\nthe task of calculating attribute modifications and constructing `ModificationItem` arrays accordingly.\n`DirContextAdapter` can do all of this for us, as follows:\n\n.Updating using `DirContextAdapter`\n====\n[[modify-modifyAttributes]]\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n ...\n public void update(Person p) {\n Name dn = buildDn(p);\n **DirContextOperations context = ldapClient.search().name(dn).toEntry();**\n\n context.setAttributeValue(\"cn\", p.getFullname());\n context.setAttributeValue(\"sn\", p.getLastname());\n context.setAttributeValue(\"description\", p.getDescription());\n\n **ldapClient.modify(dn).attributes(context.getModificationItems()).execute();**\n }\n}\n----\n====\n\nWhen calling `SearchSpec#toEntry`, the result is a `DirContextAdapter` instance by default.\nWhile the `lookup` method returns an `Object`, `toEntry` automatically casts the return value to a `DirContextOperations`\n(the interface that `DirContextAdapter` implements).\n\nNotice that we have duplicate code in the `LdapTemplate#create` and `LdapTemplate#update` methods. This code maps from a domain object to a context. It can be extracted to a separate method, as follows:\n\n.Adding and modifying using DirContextAdapter\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n\n ...\n public void create(Person p) {\n Name dn = buildDn(p);\n DirContextAdapter context = new DirContextAdapter(dn);\n\n context.setAttributeValues(\"objectclass\", new String[] {\"top\", \"person\"});\n mapToContext(p, context);\n ldapClient.bind(dn).object(context).execute();\n }\n\n public void update(Person p) {\n Name dn = buildDn(p);\n DirContextOperations context = ldapClient.search().name(dn).toEntry();\n mapToContext(person, context);\n ldapClient.modify(dn).attributes(context.getModificationItems()).execute();\n }\n\n protected void mapToContext (Person p, DirContextOperations context) {\n context.setAttributeValue(\"cn\", p.getFullName());\n context.setAttributeValue(\"sn\", p.getLastName());\n context.setAttributeValue(\"description\", p.getDescription());\n }\n}\n----\n====\n\n[[dns-as-attribute-values]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "Updating Data by Using `DirContextAdapter`", "heading_level": 3, "file_order": 3, "section_index": 5, "content_hash": "4655733851d32f483988e24b4f483a316ecb09a95733b9a9be2d2e7af165c344", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:e88423b44c07735a6cfe10c025e458dab2483d41391064dcf42db8343426a09b", "content": "When managing security groups in LDAP, it is common to have attribute values that represent\ndistinguished names. Since distinguished name equality differs from String equality (for example, whitespace and case differences\nare ignored in distinguished name equality), calculating attribute modifications using string equality does not work as expected.\n\nFor instance, if a `member` attribute has a value of `cn=John Doe,ou=People` and we call `ctx.addAttributeValue(\"member\", \"CN=John Doe, OU=People\")`,\nthe attribute is now considered to have two values, even though the strings actually represent the same\ndistinguished name.\n\nAs of Spring LDAP 2.0, supplying `javax.naming.Name` instances to the attribute modification methods makes `DirContextAdapter`\nuse distinguished name equality when calculating attribute modifications. If we modify the earlier example to be\n`ctx.addAttributeValue(\"member\", LdapUtils.newLdapName(\"CN=John Doe, OU=People\"))`, it does *not* render a modification, as the following example shows:\n\n.Group Membership Modification using DirContextAdapter\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic class GroupRepo implements BaseLdapNameAware {\n private LdapClient ldapClient;\n private LdapName baseLdapPath;\n\n public void setLdapClient(LdapClient ldapClient) {\n this.ldapClient = ldapClient;\n }\n\n public void setBaseLdapPath(LdapName baseLdapPath) {\n this.setBaseLdapPath(baseLdapPath);\n }\n\n public void addMemberToGroup(String groupName, Person p) {\n Name groupDn = buildGroupDn(groupName);\n Name userDn = buildPersonDn(\n person.getFullname(),\n person.getCompany(),\n person.getCountry());\n\n DirContextOperation ctx = ldapClient.search().name(groupDn).toEntry();\n ctx.addAttributeValue(\"member\", userDn);\n\n ldapClient.modify(groupDn).attributes(ctx.getModificationItems()).execute();\n }\n\n public void removeMemberFromGroup(String groupName, Person p) {\n Name groupDn = buildGroupDn(String groupName);\n Name userDn = buildPersonDn(\n person.getFullname(),\n person.getCompany(),\n person.getCountry());\n\n DirContextOperation ctx = ldapClient.search().name(groupDn).toEntry();\n ctx.removeAttributeValue(\"member\", userDn);\n\n ldapClient.modify(groupDn).attributes(ctx.getModificationItems()).execute();\n }\n\n private Name buildGroupDn(String groupName) {\n return LdapNameBuilder.newInstance(\"ou=Groups\")\n .add(\"cn\", groupName).build();\n }\n\n private Name buildPersonDn(String fullname, String company, String country) {\n return LdapNameBuilder.newInstance(baseLdapPath)\n .add(\"c\", country)\n .add(\"ou\", company)\n .add(\"cn\", fullname)\n .build();\n }\n}\n----\n====\n\nIn the preceding example, we implement `BaseLdapNameAware` to get the base LDAP path as described in xref:configuration.adoc#base-context-configuration[Obtaining a Reference to the Base LDAP Path].\nThis is necessary because distinguished names as member attribute values must always be absolute from the directory root.\n\n[[a-complete-personrepository-class]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "`DirContextAdapter` and Distinguished Names as Attribute Values", "heading_level": 2, "file_order": 3, "section_index": 6, "content_hash": "e88423b44c07735a6cfe10c025e458dab2483d41391064dcf42db8343426a09b", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:df3f4729a7a35f4c5da7d5b24b9815076773534779b17542bc25960479dab66a", "content": "To illustrate the usefulness of Spring LDAP and `DirContextAdapter`, the following example shows a complete `Person` Repository implementation for LDAP:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\nimport java.util.List;\n\nimport javax.naming.Name;\nimport javax.naming.NamingException;\nimport javax.naming.directory.Attributes;\nimport javax.naming.ldap.LdapName;\n\nimport org.springframework.ldap.core.AttributesMapper;\nimport org.springframework.ldap.core.ContextMapper;\nimport org.springframework.ldap.core.LdapTemplate;\nimport org.springframework.ldap.core.DirContextAdapter;\nimport org.springframework.ldap.filter.AndFilter;\nimport org.springframework.ldap.filter.EqualsFilter;\nimport org.springframework.ldap.filter.WhitespaceWildcardsFilter;\n\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n\n public void setLdapClient(LdapClient ldapClient) {\n this.ldapClient = ldapClient;\n }\n\n public void create(Person person) {\n DirContextAdapter context = new DirContextAdapter(buildDn(person));\n mapToContext(person, context);\n ldapClient.bind(context.getDn()).object(context).execute();\n }\n\n public void update(Person person) {\n Name dn = buildDn(person);\n DirContextOperations context = ldapClient.lookupContext(dn);\n mapToContext(person, context);\n ldapClient.modify(dn).attributes(context.getModificationItems()).execute();\n }\n\n public void delete(Person person) {\n ldapClient.unbind(buildDn(person)).execute();\n }\n\n public Person findByPrimaryKey(String name, String company, String country) {\n Name dn = buildDn(name, company, country);\n return ldapClient.search().name(dn).toObject(getContextMapper());\n }\n\n public List<Person> findByName(String name) {\n LdapQuery query = query()\n .where(\"objectclass\").is(\"person\")\n .and(\"cn\").whitespaceWildcardsLike(\"name\");\n\n return ldapClient.search().query(query).toList(getContextMapper());\n }\n\n public List<Person> findAll() {\n EqualsFilter filter = new EqualsFilter(\"objectclass\", \"person\");\n return ldapClient.search().query((query) -> query.filter(filter)).toList(getContextMapper());\n }\n\n protected ContextMapper getContextMapper() {\n return new PersonContextMapper();\n }\n\n protected Name buildDn(Person person) {\n return buildDn(person.getFullname(), person.getCompany(), person.getCountry());\n }\n\n protected Name buildDn(String fullname, String company, String country) {\n return LdapNameBuilder.newInstance()\n .add(\"c\", country)\n .add(\"ou\", company)\n .add(\"cn\", fullname)\n .build();\n }\n\n protected void mapToContext(Person person, DirContextOperations context) {\n context.setAttributeValues(\"objectclass\", new String[] {\"top\", \"person\"});\n context.setAttributeValue(\"cn\", person.getFullName());\n context.setAttributeValue(\"sn\", person.getLastName());\n context.setAttributeValue(\"description\", person.getDescription());\n }\n\n private static class PersonContextMapper extends AbstractContextMapper<Person> {\n public Person doMapFromContext(DirContextOperations context) {\n Person person = new Person();\n person.setFullName(context.getStringAttribute(\"cn\"));\n person.setLastName(context.getStringAttribute(\"sn\"));\n person.setDescription(context.getStringAttribute(\"description\"));\n return person;\n }\n }\n}\n----\n====\n\nNOTE: In several cases, the Distinguished Name (DN) of an object is constructed by using properties of the object.\nIn the preceding example, the country, company and full name of the `Person` are used in the DN, which means that updating any of these properties actually requires moving the entry in the LDAP tree by using the `rename()` operation in addition to updating the `Attribute` values.\nSince this is highly implementation-specific, this is something you need to keep track of yourself, either by disallowing the user to change these properties or performing the `rename()` operation in your `update()` method if needed.\nNote that, by using xref:odm.adoc[Object-Directory Mapping (ODM)], the library can automatically handle this for you if you annotate your domain classes appropriately.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/dirobjectfactory.adoc", "title": "dirobjectfactory", "heading": "A Complete `PersonRepository` Class", "heading_level": 2, "file_order": 3, "section_index": 7, "content_hash": "df3f4729a7a35f4c5da7d5b24b9815076773534779b17542bc25960479dab66a", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/dirobjectfactory.adoc"}}
{"id": "sha256:d62e364993cf79833e14df31c5bf83337986d8bd221612753d1be0637fb5d616", "content": "[[spring-ldap-faq]]\n\n[[operational-attributes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/faq.adoc", "title": "faq", "heading": "faq", "heading_level": 1, "file_order": 4, "section_index": 0, "content_hash": "d62e364993cf79833e14df31c5bf83337986d8bd221612753d1be0637fb5d616", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/faq.adoc"}}
{"id": "sha256:fd6b74896512296276203abd93e376e084891141b770b734a7669b88547d2f65", "content": "[[how-do-i-remove-an-operational-attribute-by-using-context-removeattributevalue]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/faq.adoc", "title": "faq", "heading": "Operational Attributes", "heading_level": 2, "file_order": 4, "section_index": 1, "content_hash": "fd6b74896512296276203abd93e376e084891141b770b734a7669b88547d2f65", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/faq.adoc"}}
{"id": "sha256:789b82751432f5c439c079a5a071dcd2ae28eeab6fed140f8e98d795e98d005b", "content": "By default, the `DirContextAdapter` reads only the visible attributes. This is because the operational attributes are returned by the server only if explicitly asked for, and there is no way for Spring LDAP to know the attributes for which to ask. This means that the `DirContextAdapter` is not populated with the operational attributes. Consequently, the `removeAttributeValue` does not have any effect (since, from the point of view of the `DirContextAdapter`, it was not there in the first place).\n\nThere are basically two ways to do this:\n\n* Use a search or lookup method that takes the attribute names as an argument, such as `LdapTemplate#lookup(Name, String[], ContextMapper)`. Then use a `ContextMapper` implementation that returns the supplied `DirContextAdapter` in `mapFromContext()`.\n\n* Use `LdapTemplate#modifyAttributes(Name, ModificationItem[])` directly, manually building the `ModificationItem` array.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/faq.adoc", "title": "faq", "heading": "How do I remove an operational attribute by using `context.removeAttributeValue()`?", "heading_level": 3, "file_order": 4, "section_index": 2, "content_hash": "789b82751432f5c439c079a5a071dcd2ae28eeab6fed140f8e98d795e98d005b", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/faq.adoc"}}
{"id": "sha256:4b8b32f5c90723137de7fef7341791b5154120846cd23ad9ee8224a5defe1038", "content": "[[getting]]\n\nThis section describes how to get the Spring LDAP binaries.\nSee xref:community.adoc#community-source[Source Code] for how to obtain the source code.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/getting-spring-ldap.adoc", "title": "getting-spring-ldap", "heading": "getting-spring-ldap", "heading_level": 1, "file_order": 5, "section_index": 0, "content_hash": "4b8b32f5c90723137de7fef7341791b5154120846cd23ad9ee8224a5defe1038", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/getting-spring-ldap.adoc"}}
{"id": "sha256:ddc1e342dd7a0fcaa395eb1f2ab6700483722380cc59a221d5c0ae1f3ecf5f12", "content": "Spring LDAP versions are formatted as MAJOR.MINOR.PATCH such that:\n\n* MAJOR versions may contain breaking changes.\nTypically, these are done to provide improved security to match modern security practices.\n* MINOR versions contain enhancements but are considered passive updates.\n* PATCH level should be perfectly compatible, forwards and backwards, with the possible exception of changes that fix bugs.\n\n[[maven]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/getting-spring-ldap.adoc", "title": "getting-spring-ldap", "heading": "Release Numbering", "heading_level": 2, "file_order": 5, "section_index": 1, "content_hash": "ddc1e342dd7a0fcaa395eb1f2ab6700483722380cc59a221d5c0ae1f3ecf5f12", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/getting-spring-ldap.adoc"}}
{"id": "sha256:0a9c0d64ce6bdc08cbd8aa22bd747fee1eae73d70f913560592ab8032e288a14", "content": "As most open source projects, Spring LDAP deploys its dependencies as Maven artifacts, which makes them compatible with both Maven and Gradle. The following sections demonstrate how to integrate Spring LDAP with these build tools, with examples for Spring Boot and standalone usage.\n\n[[getting-maven-boot]]\n[[getting-gradle-boot]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/getting-spring-ldap.adoc", "title": "getting-spring-ldap", "heading": "Usage", "heading_level": 2, "file_order": 5, "section_index": 2, "content_hash": "0a9c0d64ce6bdc08cbd8aa22bd747fee1eae73d70f913560592ab8032e288a14", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/getting-spring-ldap.adoc"}}
{"id": "sha256:312d059a1dacd416f521164ba4784f8bb75232c4e5d104d97eaf81b1cd5aecac", "content": "Spring Boot provides a `spring-boot-starter-ldap` starter that aggregates Spring LDAP-related dependencies.\nThe simplest and preferred way to use the starter is to use https://docs.spring.io/initializr/docs/current/reference/html/[Spring Initializr] by using an IDE integration in (https://joshlong.com/jl/blogPost/tech_tip_geting_started_with_spring_boot.html[Eclipse] or https://www.jetbrains.com/help/idea/spring-boot.html#d1489567e2[IntelliJ], https://github.com/AlexFalappa/nb-springboot/wiki/Quick-Tour[NetBeans]) or through https://start.spring.io.\nAlternatively, you can manually add the starter, as the following example shows:\n\n[tabs]\n======\nMaven::\n+\n.pom.xml\n[source,xml,subs=\"verbatim,attributes\"]\n----\n<dependencies>\n\t<!-- ... other dependency elements ... -->\n\t<dependency>\n <groupId>org.springframework.boot</groupId>\n <artifactId>spring-boot-starter-ldap</artifactId>\n\t</dependency>\n</dependencies>\n----\n\nGradle::\n+\n.build.gradle\n[source,groovy]\n[subs=\"verbatim,attributes\"]\n----\ndependencies {\n\timplementation \"org.springframework.boot:spring-boot-starter-ldap\"\n}\n----\n======\n\nSince Spring Boot provides a Maven BOM to manage dependency versions, you do not need to specify a version.\nIf you wish to override the Spring LDAP version, you can do so with a build property as shown below:\n\n[tabs]\n======\nMaven::\n+\n.pom.xml\n[source,xml,subs=\"verbatim,attributes\"]\n----\n<properties>\n\t<!-- ... -->\n\t<spring-ldap.version>{project-version}</spring-ldap.version>\n</properties>\n----\n\nGradle::\n+\n.build.gradle\n[source,groovy]\n[subs=\"verbatim,attributes\"]\n----\next['spring-ldap.version']='{project-version}'\n----\n======\n\nSince Spring LDAP makes breaking changes only in major releases, you can safely use a newer version of Spring LDAP with Spring Boot.\nHowever, at times, you may need to update the version of Spring Framework as well.\nYou can do so by adding a build property like so:\n\n[tabs]\n======\nMaven::\n+\n.pom.xml\n[source,xml,subs=\"verbatim,attributes\"]\n----\n<properties>\n\t<!-- ... -->\n\t<spring.version>{spring-core-version}</spring.version>\n</properties>\n----\n\nGradle::\n+\n.build.gradle\n[source,groovy]\n[subs=\"verbatim,attributes\"]\n----\next['spring.version']='{spring-core-version}'\n----\n======\n\nIf you use additional features (such as LDIF), you need to also include the appropriate xref:modules.adoc#modules[modules].\n\n[[getting-maven-no-boot]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/getting-spring-ldap.adoc", "title": "getting-spring-ldap", "heading": "Spring Boot", "heading_level": 3, "file_order": 5, "section_index": 3, "content_hash": "312d059a1dacd416f521164ba4784f8bb75232c4e5d104d97eaf81b1cd5aecac", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/getting-spring-ldap.adoc"}}
{"id": "sha256:99d7f99d99f108d234b735ae6588816227adc829940978c19de16aee49417e8e", "content": "When you use Spring LDAP without Spring Boot, you must specify the version you intend to use:.\n\n[tabs]\n======\nMaven::\n+\n.pom.xml\n[source,xml,ubs=\"verbatim,attributes\"]\n----\n<dependencyManagement>\n\t<dependencies>\n <!-- ... other dependency elements ... -->\n <dependency>\n <groupId>org.springframework.ldap</groupId>\n <artifactId>spring-ldap-core</artifactId>\n <version>{project-version}</version>\n </dependency>\n\t</dependencies>\n</dependencyManagement>\n----\n\nGradle::\n+\n.build.gradle\n[source,groovy]\n[subs=\"verbatim,attributes\"]\n----\nplugins {\n\tid \"io.spring.dependency-management\" version \"1.0.6.RELEASE\"\n}\n\ndependencyManagement {\n\timports {\n mavenBom 'org.springframework.ldap:spring-ldap-core:{project-version}'\n\t}\n}\n----\n======\n\n[TIP]\nSpring provides a https://github.com/spring-gradle-plugins/dependency-management-plugin[`Dependency Management Plugin`] for Gradle\n\nFor most projects, including `spring-ldap-core` is sufficient.\n\nIf you use additional features (such as LDIF), you need to also include the appropriate xref:modules.adoc#modules[modules].\n\nSpring LDAP builds against Spring Framework 6 but should generally work with any newer version of Spring Framework 5.x.\nMany users are likely to run afoul of the fact that Spring LDAP's transitive dependencies resolve Spring Framework 6, which can cause strange classpath problems.\nThe easiest way to resolve this is to use the `spring-framework-bom` within the `<dependencyManagement>` section of your `pom.xml` or your `dependencyManagement` section of your `build.gradle`.\n\n[tabs]\n======\nMaven::\n+\n.pom.xml\n[source,xml,subs=\"verbatim,attributes\"]\n----\n<dependencyManagement>\n\t<dependencies>\n <!-- ... other dependency elements ... -->\n <dependency>\n <groupId>org.springframework</groupId>\n <artifactId>spring-framework-bom</artifactId>\n <version>{spring-core-version}</version>\n <type>pom</type>\n <scope>import</scope>\n </dependency>\n\t</dependencies>\n</dependencyManagement>\n----\n\nGradle::\n+\n.build.gradle\n[source,groovy]\n[subs=\"verbatim,attributes\"]\n----\nplugins {\n\tid \"io.spring.dependency-management\" version \"1.0.6.RELEASE\"\n}\n\ndependencyManagement {\n\timports {\n mavenBom 'org.springframework:spring-framework-bom:{spring-core-version}'\n\t}\n}\n----\n======\n\n[TIP]\nSpring provides a https://github.com/spring-gradle-plugins/dependency-management-plugin[`Dependency Management Plugin`] for Gradle\n\nThe preceding example ensures that all the transitive dependencies of Spring LDAP use the Spring 6 modules.\n\n[NOTE]\n====\nThis approach uses Maven's \"`bill of materials`\" (BOM) concept and is only available in Maven 2.0.9+.\nFor additional details about how dependencies are resolved, see https://maven.apache.org/guides/introduction/introduction-to-dependency-mechanism.html[Maven's Introduction to the Dependency Mechanism documentation].\n====\n\n[[maven-repositories]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/getting-spring-ldap.adoc", "title": "getting-spring-ldap", "heading": "Standalone Usage (Without Spring Boot)", "heading_level": 3, "file_order": 5, "section_index": 4, "content_hash": "99d7f99d99f108d234b735ae6588816227adc829940978c19de16aee49417e8e", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/getting-spring-ldap.adoc"}}
{"id": "sha256:f5c43d3faf4d114ac63dbbf738cd94933baf3ac15ac8f3da25ea99f98908ded3", "content": "All https://github.com/spring-projects/spring-security/wiki/Release-Schedule-Guidelines[GA releases] are deployed to Maven Central, so you need not declare additional Maven repositories in your build configuration.\n\nFor Gradle using the `mavenCentral()` repository is sufficient for GA releases.\n\n.build.gradle\n[source,groovy]\n----\nrepositories {\n\tmavenCentral()\n}\n----\n\nIf you use a SNAPSHOT version, you need to ensure that you have the Spring Snapshot repository defined:\n\n[tabs]\n======\nMaven::\n+\n.pom.xml\n[source,xml]\n----\n<repositories>\n\t<!-- ... possibly other repository elements ... -->\n\t<repository>\n <id>spring-snapshot</id>\n <name>Spring Snapshot Repository</name>\n <url>https://repo.spring.io/snapshot</url>\n\t</repository>\n</repositories>\n----\n\nGradle::\n+\n.build.gradle\n[source,groovy]\n----\nrepositories {\n\tmaven { url 'https://repo.spring.io/snapshot' }\n}\n----\n======\n\nIf you use a milestone or release candidate version, you need to ensure that you have the Spring Milestone repository defined, as the following example shows:\n\n[tabs]\n======\nMaven::\n+\n.pom.xml\n[source,xml]\n----\n<repositories>\n\t<!-- ... possibly other repository elements ... -->\n\t<repository>\n <id>spring-milestone</id>\n <name>Spring Milestone Repository</name>\n <url>https://repo.spring.io/milestone</url>\n\t</repository>\n</repositories>\n----\n\nGradle::\n+\n.build.gradle\n[source,groovy]\n----\nrepositories {\n\tmaven { url 'https://repo.spring.io/milestone' }\n}\n----\n======", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/getting-spring-ldap.adoc", "title": "getting-spring-ldap", "heading": "Maven Repositories", "heading_level": 3, "file_order": 5, "section_index": 5, "content_hash": "f5c43d3faf4d114ac63dbbf738cd94933baf3ac15ac8f3da25ea99f98908ded3", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/getting-spring-ldap.adoc"}}
{"id": "sha256:fb2cd1f45faf0f11bdc873a802013b3ede803a2b25f35e71fb037c0c55e2dbe4", "content": "[[spring-ldap-reference]]\nMattias Hellborg Arthursson; Ulrik Sandberg; Eric Dalquist; Keith Barlow; Rob Winch\n\nSpring LDAP makes it easier to build Spring-based applications that use the Lightweight Directory Access Protocol.\n\n_Copies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically._", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/index.adoc", "title": "index", "heading": "index", "heading_level": 1, "file_order": 6, "section_index": 0, "content_hash": "fb2cd1f45faf0f11bdc873a802013b3ede803a2b25f35e71fb037c0c55e2dbe4", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/index.adoc"}}
{"id": "sha256:fde17cd5bcf6a18200fd469418060b85eb59a0439605d015d2985a9b7909e76a", "content": "[[introduction]]\n\nThis section offers a relatively quick introduction to Spring LDAP. It includes the following content:\n\n* xref:introduction.adoc#spring-ldap-introduction-overview[Overview]\n* xref:introduction.adoc#spring-ldap-traditional-ldap-vs-ldaptemplate[Traditional Java LDAP versus `LdapClient`]\n* xref:introduction.adoc#spring-ldap-new-2.2[What's new in 2.2]\n* xref:introduction.adoc#spring-ldap-new-2.1[What's new in 2.1]\n* xref:introduction.adoc#spring-ldap-new-2.0[What's new in 2.0]\n* xref:introduction.adoc#spring-ldap-packaging-overview[Packaging Overview]\n* xref:introduction.adoc#spring-ldap-getting-started[Getting Started]\n* xref:introduction.adoc#spring-ldap-support[Support]\n* xref:introduction.adoc#spring-ldap-acknowledgements[Acknowledgements]\n\n[[spring-ldap-introduction-overview]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "introduction", "heading_level": 1, "file_order": 7, "section_index": 0, "content_hash": "fde17cd5bcf6a18200fd469418060b85eb59a0439605d015d2985a9b7909e76a", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:0becad39c4eb424ad59302f9a01306922d676f29c9efa1b520f5ab0d03b7d2f4", "content": "Spring LDAP is designed to simplify LDAP programming in Java. Some of the features provided by the library are:\n\n* https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/jdbc/core/JdbcTemplate.html[`JdbcTemplate`]-style template simplifications to LDAP programming.\n* JPA- or Hibernate-style annotation-based object and directory mapping.\n* Spring Data repository support, including support for QueryDSL.\n* Utilities to simplify building LDAP queries and distinguished names.\n* Proper LDAP connection pooling.\n* Client-side LDAP compensating transaction support.\n\n[[spring-ldap-traditional-ldap-vs-ldapclient]]\n[[spring-ldap-traditional-ldap-vs-ldaptemplate]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "Overview", "heading_level": 2, "file_order": 7, "section_index": 1, "content_hash": "0becad39c4eb424ad59302f9a01306922d676f29c9efa1b520f5ab0d03b7d2f4", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:f820b2df40cf38f4ef8553f421051ccdd75a35475e8c40f4724a8d68902b01f2", "content": "Consider a method that should search some storage for all persons and return their names in a list.\nBy using JDBC, we would create a _connection_ and run a _query_ by using a _statement_. We would then loop over the _result set_ and retrieve the _column_ we want, adding it to a list.\n\nWorking against an LDAP database with JNDI, we would create a _context_ and perform a _search_ by using a _search filter_. We would then loop over the resulting _naming enumeration_, retrieve the _attribute_ we want, and add it to a list.\n\nThe traditional way of implementing this person-name search method in Java LDAP looks like the next example. Note the code marked *bold* - this is the code that\nactually performs tasks related to the business purpose of the method. The rest is plumbing.\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repository;\n\npublic class TraditionalPersonRepoImpl implements PersonRepo {\n public List<String> getAllPersonNames() {\n Hashtable env = new Hashtable();\n env.put(Context.INITIAL_CONTEXT_FACTORY, \"com.sun.jndi.ldap.LdapCtxFactory\");\n env.put(Context.PROVIDER_URL, \"ldap://localhost:389/dc=example,dc=com\");\n\n DirContext ctx;\n try {\n ctx = new InitialDirContext(env);\n } catch (NamingException e) {\n throw new RuntimeException(e);\n }\n\n List<String> list = new LinkedList<String>();\n NamingEnumeration results = null;\n try {\n SearchControls controls = new SearchControls();\n controls.setSearchScope(SearchControls.SUBTREE_SCOPE);\n results = ctx.**search**(\"\", **\"(objectclass=person)\"**, controls);\n\n while (results.hasMore()) {\n SearchResult searchResult = (SearchResult) results.next();\n Attributes attributes = searchResult.getAttributes();\n **Attribute attr = attributes.get(\"cn\");\n String cn = attr.get().toString();**\n list.add(cn);\n }\n } catch (NameNotFoundException e) {\n // The base context was not found.\n // Just clean up and exit.\n } catch (NamingException e) {\n throw new RuntimeException(e);\n } finally {\n if (results != null) {\n try {\n results.close();\n } catch (Exception e) {\n // Never mind this.\n }\n }\n if (ctx != null) {\n try {\n ctx.close();\n } catch (Exception e) {\n // Never mind this.\n }\n }\n }\n **return list;**\n }\n}\n----\n====\n\nBy using the Spring LDAP `AttributesMapper` and `LdapClient` classes, we get the exact same functionality with the following code:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n\n public void setLdapClient(LdapClient ldapClient) {\n this.ldapClient = ldapClient;\n }\n\n public List<String> getAllPersonNames() {\n return ldapClient.search().query(\n **query().where(\"objectclass\").is(\"person\")**\n ).toObject((Attributes attrs) ->\n **attrs.get(\"cn\").get().toString();**\n );\n }\n}\n----\n====\n\nThe amount of boilerplate code is significantly less than in the traditional example.\nThe `LdapClient` search method makes sure a `DirContext` instance is created, performs the search, maps the attributes to a string by using the given `AttributesMapper`,\ncollects the strings in an internal list, and, finally, returns the list. It also makes sure that the `NamingEnumeration` and `DirContext` are properly closed and\ntakes care of any exceptions that might happen.\n\nNaturally, this being a Spring Framework sub-project, we use Spring to configure our application, as follows:\n\n====\n[source,xml]\n----\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xmlns:ldap=\"http://www.springframework.org/schema/ldap\"\n xsi:schemaLocation=\"http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd\n http://www.springframework.org/schema/ldap https://www.springframework.org/schema/ldap/spring-ldap.xsd\">\n\n <ldap:context-source\n url=\"ldap://localhost:389\"\n base=\"dc=example,dc=com\"\n username=\"cn=Manager\"\n password=\"secret\" />\n\n <bean id=\"ldapClient\" class=\"org.springframework.ldap.core.LdapClient\" factory-method=\"create\">\n <constructor-arg ref=\"contextSource\" />\n </bean>\n\n <bean id=\"personRepo\" class=\"com.example.repo.PersonRepoImpl\">\n <property name=\"ldapClient\" ref=\"ldapClient\" />\n </bean>\n</beans>\n----\n====\n\nNOTE: To use the custom XML namespace to configure the Spring LDAP components, you need to include references to this namespace in your XML declaration, as in the preceding example.\n\n[[spring-ldap-new-2.2]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "Traditional Java LDAP versus `LdapClient`", "heading_level": 2, "file_order": 7, "section_index": 2, "content_hash": "f820b2df40cf38f4ef8553f421051ccdd75a35475e8c40f4724a8d68902b01f2", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:ab4d12ce9547ff68f1995c859881cca1687f12acd28771e99a59eda804af7525", "content": "For complete details of 2.2, see the changelog for https://github.com/spring-projects/spring-ldap/milestone/21?closed=1[2.2.0.RC1].\nThe highlights of Spring LDAP 2.2 are as follows:\n\n* https://github.com/spring-projects/spring-ldap/issues/415[#415]: Added support for Spring 5\n* https://github.com/spring-projects/spring-ldap/pull/399[#399]: Embedded UnboundID LDAP Server support\n* https://github.com/spring-projects/spring-ldap/pull/410[#410]: Added documentation for the Commons Pool 2 Support\n\n[[spring-ldap-new-2.1]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "What's new in 2.2", "heading_level": 2, "file_order": 7, "section_index": 3, "content_hash": "ab4d12ce9547ff68f1995c859881cca1687f12acd28771e99a59eda804af7525", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:f2622c3f2bd347449574512d42206593ca92d0feb231a6f61063905a4cde36c1", "content": "For complete details of 2.1, see the changelog for https://github.com/spring-projects/spring-ldap/issues?q=milestone%3A2.1.0.RC1[2.1.0.RC1] and for https://github.com/spring-projects/spring-ldap/issues?utf8=%E2%9C%93&q=milestone%3A2.1.0[2.1.0]\nThe highlights of Spring LDAP 2.1 are as follows.\n\n* https://github.com/spring-projects/spring-ldap/pull/390[#390]: Added Spring Data Hopper support\n* https://github.com/spring-projects/spring-ldap/issues/351[#351]: Added support for commons-pool2\n* https://github.com/spring-projects/spring-ldap/issues/370[#370]: Added support property placeholders in the XML Namespace\n* https://github.com/spring-projects/spring-ldap/pull/392[#392]: Added document Testing Support\n* https://github.com/spring-projects/spring-ldap/pull/401[#401]: Added a switch to assertj\n* Migrated from JIRA to https://github.com/spring-projects/spring-ldap/issues[GitHub Issues]\n* Added https://gitter.im/spring-projects/spring-ldap[Gitter Chat]\n\n[[spring-ldap-new-2.0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "What's new in 2.1", "heading_level": 2, "file_order": 7, "section_index": 4, "content_hash": "f2622c3f2bd347449574512d42206593ca92d0feb231a6f61063905a4cde36c1", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:91de6ac666dc0b01871c09bfb36c3db8fc6e7b7c5e49a89ac251331feac2dab6", "content": "While quite significant modernizations have been made to the Spring LDAP API in version 2.0, great care has been taken to ensure backward compatibility as far as possible.\nCode that works with Spring LDAP 1.3.x should, with few exceptions, compile and run when you use the 2.0 libraries without any modifications.\n\nThe exception is a small number of classes that have been moved to new packages in order to make a couple of important refactorings possible.\nThe moved classes are typically not part of the intended public API, and the migration procedure should be smooth. Whenever a Spring LDAP class cannot be found after upgrade, you should organize the imports in your IDE.\n\nYou should expect to encounter some deprecation warnings, though, and there are also a lot of other API improvements.\nThe recommendation for getting as much as possible out of the 2.0 version is to move away from the deprecated classes and methods and migrate to the new, improved API utilities.\n\nThe following list briefly describes the most important changes in Spring LDAP 2.0:\n\n* Java 6 is now required by Spring LDAP. Spring versions starting at 2.0 and up are still supported.\n* The central API has been updated with Java 5+ features such as generics and varargs.\n As a consequence, the entire `spring-ldap-tiger` module has been deprecated, and we encourage you to migrate to using the core Spring LDAP classes.\n The parameterization of the core interfaces causes lots of compilation warnings on existing code, and we encourage you to take appropriate action to get rid of these warnings.\n* The ODM (Object-Directory Mapping) functionality has been moved to core, and there are new methods in `LdapOperations` and `LdapTemplate` that use this automatic translation to and from ODM-annotated classes. See xref:odm.adoc[Object-Directory Mapping (ODM)] for more information.\n* A custom XML namespace is now (finally) provided to simplify configuration of Spring LDAP. See <<configuration>> for more information.\n* Spring LDAP now provides support for Spring Data Repository and QueryDSL. See xref:repositories.adoc[Spring LDAP Repositories] for more information.\n* `Name` instances as attribute values are now handled properly with regards to distinguished name equality in `DirContextAdapter` and ODM.\n See xref:dirobjectfactory.adoc#dns-as-attribute-values[`DirContextAdapter` and Distinguished Names as Attribute Values] and xref:odm.adoc#odm-dn-attributes[ODM and Distinguished Names as Attribute Values] for more information.\n* `DistinguishedName` and associated classes have been deprecated in favor of the standard Java `LdapName`.\n See xref:spring-ldap-basic-usage.adoc#ldap-names[Dynamically Building Distinguished Names] for information on how the library helps when working with `LdapName` objects.\n* Fluent LDAP query building support has been added. This makes for a more pleasant programming experience when working with LDAP searches in Spring LDAP.\n See xref:spring-ldap-basic-usage.adoc#basic-queries[Building LDAP Queries] and xref:query-builder-advanced.adoc[Advanced LDAP Queries] for more information about the LDAP query builder support.\n* The old `authenticate` methods in `LdapTemplate` have been deprecated in favor of a couple of new `authenticate` methods that work with `LdapQuery` objects and _throw exceptions_ on authentication failure, making it easier for the user to find out what caused an authentication attempt to fail.\n* The https://github.com/spring-projects/spring-ldap/tree/main/samples[samples] have been polished and updated to make use of the features in 2.0.\n Quite a bit of effort has been put into providing a useful example of an https://github.com/spring-projects/spring-ldap/tree/main/samples/user-admin[LDAP user management application].\n\n* Added `LdapClient.create(LdapTemplate)` to simplify constructing an `LdapClient` from an `LdapTemplate`\n\n[[spring-ldap-packaging-overview]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "What's new in 2.0", "heading_level": 2, "file_order": 7, "section_index": 5, "content_hash": "91de6ac666dc0b01871c09bfb36c3db8fc6e7b7c5e49a89ac251331feac2dab6", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:215d9bc9c369cef14c95dc6f3fa0d604cd4324df81c67be479ae6099545b0519", "content": "At a minimum, to use Spring LDAP you need the following:\n\n* `spring-ldap-core`: The Spring LDAP library\n* `spring-core`: Miscellaneous utility classes used internally by the framework\n* `spring-beans`: Interfaces and classes for manipulating Java beans\n* `slf4j`: A simple logging facade, used internally\n\nIn addition to the required dependencies, the following optional dependencies are required for certain functionality:\n\n* `spring-data-ldap`: Base infrastructure for repository support and so on\n* `spring-context`: Needed if your application is wired up by using the Spring Application Context. `spring-context` adds the ability for application objects to obtain resources by using a consistent API. It is definitely needed if you plan to use the `BaseLdapPathBeanPostProcessor`.\n* `spring-tx`: Needed if you plan to use the client-side compensating transaction support.\n* `spring-jdbc`: Needed if you plan to use the client-side compensating transaction support.\n* `commons-pool`: Needed if you plan to use the pooling functionality.\n* `spring-batch`: Needed if you plan to use the LDIF parsing functionality together with Spring Batch.\n\nNOTE: `spring-data-ldap` transitively adds `spring-repository.xsd`, which `spring-ldap.xsd` uses.\nBecause of this, Spring LDAP's XML config support requires the dependency even when Spring Data's feature set is not in use.\n\n[[spring-ldap-getting-started]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "Packaging Overview", "heading_level": 2, "file_order": 7, "section_index": 6, "content_hash": "215d9bc9c369cef14c95dc6f3fa0d604cd4324df81c67be479ae6099545b0519", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:211d0ef82f2164b6008ebcaa1cdf87d6e798acdd8595a7b751ae068e1a86c62c", "content": "The https://github.com/spring-projects/spring-ldap/tree/main/samples[samples] provide some useful examples of how to use Spring LDAP for common use cases.\n\n[[spring-ldap-support]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "Getting Started", "heading_level": 2, "file_order": 7, "section_index": 7, "content_hash": "211d0ef82f2164b6008ebcaa1cdf87d6e798acdd8595a7b751ae068e1a86c62c", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:b548a74174ab1bcf7d457d51a9da0b1b46ba323d526f0f406fc7b0d4560adbea", "content": "If you have questions, ask them on https://stackoverflow.com/questions/tagged/spring-ldap[Stack Overflow with the `spring-ldap` tag].\nThe project web page is https://spring.io/spring-ldap/.\n\n[[spring-ldap-acknowledgements]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "Support", "heading_level": 2, "file_order": 7, "section_index": 8, "content_hash": "b548a74174ab1bcf7d457d51a9da0b1b46ba323d526f0f406fc7b0d4560adbea", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:c76051e031528b128b5886536f78a9d5859e6a6a3e7bfd58370e01eba4d709da", "content": "The initial effort when starting the Spring LDAP project was sponsored by https://www.jayway.com[Jayway].\nCurrent maintenance of the project is funded by https://pivotal.io[Pivotal], which has since been acquired by https://vmware.com[VMware].\n\nThanks to https://structure101.com/[Structure101] for providing an open source license that has come in handy for keeping the project structure in check.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/introduction.adoc", "title": "introduction", "heading": "Acknowledgements", "heading_level": 2, "file_order": 7, "section_index": 9, "content_hash": "c76051e031528b128b5886536f78a9d5859e6a6a3e7bfd58370e01eba4d709da", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/introduction.adoc"}}
{"id": "sha256:788c8cd4fd00c45ebd5b78084fb98e97ca3c52c471f0c4e8308d88fbb09037da", "content": "[[ldif-parsing]]\n\nLDAP Directory Interchange Format (LDIF) files are the standard medium for describing directory data in a flat-file format. The most common uses of this format include information transfer and archival. However, the standard also defines a way to describe modifications to stored data in a flat-file format. LDIFs of this later type are typically referred to as _changetype_ or _modify_ LDIFs.\n\nThe `org.springframework.ldap.ldif` package provides the classes needed to parse LDIF files and deserialize them into tangible objects. The `LdifParser` is the main class of the `org.springframework.ldap.ldif` package and is capable of parsing files that comply with RFC 2849. This class reads lines from a resource and assembles them into an `LdapAttributes` object.\n\nNOTE: The `LdifParser` currently ignores _changetype_ LDIF entries, as their usefulness in the context of an application has yet to be determined.\n\n[[object-representation]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/ldif-parsing.adoc", "title": "ldif-parsing", "heading": "ldif-parsing", "heading_level": 1, "file_order": 8, "section_index": 0, "content_hash": "788c8cd4fd00c45ebd5b78084fb98e97ca3c52c471f0c4e8308d88fbb09037da", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/ldif-parsing.adoc"}}
{"id": "sha256:1ee5bd521ec75bdfd7b954d5b267518417b80859452eef2cf910f4b38fee0273", "content": "Two classes in the `org.springframework.ldap.core` package provide the means to represent an LDIF in code:\n\n* `LdapAttribute`: Extends `javax.naming.directory.BasicAttribute` adding support for LDIF options as defined in RFC2849.\n* `LdapAttributes`: Extends `javax.naming.directory.BasicAttributes` adding specialized support for DNs.\n\n`LdapAttribute` objects represent options as a `Set<String>`. The DN support added to the `LdapAttributes` object employs the `javax.naming.ldap.LdapName` class.\n\n[[the-parser]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/ldif-parsing.adoc", "title": "ldif-parsing", "heading": "Object Representation", "heading_level": 2, "file_order": 8, "section_index": 1, "content_hash": "1ee5bd521ec75bdfd7b954d5b267518417b80859452eef2cf910f4b38fee0273", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/ldif-parsing.adoc"}}
{"id": "sha256:7c362e3497b1b53bdd74080d0eb0ccaf5ab74f7872fe4b6e3eddf8565ae8a2b5", "content": "The `Parser` interface provides the foundation for operation and employs three supporting policy definitions:\n\n* `SeparatorPolicy`: Establishes the mechanism by which lines are assembled into attributes.\n* `AttributeValidationPolicy`: Ensures that attributes are correctly structured prior to parsing.\n* `Specification`: Provides a mechanism by which object structure can be validated after assembly.\n\nThe default implementations of these interfaces are as follows:\n\n* `org.springframework.ldap.ldif.parser.LdifParser`\n* `org.springframework.ldap.ldif.support.SeparatorPolicy`\n* `org.springframework.ldap.ldif.support.DefaultAttributeValidationPolicy`\n* `org.springframework.ldap.schema.DefaultSchemaSpecification`\n\nTogether, these four classes parse a resource line by line and translate the data into `LdapAttributes` objects.\n\nThe `SeparatorPolicy` determines how individual lines read from the source file should be interpreted, as the LDIF specification lets attributes span multiple lines. The default policy assesses lines in the context of the order in which they were read to determine the nature of the line in consideration. _control_ attributes and _changetype_ records are ignored.\n\nThe `DefaultAttributeValidationPolicy` uses REGEX expressions to ensure that each attribute conforms to a valid attribute format (according to RFC 2849) once parsed. If an attribute fails validation, an `InvalidAttributeFormatException` is logged, and the record is skipped (the parser returns `null`).\n\n[[schema-validation]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/ldif-parsing.adoc", "title": "ldif-parsing", "heading": "The Parser", "heading_level": 2, "file_order": 8, "section_index": 2, "content_hash": "7c362e3497b1b53bdd74080d0eb0ccaf5ab74f7872fe4b6e3eddf8565ae8a2b5", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/ldif-parsing.adoc"}}
{"id": "sha256:27c7cb9c461ffd897d37783d77ec932a7ee387bde41d9094891192069c5de6c8", "content": "A mechanism for validating parsed objects against a schema is available through the `Specification` interface in the `org.springframework.ldap.schema` package. The `DefaultSchemaSpecification` does not do any validation and is available for instances where records are known to be valid and need not be checked. This option saves the performance penalty that validation imposes. The `BasicSchemaSpecification` applies basic checks, such as ensuring DN and object class declarations have been provided. Currently, validation against an actual schema requires implementation of the `Specification` interface.\n\n[[spring-batch-integration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/ldif-parsing.adoc", "title": "ldif-parsing", "heading": "Schema Validation", "heading_level": 2, "file_order": 8, "section_index": 3, "content_hash": "27c7cb9c461ffd897d37783d77ec932a7ee387bde41d9094891192069c5de6c8", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/ldif-parsing.adoc"}}
{"id": "sha256:4745c5c354d076fda5bf6474b0d64c9e017b2f05b0b2ec2ec0c65582e47b3158", "content": "While the `LdifParser` can be employed by any application that requires parsing of LDIF files, Spring offers a batch processing framework that offers many file-processing utilities for parsing delimited files such as CSV. The `org.springframework.ldap.ldif.batch` package offers the classes needed to use the `LdifParser` as a valid configuration option in the Spring Batch framework.\nThere are five classes in this package. Together, they offer three basic use cases:\n\n* Reading LDIF records from a file and returning an `LdapAttributes` object.\n* Reading LDIF records from a file and mapping records to Java objects (POJOs).\n* Writing LDIF records to a file.\n\nThe first use case is accomplished with `LdifReader`. This class extends Spring Batch's `AbstractItemCountingItemStreamItemReader` and implements its `ResourceAwareItemReaderItemStream`. It fits naturally into the framework, and you can use it to read `LdapAttributes` objects from a file.\n\nYou can use `MappingLdifReader` to map LDIF objects directly to any POJO. This class requires you to provide an implementation of the `RecordMapper` interface. This implementation should implement the logic for mapping objects to POJOs.\n\nYou can implement `RecordCallbackHandler` and provide the implementation to either reader. You can use this handler to operate on skipped records. See the https://docs.spring.io/spring-batch/docs/current/api/org/springframework/batch/item/ldif/RecordCallbackHandler.html[Spring Batch API documentation] for more information.\n\nThe last member of this package, the `LdifAggregator`, can be used to write LDIF records to a file. This class invokes the `toString()` method of the `LdapAttributes` object.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/ldif-parsing.adoc", "title": "ldif-parsing", "heading": "Spring Batch Integration", "heading_level": 2, "file_order": 8, "section_index": 4, "content_hash": "4745c5c354d076fda5bf6474b0d64c9e017b2f05b0b2ec2ec0c65582e47b3158", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/ldif-parsing.adoc"}}
{"id": "sha256:aa48a62064238017362749ea7fd82be3e02de22b2a33465b231884c636bb2759", "content": "[[modules]]\nSpring LDAP is broken up into the following separate modules:\n\n* spring-ldap-core - the xref:spring-ldap-basic-usage.adoc[core] Spring LDAP library, including xref:odm.adoc[the ODM framework]\n* spring-ldap-test - support classes that help LDAP with xref:testing.adoc[integration testing]\n* spring-ldap-ldif-core - the Spring LDAP xref:ldif-parsing.adoc[LDIF parsing library]\n* spring-ldap-ldif-batch - the Spring Batch integration layer for the LDIF parsing library\n\nAlso of interest is https://docs.spring.io/spring-data/ldap/reference[spring-data-ldap], Spring Data's integration with Spring LDAP.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/modules.adoc", "title": "modules", "heading": "modules", "heading_level": 1, "file_order": 9, "section_index": 0, "content_hash": "aa48a62064238017362749ea7fd82be3e02de22b2a33465b231884c636bb2759", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/modules.adoc"}}
{"id": "sha256:f2f7881985521850edbd1dc84bacd8995b58b85ae3d65cc882d5c4a1ee48fe05", "content": "[[observability]]\n\nSpring LDAP integrates with Micromter.\nSimilar to LDAP's transaction support, observability happens in `DirContext` instances.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/observability.adoc", "title": "observability", "heading": "observability", "heading_level": 1, "file_order": 10, "section_index": 0, "content_hash": "f2f7881985521850edbd1dc84bacd8995b58b85ae3d65cc882d5c4a1ee48fe05", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/observability.adoc"}}
{"id": "sha256:fbb08f2bc56e1ca2a83e1c355874b7219712db014f80b5b238593e02f6bb95f4", "content": "To minimally configure a Spring Boot application to observe LDAP operations, first configure Boot, then publish the following bean:\n\n[source,java]\n====\n@Bean\nstatic ContextSourceObservationPostProcessor observationPostProcessor(ObjectProvider<ObservationRegistry> provider) {\n return new ContextSourceObservationPostProcessor(provider);\n}\n====\n\nThis will cause the `LdapContextSource` bean that Boot publishes to be wrapped in an `ObservationContextSource` which will time LDAP queries and emit corresponding traces.\n\nOr if you aren't using Boot or are otherwise publishing your own `ContextSource` instance, then you can do:\n\n[source,java]\n====\n@Bean\nContextSource contextSource(ObservationRegistry registry) {\n ContextSource observed = createContextSource();\n return new ObservationContextSource(observed, registry);\n}\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/observability.adoc", "title": "observability", "heading": "Minimal Configuration", "heading_level": 2, "file_order": 10, "section_index": 1, "content_hash": "fbb08f2bc56e1ca2a83e1c355874b7219712db014f80b5b238593e02f6bb95f4", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/observability.adoc"}}
{"id": "sha256:a318bab004f3560aa7d545b9901f9de8686411a23a6a059e31bdba37e6538746", "content": "Each observation is under the name `spring.ldap.dir.context.operations` with a contextual name of `perform _operation_`.\n\nThe following is a truncated output of `DirContext#getAttributes` when instrumented with Micrometer:\n\n[source,bash]\n====\n2025-01-06T19:02:00.343-07:00 INFO 2036360 --- [nio-8080-exec-1] [677c8af4f5f02980a1584d0ac0b9fba4-d38e906e55d92746] i.m.o.ObservationTextPublisher : START - name='spring.ldap.dir.context.operations', contextualName='null', error='null', lowCardinalityKeyValues=[base='dc=springframework,dc=org', operation='get.attributes', urls='[ldap://localhost:41283/]'], highCardinalityKeyValues=[attribute.ids='null', name='uid=user,ou=people'], ... duration(nanos)=243104.0 ... parentObservation={name=spring.security.authentications ... parentObservation={name=spring.security.filterchains(security filterchain before) ... parentObservation={name=http.server.requests(null) ...\n2025-01-06T19:02:00.345-07:00 INFO 2036360 --- [nio-8080-exec-1] [677c8af4f5f02980a1584d0ac0b9fba4-daa1bbc981aade27] i.m.o.ObservationTextPublisher : OPEN - name='spring.ldap.dir.context.operations', ...\n2025-01-06T19:02:00.363-07:00 INFO 2036360 --- [nio-8080-exec-1] [677c8af4f5f02980a1584d0ac0b9fba4-daa1bbc981aade27] i.m.o.ObservationTextPublisher : CLOSE - name='spring.ldap.dir.context.operations', ...\n2025-01-06T19:02:00.364-07:00 INFO 2036360 --- [nio-8080-exec-1] [677c8af4f5f02980a1584d0ac0b9fba4-d38e906e55d92746] i.m.o.ObservationTextPublisher : STOP - name='spring.ldap.dir.context.operations', ...\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/observability.adoc", "title": "observability", "heading": "Runtime Expectations", "heading_level": 2, "file_order": 10, "section_index": 2, "content_hash": "a318bab004f3560aa7d545b9901f9de8686411a23a6a059e31bdba37e6538746", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/observability.adoc"}}
{"id": "sha256:2e15eadc7a963dce7077449794819de0c4ce2b1ecd0bfd597374a092f264d0ce", "content": "[[odm]]\n\nObject-relational mapping frameworks (such as Hibernate and JPA) offer developers the ability to use annotations to map relational database tables to Java objects.\nThe Spring LDAP project offers a similar ability with respect to LDAP directories through a number of methods in `LdapOperations`:\n\n* `<T> T findByDn(Name dn, Class<T> clazz)`\n* `<T> T findOne(LdapQuery query, Class<T> clazz)`\n* `<T> List<T> find(LdapQuery query, Class<T> clazz)`\n* `<T> List<T> findAll(Class<T> clazz)`\n* `<T> List<T> findAll(Name base, SearchControls searchControls, Class<T> clazz)`\n* `<T> List<T> findAll(Name base, Filter filter, SearchControls searchControls, Class<T> clazz)`\n* `void create(Object entry)`\n* `void update(Object entry)`\n* `void delete(Object entry)`\n\n[[configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/odm.adoc", "title": "odm", "heading": "odm", "heading_level": 1, "file_order": 11, "section_index": 0, "content_hash": "2e15eadc7a963dce7077449794819de0c4ce2b1ecd0bfd597374a092f264d0ce", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/odm.adoc"}}
{"id": "sha256:8c28cb8fb3fc3f51a065bc7aee6f8117a3fd98e364d4616e8863b05b3683d158", "content": "`LdapTemplate` constructs a default `ObjectDirectoryMapper` which typically renders additional configuration unnecessary.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/odm.adoc", "title": "odm", "heading": "Configuration", "heading_level": 2, "file_order": 11, "section_index": 1, "content_hash": "8c28cb8fb3fc3f51a065bc7aee6f8117a3fd98e364d4616e8863b05b3683d158", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/odm.adoc"}}
{"id": "sha256:980b9c3077acd5c6c5b2ed95a7a182826ea7216a94c0282fbb223e138aca8846", "content": "`ObjectDirectoryMapper` supports `ConversionService` which allows you to specify customer ``Converter``s for mapping between Java and LDAP.\n\nWhen you are using Spring Boot, you can simply publish a `Converter` as you would normally and the `ObjectDirectoryMapper` bean that Boot provides will pick them up.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/odm.adoc", "title": "odm", "heading": "Converters with Boot", "heading_level": 3, "file_order": 11, "section_index": 2, "content_hash": "980b9c3077acd5c6c5b2ed95a7a182826ea7216a94c0282fbb223e138aca8846", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/odm.adoc"}}
{"id": "sha256:34ba1ea399209a7306a0f75196bdf99f01f2f9839dfe92e22595857a43efa481", "content": "You can also make `ObjectDirectoryMapper` available as a `@Bean` by importing `ObjectDirectoryMapperConfiguration` like so:\n\n[source,java]\n----\n@Import(ObjectDirectoryMapperConfiguration.class)\n@Configuration\npublic class LdapConfig {\n\t// ...\n}\n----\n\nYou can then supply it to your `LdapTemplate` instance as follows:\n\n[source,java]\n----\n@Bean\nLdapTemplate ldapTemplate(ContextSource contextSource, ObjectDirectoryMapper odm) {\n\tLdapTemplate ldap = new LdapTemplate(contextSource);\n\tldap.setObjectDirectoryMapper(odm);\n\treturn ldap;\n}\n----\n\nDoing so will make so that Spring LDAP will use your configured `Converter` instances.\n\n[[annotations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/odm.adoc", "title": "odm", "heading": "Converters without Boot", "heading_level": 3, "file_order": 11, "section_index": 3, "content_hash": "34ba1ea399209a7306a0f75196bdf99f01f2f9839dfe92e22595857a43efa481", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/odm.adoc"}}
{"id": "sha256:61744899f533ce502beae50e15252fd4cd2196f9175303f1aec5a637f8f3700c", "content": "Entity classes managed with the object mapping methods are required to be annotated with annotations from the `org.springframework.ldap.odm.annotations` package. The available annotations are:\n\n* `@Entry`: Class level annotation indicating the `objectClass` definitions to which the entity maps.__ (required)__\n* `@Id`: Indicates the entity DN. The field declaring this attribute must be a derivative of the `javax.naming.Name` class. (required)\n* `@Attribute`: Indicates the mapping of a directory attribute to the object class field.\n* `@DnAttribute`: Indicates the mapping of a DN attribute to the object class field.\n* `@Transient`: Indicates the field is not persistent and should be ignored by the `OdmManager`.\n\nThe `@Entry` and `@Id` annotations are required to be declared on managed classes.\n`@Entry` is used to specify which object classes the entity maps to and (optionally) the directory root of the LDAP entries represented by the class.\nAll object classes for which fields are mapped are required to be declared. Note that, when creating new entries of the managed class,\nonly the declared object classes are used.\n\nIn order for a directory entry to be considered a match to the managed entity, all object classes declared by the directory entry must be declared by the `@Entry` annotation.\nFor example, assume that you have entries in your LDAP tree that have the following object classes: `inetOrgPerson,organizationalPerson,person,top`.\nIf you are interested only in changing the attributes defined in the `person` object class, you can annotate your `@Entry` with `@Entry(objectClasses = { \"person\", \"top\" })`.\nHowever, if you want to manage attributes defined in the `inetOrgPerson` objectclass, you need to use the following: `@Entry(objectClasses = { \"inetOrgPerson\", \"organizationalPerson\", \"person\", \"top\" })`.\n\nAll entity fields are mapped by their field name to LDAP attributes. The remaining annotations -- `@Id`, `@Attribute`, `@Transient`, and `@DnAttribute` -- affect how that mapping occurs.\n\nFirst, the `@Id` annotation maps the distinguished name of the entry to a field. The field must be an instance of `javax.naming.Name`.\n\nSecond, the `@Attribute` annotation maps entity fields to LDAP attributes.\nThis is handy when the attribute name is different from the field name.\nTo use `@Attribute`, you must declare the name of the attribute to which the field maps.\nOptionally, you can also guarantee and exact match by including the syntax OID of the LDAP attribute.\nFinally, `@Attribute` also provides the type declaration, which lets you indicate whether the attribute is regarded as binary- or string-based by the LDAP JNDI provider.\n\nThird, the `@Transient` annotation indicates that the given entity field does not map to an LDAP attribute.\n\nFinally, the `@DnAttribute` annotation additionally maps entity fields to components of an entry's distinguished name.\n\nConsider a class with the following annotation:\n\n====\n[source,java,role=\"primary\"]\n----\n@DnAttribute(name=\"uid\")\nString uid;\n----\n====\n\nand a DN like the following:\n\n====\n[source,bash]\n----\nuid=carla,dc=springframework,dc=org\n----\n====\n\nThen Spring LDAP will populate `uid` using `uid=carla` instead of looking for a `uid` attribute.\n\n[NOTE]\n----\nOnly fields of type `String` can be annotated with `@DnAttribute`. Other types are not supported.\n----\n\nYou can alternatively supply an index like so:\n\n====\n[source,java,role=\"primary\"]\n----\n@DnAttribute(index=1)\nString uid;\n\n@DnAttribute(index=0)\nString department;\n----\n====\n\nwhich is handy for DNs that have multiple components:\n\n====\n[source,bash]\n----\nuid=carla,department=engineering,dc=springframework,dc=org\n----\n====\n\nUsing an `index` also allows Spring LDAP to compute the DN for you when creating or locating an entity for update or deletion.\nFor update scenarios, this also automatically takes care of moving entries in the tree if attributes that are part of the distinguished name have changed.\n\n[NOTE]\n----\nNote that while both attributes are present on `@DnAttribute`, if `index` is specified, then `name` is ignored.\n----\n\n[NOTE]\nRemember that all fields are mapped to LDAP attributes by default.\n`@DnAttribute` does not change this; in other words, fields annotated with `@DnAttribute` will also map to an LDAP attribute, unless you also annotate the field with `@Transient`.\n\n[[execution]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/odm.adoc", "title": "odm", "heading": "Annotations", "heading_level": 2, "file_order": 11, "section_index": 4, "content_hash": "61744899f533ce502beae50e15252fd4cd2196f9175303f1aec5a637f8f3700c", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/odm.adoc"}}
{"id": "sha256:1bdea70ef14afa4eace7c6d45c4b37c556d7d6813be47e5080d9b39e24715bbd", "content": "When all components have been properly configured and annotated, the object mapping methods of `LdapTemplate` can be used as follows:\n\n.Execution\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\n\n@Entry(objectClasses = { \"person\", \"top\" }, base=\"ou=someOu\")\npublic class Person {\n @Id\n private Name dn;\n\n @Attribute(name=\"cn\")\n @DnAttribute(value=\"cn\", index=1)\n private String fullName;\n\n // No @Attribute annotation means this will be bound to the LDAP attribute\n // with the same value\n private String description;\n\n @DnAttribute(value=\"ou\", index=0)\n @Transient\n private String company;\n\n @Transient\n private String someUnmappedField;\n // ...more attributes below\n}\n\npublic class OdmPersonRepo {\n @Autowired\n private LdapTemplate ldapTemplate;\n\n public Person create(Person person) {\n ldapTemplate.create(person);\n return person;\n }\n\n public Person findByUid(String uid) {\n return ldapTemplate.findOne(query().where(\"uid\").is(uid), Person.class);\n }\n\n public void update(Person person) {\n ldapTemplate.update(person);\n }\n\n public void delete(Person person) {\n ldapTemplate.delete(person);\n }\n\n public List<Person> findAll() {\n return ldapTemplate.findAll(Person.class);\n }\n\n public List<Person> findByLastName(String lastName) {\n return ldapTemplate.find(query().where(\"sn\").is(lastName), Person.class);\n }\n\n public Stream<Person> streamFindByLastName(String lastName) {\n return ldapTemplate.findStream(query().where(\"sn\").is(lastName), Person.class);\n }\n}\n----\n====\n\n[[odm-dn-attributes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/odm.adoc", "title": "odm", "heading": "Execution", "heading_level": 2, "file_order": 11, "section_index": 5, "content_hash": "1bdea70ef14afa4eace7c6d45c4b37c556d7d6813be47e5080d9b39e24715bbd", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/odm.adoc"}}
{"id": "sha256:6ee6304963d5523511e0517de7e9e9d6c83931bec6ff412aa93ed080a266687d", "content": "Security groups in LDAP commonly contain a multi-value attribute, where each of the values is the distinguished name\nof a user in the system. The difficulties involved when handling these kinds of attributes are discussed in xref:dirobjectfactory.adoc#dns-as-attribute-values[`DirContextAdapter` and Distinguished Names as Attribute Values].\n\nODM also has support for `javax.naming.Name` attribute values, making group modifications easy, as the following example shows:\n\n.Example Group representation\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\n@Entry(objectClasses = {\"top\", \"groupOfUniqueNames\"}, base = \"cn=groups\")\npublic class Group {\n\n @Id\n private Name dn;\n\n @Attribute(name=\"cn\")\n @DnAttribute(\"cn\")\n private String name;\n\n @Attribute(name=\"uniqueMember\")\n private Set<Name> members;\n\n public Name getDn() {\n return dn;\n }\n\n public void setDn(Name dn) {\n this.dn = dn;\n }\n\n public Set<Name> getMembers() {\n return members;\n }\n\n public void setMembers(Set<Name> members) {\n this.members = members;\n }\n\n public String getName() {\n return name;\n }\n\n public void setName(String name) {\n this.name = name;\n }\n\n public void addMember(Name member) {\n members.add(member);\n }\n\n public void removeMember(Name member) {\n members.remove(member);\n }\n}\n----\n====\n\nWhen you modify group members by using `setMembers`, `addMember`, and `removeMember` and then calling `ldapTemplate.update()`,\nattribute modifications are calculated by using distinguished name equality, meaning that the text formatting of\ndistinguished names is disregarded when figuring out whether they are equal.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/odm.adoc", "title": "odm", "heading": "ODM and Distinguished Names as Attribute Values", "heading_level": 2, "file_order": 11, "section_index": 6, "content_hash": "6ee6304963d5523511e0517de7e9e9d6c83931bec6ff412aa93ed080a266687d", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/odm.adoc"}}
{"id": "sha256:04322d06e1dff6d81e5b08b1fb601d97feb261967f62437e0f7671a303be2f69", "content": "[[pooling]]\n\nPooling LDAP connections helps mitigate the overhead of creating a new LDAP connection for each LDAP interaction. While https://java.sun.com/products/jndi/tutorial/ldap/connect/pool.html[Java LDAP pooling support] exists, it is limited in its configuration options and features, such as connection validation and pool maintenance. Spring LDAP provides support for detailed pool configuration on a per-`ContextSource` basis.\n\nPooling support is provided by supplying a `<ldap:pooling />` child element to the `<ldap:context-source />` element in the application context configuration. Read-only and read-write `DirContext` objects are pooled separately (if `anonymous-read-only` is specified). https://commons.apache.org/pool/index.html[Jakarta Commons-Pool] is used to provide the underlying pool implementation.\n\n[[dircontext-validation]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "pooling", "heading_level": 1, "file_order": 12, "section_index": 0, "content_hash": "04322d06e1dff6d81e5b08b1fb601d97feb261967f62437e0f7671a303be2f69", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:a17d01c24a3ad49d00980315f7a7a20c3158ea10528dc85e2d5df04f1b7aaa69", "content": "Validation of pooled connections is the primary motivation for using a custom pooling library versus the JDK-provided LDAP pooling functionality. Validation allows pooled `DirContext` connections to be checked to ensure that they are still properly connected and configured when checking them out of the pool, checking them into the pool, or while they are idle in the pool.\n\nIf connection validation is configured, pooled connections are validated by using `DefaultDirContextValidator`.\n`DefaultDirContextValidator` does a `DirContext.search(String, String, SearchControls)`, with an empty name, a filter of `\"objectclass=*\"`, and `SearchControls` set to limit a single result with the only the `objectclass` attribute and a 500ms timeout. If the returned `NamingEnumeration` has results, the `DirContext` passes validation. If no results are returned or an exception is thrown, the `DirContext` fails validation.\nThe default settings should work with no configuration changes on most LDAP servers and provide the fastest way to validate the `DirContext`.\nIf you need customization, you can do so by using the validation configuration attributes, described in xref:pooling.adoc#pool-configuration[Pool Configuration].\n\nNOTE: Connections are automatically invalidated if they throw an exception that is considered non-transient. For example, if a `DirContext` instance throws a `javax.naming.CommunicationException`, it is interpreted as a non-transient error and the instance is automatically invalidated, without the overhead of an additional `testOnReturn` operation. The exceptions that are interpreted as non-transient are configured by using the `nonTransientExceptions` property of the `PoolingContextSource`.\n\n[[pool-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "`DirContext` Validation", "heading_level": 2, "file_order": 12, "section_index": 1, "content_hash": "a17d01c24a3ad49d00980315f7a7a20c3158ea10528dc85e2d5df04f1b7aaa69", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:64e975c298ee0b1d361021d29372711bb5205f03e08bb1bb9d4b53bc2a24036f", "content": "The following attributes are available on the `<ldap:pooling />` element for configuration of the DirContext pool:\n\n[cols=\"1,1,4a\"]\n.Pooling Configuration Attributes\n|===\n| Attribute | Default | Description\n\n| `max-active`\n| `8`\n| The maximum number of active connections of each type (read-only or read-write) that can be allocated from this pool at the same time. You can use a non-positive number for no limit.\n\n| `max-total`\n| `-1`\n| The overall maximum number of active connections (for all types) that can be allocated from this pool at the same time. You can use a non-positive number for no limit.\n\n| `max-idle`\n| `8`\n| The maximum number of active connections of each type (read-only or read-write) that can remain idle in the pool without extra connections being released. You can use a non-positive number for no limit.\n\n| `min-idle`\n| `0`\n| The minimum number of active connections of each type (read-only or read-write) that can remain idle in the pool without extra connections being created. You can use zero (the default) to create none.\n\n| `max-wait`\n| `-1`\n| The maximum number of milliseconds that the pool waits (when no connections are available) for a connection to be returned before throwing an exception. You can use a non-positive number to wait indefinitely.\n\n| `when-exhausted`\n| `BLOCK`\n| Specifies the behavior when the pool is exhausted.\n\n* The `FAIL` option throws `NoSuchElementException` when the pool is exhausted.\n* The `BLOCK` option waits until a new object is available. If `max-wait` is positive and no new object is available after the `max-wait` time expires, `NoSuchElementException` is thrown.\n* The `GROW` option creates and returns a new object (essentially making `max-active` meaningless).\n\n| `test-on-borrow`\n| `false`\n| Whether objects are validated before being borrowed from the pool. If the object fails to validate, it is dropped from the pool, and an attempt to borrow another is made.\n\n| `test-on-return`\n| `false`\n| Whether objects are validated before being returned to the pool.\n\n| `test-while-idle`\n| `false`\n| Whether objects are validated by the idle object evictor (if any). If an object fails to validate, it is dropped from the pool.\n\n| `eviction-run-interval-millis`\n| `-1`\n| The number of milliseconds to sleep between runs of the idle object evictor thread. When non-positive, no idle object evictor thread is run.\n\n| `tests-per-eviction-run`\n| `3`\n| The number of objects to examine during each run of the idle object evictor thread (if any).\n\n| `min-evictable-time-millis`\n| `1000 * 60 * 30` (30 minutes)\n| The minimum amount of time an object may sit idle in the pool before it is eligible for eviction by the idle object evictor (if any).\n\n| `validation-query-base`\n| `LdapUtils.emptyName()`\n| The search base to be used when validating connections. Used only if `test-on-borrow`, `test-on-return`, or `test-while-idle` is specified.\n\n| `validation-query-filter`\n| `objectclass=*`\n| The search filter to be used when validating connections. Used only if `test-on-borrow`, `test-on-return`, or `test-while-idle` is specified.\n\n| `validation-query-search-controls-ref`\n| `null`; default search control settings are described above.\n| The ID of a `SearchControls` instance to be used when validating connections. Only used if `test-on-borrow`, `test-on-return`, or `test-while-idle` is specified.\n\n| `non-transient-exceptions`\n| `javax.naming.CommunicationException`\n| Comma-separated list of `Exception` classes. The listed exceptions are considered non-transient with regards to eager invalidation. Should any of the listed exceptions (or subclasses of them) be thrown by a call to a pooled `DirContext` instance, that object is automatically invalidated without any additional testOnReturn operation.\n|===\n\n[[pool2-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "Pool Configuration", "heading_level": 2, "file_order": 12, "section_index": 2, "content_hash": "64e975c298ee0b1d361021d29372711bb5205f03e08bb1bb9d4b53bc2a24036f", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:2b4fd604ecd674b20c88684f21debdd51628affb9e9ea07584844b3f4da5cf8c", "content": "The following attributes are available on the `<ldap:pooling2 />` element for configuring the `DirContext` pool:\n\n[cols=\"1,1,4a\"]\n.Pooling Configuration Attributes\n|===\n| Attribute | Default | Description\n\n| `max-total`\n| `-1`\n| The overall maximum number of active connections (for all types) that can be allocated from this pool at the same time. You can use a non-positive number for no limit.\n\n| `max-total-per-key`\n| `8`\n| The limit on the number of object instances allocated by the pool (checked out or idle), per key. When the limit is reached, the sub-pool is exhausted. A negative value indicates no limit.\n\n| `max-idle-per-key`\n| `8`\n| The maximum number of active connections of each type (read-only or read-write) that can remain idle in the pool, without extra connections being released. A negative value indicates no limit.\n\n| `min-idle-per-key`\n| `0`\n| The minimum number of active connections of each type (read-only or read-write) that can remain idle in the pool, without extra connections being created. You can use zero (the default) to create none.\n\n| `max-wait`\n| `-1`\n| The maximum number of milliseconds that the pool waits (when there are no available connections) for a connection to be returned before throwing an exception. You can use a non-positive number to wait indefinitely.\n\n| `block-when-exhausted`\n| `true`\n| Whether to wait until a new object is available. If max-wait is positive, a `NoSuchElementException` is thrown if no new object is available after the `maxWait` time expires.\n\n| `test-on-create`\n| `false`\n| Whether objects are validated before borrowing. If the object fails to validate, then borrowing fails.\n\n| `test-on-borrow`\n| `false`\n| The indicator for whether objects are validated before being borrowed from the pool. If the object fails to validate, it is dropped from the pool, and an attempt to borrow another is made.\n\n| `test-on-return`\n| `false`\n| The indicator for whether objects are validated before being returned to the pool.\n\n| `test-while-idle`\n| `false`\n| The indicator for whether objects are validated by the idle object evictor (if any). If an object fails to validate, it is dropped from the pool.\n\n| `eviction-run-interval-millis`\n| `-1`\n| The number of milliseconds to sleep between runs of the idle object evictor thread. When non-positive, no idle object evictor thread is run.\n\n| `tests-per-eviction-run`\n| `3`\n| The number of objects to examine during each run of the idle object evictor thread (if any).\n\n| `min-evictable-time-millis`\n| `1000 * 60 * 30` (30 minutes)\n| The minimum amount of time an object may sit idle in the pool before it is eligible for eviction by the idle object evictor (if any).\n\n| `soft-min-evictable-time-millis`\n| `-1`\n| The minimum amount of time an object may sit idle in the pool before it is eligible for eviction by the idle object evictor, with the extra condition that at least the minimum number of object instances per key remain in the pool. This setting is overridden by `min-evictable-time-millis` if it is set to a positive value.\n\n| `eviction-policy-class`\n| `org.apache.commons.pool2.impl.DefaultEvictionPolicy`\n| The eviction policy implementation that is used by this pool. The pool tries to load the class by using the thread context class loader. If that fails, the pool tries to load the class by using the class loader that loaded this class.\n\n| `fairness`\n| `false`\n| The pool serves threads that are waiting to borrow connections fairly. `true` means that waiting threads are served as if waiting in a FIFO queue.\n\n| `jmx-enable`\n| `true`\n| JMX is enabled with the platform MBean server for the pool.\n\n| `jmx-name-base`\n| `null`\n| The JMX name base that is used as part of the name assigned to JMX enabled pools.\n\n| `jmx-name-prefix`\n| `pool`\n| The JMX name prefix that is used as part of the name assigned to JMX enabled pools.\n\n| `lifo`\n| `true`\n| The indicator for whether the pool has LIFO (last in, first out) behavior with respect to idle objects or as a FIFO (first in, first out) queue. LIFO always returns the most recently used object from the pool, while FIFO always returns the oldest object in the idle object pool\n\n| `validation-query-base`\n| `LdapUtils.emptyPath()`\n| The base DN to use for validation searches.\n\n| `validation-query-filter`\n| `objectclass=*`\n| The filter to use for validation queries.\n\n| `validation-query-search-controls-ref`\n| `null`; default search control settings are described above.\n| The ID of a `SearchControls` instance to be used when validating connections. Used only if `test-on-borrow`, `test-on-return`, or `test-while-idle` is specified\n\n| `non-transient-exceptions`\n| `javax.naming.CommunicationException`\n| Comma-separated list of `Exception` classes. The listed exceptions are considered non-transient with regards to eager invalidation. Should any of the listed exceptions (or subclasses of them) be thrown by a call to a pooled `DirContext` instance, that object is automatically invalidated without any additional testOnReturn operation.\n|===\n\n[[configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "Pool2 Configuration", "heading_level": 2, "file_order": 12, "section_index": 3, "content_hash": "2b4fd604ecd674b20c88684f21debdd51628affb9e9ea07584844b3f4da5cf8c", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:d4faa78bd927f6de10700b32207134da92fb416763edba6e5642193d9aaf7da1", "content": "Configuring pooling requires adding an `<ldap:pooling>` element nested in the `<ldap:context-source>` element, as follows:\n\n====\n[source,xml]\n[subs=\"verbatim,quotes\"]\n----\n<beans>\n ...\n <ldap:context-source\n password=\"secret\" url=\"ldap://localhost:389\" username=\"cn=Manager\">\n <ldap:pooling />\n </ldap:context-source>\n ...\n</beans>\n----\n====\n\nIn a real-world situation, you would probably configure the pool options and enable connection validation. The preceding example demonstrates the general idea.\n\n[[validation-configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "Configuration", "heading_level": 2, "file_order": 12, "section_index": 4, "content_hash": "d4faa78bd927f6de10700b32207134da92fb416763edba6e5642193d9aaf7da1", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:ad5aa622e3f4e6e4ea10db2681643b9ebc851193e3bb42059e69fa249c173adb", "content": "The following example tests each `DirContext` before it is passed to the client application and tests `DirContext` objects that have been sitting idle in the pool:\n\n====\n[source,xml]\n[subs=\"verbatim,quotes\"]\n----\n<beans>\n ...\n <ldap:context-source\n username=\"cn=Manager\" password=\"secret\" url=\"ldap://localhost:389\" >\n <ldap:pooling\n test-on-borrow=\"true\"\n test-while-idle=\"true\" />\n </ldap:context-source>\n ...\n</beans>\n----\n====\n\n[[known-issues]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "Validation Configuration", "heading_level": 3, "file_order": 12, "section_index": 5, "content_hash": "ad5aa622e3f4e6e4ea10db2681643b9ebc851193e3bb42059e69fa249c173adb", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:4f847bb86f64a26ca811a0cad53e303537d5a30e14e1efaf2845cdbe5abec1d0", "content": "This section describes issues that sometimes arise when people use Spring LDAP. At present, it covers the following issues:\n\n* xref:pooling.adoc#spring-ldap-known-issues-custom-authentication[Custom Authentication]\n\n[[spring-ldap-known-issues-custom-authentication]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "Known Issues", "heading_level": 2, "file_order": 12, "section_index": 6, "content_hash": "4f847bb86f64a26ca811a0cad53e303537d5a30e14e1efaf2845cdbe5abec1d0", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:609905818cbf4631d261154c2758fc054420616e187db90aae24434225a94db3", "content": "The `PoolingContextSource` assumes that all `DirContext` objects retrieved from `ContextSource.getReadOnlyContext()` have the same environment and, likewise, that all `DirContext` objects retrieved from `ContextSource.getReadWriteContext()` have the same environment. This means that wrapping an `LdapContextSource` configured with an `AuthenticationSource` in a `PoolingContextSource` does not function as expected. The pool would be populated by using the credentials of the first user, and, unless new connections were needed, subsequent context requests would not be filled for the user specified by the `AuthenticationSource` for the requesting thread.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/pooling.adoc", "title": "pooling", "heading": "Custom Authentication", "heading_level": 3, "file_order": 12, "section_index": 7, "content_hash": "609905818cbf4631d261154c2758fc054420616e187db90aae24434225a94db3", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/pooling.adoc"}}
{"id": "sha256:734a893df81018539620eb5cc70034f4a067dec4f21dd1789b91d70ea26ce4b5", "content": "[[preface]]\n\nThe Java Naming and Directory Interface (JNDI) is to LDAP programming what Java Database Connectivity (JDBC) is to SQL programming. There are several similarities between JDBC and JNDI/LDAP (Java LDAP). Despite being two completely different APIs with different pros and cons, they share a number of less flattering characteristics:\n\n* They require extensive plumbing code, even to perform the simplest of tasks.\n* All resources need to be correctly closed, no matter what happens.\n* Exception handling is difficult.\n\nThese points often lead to massive code duplication in common use cases of the APIs. As we all know, code duplication is one of the worst \"`code smells`\". All in all, it boils down to this: JDBC and LDAP programming in Java are both incredibly dull and repetitive.\n\nSpring JDBC, a core component of Spring Framework, provides excellent utilities for simplifying SQL programming. We need a similar framework for Java LDAP programming.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/preface.adoc", "title": "preface", "heading": "preface", "heading_level": 1, "file_order": 13, "section_index": 0, "content_hash": "734a893df81018539620eb5cc70034f4a067dec4f21dd1789b91d70ea26ce4b5", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/preface.adoc"}}
{"id": "sha256:b85be1d641274e5ddf1541e96b4cac5fbd9aeb65a48a098119d66f48e320b5cd", "content": "[[processing-the-dircontext]]\n\nThis section covers how to process the `DirContext`, including pre- and post-processing.\n\n[[custom-dircontext-pre-and-post-processing]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/processing-the-dircontext.adoc", "title": "processing-the-dircontext", "heading": "processing-the-dircontext", "heading_level": 1, "file_order": 14, "section_index": 0, "content_hash": "b85be1d641274e5ddf1541e96b4cac5fbd9aeb65a48a098119d66f48e320b5cd", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/processing-the-dircontext.adoc"}}
{"id": "sha256:266db3bf86a61883d021fb186e451b23121ef3cac03f82c5c41659bfb1276aaf", "content": "In some situations, you might like to perform operations on the `DirContext` before and after the search operation. The interface that is used for this is called `DirContextProcessor`. The following listing shows the `DirContextProcessor` interface:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic interface DirContextProcessor {\n public void preProcess(DirContext ctx) throws NamingException;\n public void postProcess(DirContext ctx) throws NamingException;\n}\n----\n====\n\nThe `LdapTemplate` class has a search method that takes a `DirContextProcessor`, as follows:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic void search(SearchExecutor se, NameClassPairCallbackHandler handler,\n DirContextProcessor processor) throws DataAccessException;\n----\n====\n\nBefore the search operation, the `preProcess` method is called on the given `DirContextProcessor` instance. After the search has run and the resulting `NamingEnumeration` has been processed, the `postProcess` method is called. This lets you perform operations on the `DirContext` to be used in the search and to check the `DirContext` when the search has been performed. This can be very useful (for example, when handling request and response controls).\n\nYou can also use the following convenience methods when you do not need a custom `SearchExecutor`:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic void search(Name base, String filter,\n SearchControls controls, NameClassPairCallbackHandler handler, DirContextProcessor processor)\n\npublic void search(String base, String filter,\n SearchControls controls, NameClassPairCallbackHandler handler, DirContextProcessor processor)\n\npublic void search(Name base, String filter,\n SearchControls controls, AttributesMapper mapper, DirContextProcessor processor)\n\npublic void search(String base, String filter,\n SearchControls controls, AttributesMapper mapper, DirContextProcessor processor)\n\npublic void search(Name base, String filter,\n SearchControls controls, ContextMapper mapper, DirContextProcessor processor)\n\npublic void search(String base, String filter,\n SearchControls controls, ContextMapper mapper, DirContextProcessor processor)\n----\n====\n\n[[implementing-a-request-control-dircontextprocessor]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/processing-the-dircontext.adoc", "title": "processing-the-dircontext", "heading": "Custom `DirContext` Pre- and Post-processing", "heading_level": 2, "file_order": 14, "section_index": 1, "content_hash": "266db3bf86a61883d021fb186e451b23121ef3cac03f82c5c41659bfb1276aaf", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/processing-the-dircontext.adoc"}}
{"id": "sha256:b3d6a9613b5cc428d081d28e8738fcb7eed770b244ae421a397b027281d4bcd9", "content": "The LDAPv3 protocol uses \"`Controls`\" to send and receive additional data to affect the behavior of predefined operations. To simplify the implementation of a request control `DirContextProcessor`, Spring LDAP provides the `AbstractRequestControlDirContextProcessor` base class. This class handles the retrieval of the current request controls from the `LdapContext`, calls a template method for creating a request control, and adds it to the `LdapContext`. All you have to do in the subclass is to implement the template method called `createRequestControl` and the `postProcess` method for performing whatever you need to do after the search. The following listing shows the relevant signatures:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic abstract class AbstractRequestControlDirContextProcessor implements\n DirContextProcessor {\n\n public void preProcess(DirContext ctx) throws NamingException {\n ...\n }\n\n public abstract Control createRequestControl();\n}\n----\n====\n\nA typical `DirContextProcessor` is similar to the following example:\n\n.A request control `DirContextProcessor` implementation\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.control;\n\npublic class MyCoolRequestControl extends AbstractRequestControlDirContextProcessor {\n private static final boolean CRITICAL_CONTROL = true;\n private MyCoolCookie cookie;\n ...\n public MyCoolCookie getCookie() {\n return cookie;\n }\n\n public Control createRequestControl() {\n return new SomeCoolControl(cookie.getCookie(), CRITICAL_CONTROL);\n }\n\n public void postProcess(DirContext ctx) throws NamingException {\n LdapContext ldapContext = (LdapContext) ctx;\n Control[] responseControls = ldapContext.getResponseControls();\n\n for (int i = 0; i < responseControls.length; i++) {\n if (responseControls[i] instanceof SomeCoolResponseControl) {\n SomeCoolResponseControl control = (SomeCoolResponseControl) responseControls[i];\n this.cookie = new MyCoolCookie(control.getCookie());\n }\n }\n }\n}\n----\n====\n\nNOTE: Make sure you use `LdapContextSource` when you use controls. The https://download.oracle.com/javase/1.5.0/docs/api/javax/naming/ldap/Control.html[`Control`] interface is specific for LDAPv3 and requires that `LdapContext` is used instead of `DirContext`. If an `AbstractRequestControlDirContextProcessor` subclass is called with an argument that is not an `LdapContext`, it throws an `IllegalArgumentException`.\n\n[[paged-search-results]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/processing-the-dircontext.adoc", "title": "processing-the-dircontext", "heading": "Implementing a Request Control `DirContextProcessor`", "heading_level": 2, "file_order": 14, "section_index": 2, "content_hash": "b3d6a9613b5cc428d081d28e8738fcb7eed770b244ae421a397b027281d4bcd9", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/processing-the-dircontext.adoc"}}
{"id": "sha256:204a9d32455f77ee1b56764edc1782ec7bd90b72e8495d344bfd27dd85421de9", "content": "Some searches may return large numbers of results. When there is no easy way to filter out a smaller amount, it is convenient to have the server return only a certain number of results each time it is called. This is known as \"`paged search results`\". Each \"`page`\" of the result could then be displayed, with links to the next and previous page. Without this functionality, the client must either manually limit the search result into pages or retrieve the whole result and then chop it into pages of suitable size. The former would be rather complicated, and the latter would consume unnecessary amounts of memory.\n\nSome LDAP servers support `PagedResultsControl`, which requests that the results of a search operation are returned by the LDAP server in pages of a specified size. The user controls the rate at which the pages are returned, by controlling the rate at which the searches are called. However, you must keep track of a cookie between the calls. The server uses this cookie to keep track of where it left off the previous time it was called with a paged results request.\n\nSpring LDAP provides support for paged results by using the concept for pre- and post-processing of an `LdapContext`, as discussed in the previous sections. It does so by using the `PagedResultsControlExchangeDirContextProcessor` class. The `PagedResultsControlExchangeDirContextProcessor` class creates a `PagedResultsControl` with the requested page size and adds it to the `LdapContext`. After the search, it gets the `PagedResultsResponseControl` and retrieves the paged results cookie, which is needed to keep the context between consecutive paged results requests.\n\nThe following example shows how the to use the paged search results functionality:\n\n.Paged results using `PagedResultsControlDirContextProcessor`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\n\npublic List<String> getAllPersonNames() {\n final SearchControls searchControls = new SearchControls();\n searchControls.setSearchScope(SearchControls.SUBTREE_SCOPE);\n\n PagedResultsControlExchangeDirContextProcessor processor = new PagedResultsControlExchangeDirContextProcessor(PAGE_SIZE);\n\n return SingleContextSource.doWithSingleContext(\n contextSource, new LdapOperationsCallback<List<String>>() {\n\n @Override\n public List<String> doWithLdapOperations(LdapOperations operations) {\n List<String> result = new LinkedList<String>();\n\n do {\n List<String> oneResult = operations.search(\n \"ou=People\",\n \"(&(objectclass=person))\",\n searchControls,\n CN_ATTRIBUTES_MAPPER,\n processor);\n result.addAll(oneResult);\n } while(processor.hasMore());\n\n return result;\n }\n });\n}\n----\n====\n\nNOTE: For a paged results cookie to continue being valid, you must use the same underlying connection for each paged results call. You can do so by using the `SingleContextSource`, as demonstrated in the preceding example or by using a `ContextSourceTransactionManager` and `TransactionAwareContextSourceProxy`.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/processing-the-dircontext.adoc", "title": "processing-the-dircontext", "heading": "Paged Search Results", "heading_level": 2, "file_order": 14, "section_index": 3, "content_hash": "204a9d32455f77ee1b56764edc1782ec7bd90b72e8495d344bfd27dd85421de9", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/processing-the-dircontext.adoc"}}
{"id": "sha256:892bb83e6272e26ec775a4739a32b29c18a10cbaaaa270454a44d625e6737d0b", "content": "[[query-builder-advanced]]\n\nThis section covers various how to use LDAP queries with Spring LDAP.\n\n[[ldap-query-builder-parameters]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/query-builder-advanced.adoc", "title": "query-builder-advanced", "heading": "query-builder-advanced", "heading_level": 1, "file_order": 15, "section_index": 0, "content_hash": "892bb83e6272e26ec775a4739a32b29c18a10cbaaaa270454a44d625e6737d0b", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/query-builder-advanced.adoc"}}
{"id": "sha256:feb2bc893c86dfa5acb83cea4fe6c4f3f5f563f5b82c61ab78804dd68b46abd6", "content": "The `LdapQueryBuilder` and its associated classes are intended to support all of the parameters that can be supplied to an LDAP search.\nThe following parameters are supported:\n\n* `base`: Specifies the root DN in the LDAP tree where the search should start.\n* `searchScope`: Specifies how deep into the LDAP tree the search should traverse.\n* `attributes`: Specifies the attributes to return from the search. The default is all.\n* `countLimit`: Specifies the maximum number of entries to return from the search.\n* `timeLimit`: Specifies the maximum time that the search may take.\n* Search filter: The conditions that the entries we are looking for must meet.\n\nAn `LdapQueryBuilder` is created with a call to the `query` method of `LdapQueryBuilder`. It is intended as a fluent builder API, where the base parameters are defined first, followed by the filter specification calls. Once filter conditions have been started to be defined with a call to the `where` method of `LdapQueryBuilder`, later attempts to call (for example) `base` are rejected. The base search parameters are optional, but at least one filter specification call is required.\nThe following query searches for all entries with an object class of `Person`:\n\n.Search for all entries with object class `Person`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n...\n\nList<Person> persons = ldapClient.search()\n .query(query().where(\"objectclass\").is(\"person\"))\n .toList(new PersonAttributesMapper());\n\n----\n====\n\nThe following query searches for all entries with an object class of `person` and a `cn` (common name) of `John Doe`:\n\n.Search for all entries with object class `person` and `cn=John Doe`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n...\n\nList<Person> persons = ldapClient.search()\n .query(query().where(\"objectclass\").is(\"person\").and(\"cn\").is(\"John Doe\"))\n .toList(new PersonAttributesMapper());\n----\n====\n\nThe following query searches for all entries with an object class of `person` and starting at a `dc` (domain component) of `dc=261consulting,dc=com`:\n\n.Search for all entries with object class `person` starting at `dc=261consulting,dc=com`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n...\n\nList<Person> persons = ldapClient.search()\n .query(query().base(\"dc=261consulting,dc=com\").where(\"objectclass\").is(\"person\"))\n .toList(new PersonAttributesMapper());\n----\n====\n\nThe following query returns the `cn` (common name) attribute for all entries with an object class of `person` and starting at a `dc` (domain component) of `dc=261consulting,dc=com`:\n\n.Search for all entries with class `Person` starting at `dc=261consulting,dc=com`, returning only the `cn` attribute\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n...\n\nStream<Person> persons = ldapClient.search()\n .query(query().base(\"dc=261consulting,dc=com\")\n .attributes(\"cn\")\n .where(\"objectclass\").is(\"person\")),\n .toStream(new PersonAttributesMapper());\n\n----\n====\n\nThe following query uses `or` to search for multiple spellings of a common name (`cn`):\n\n.Search with `or` criteria\n====\n[source,java,subs=\"verbatim,quotes\"]\n----\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n...\nStream<Person> persons = ldapClient.search()\n .query(query().where(\"objectclass\").is(\"person\"),\n .and(query().where(\"cn\").is(\"Doe\").or(\"cn\").is(\"Doo\"))\n .toStream(new PersonAttributesMapper());\n----\n====\n\n[[filter-criteria]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/query-builder-advanced.adoc", "title": "query-builder-advanced", "heading": "LDAP Query Builder Parameters", "heading_level": 2, "file_order": 15, "section_index": 1, "content_hash": "feb2bc893c86dfa5acb83cea4fe6c4f3f5f563f5b82c61ab78804dd68b46abd6", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/query-builder-advanced.adoc"}}
{"id": "sha256:7c942d57580dd7823684c91215a15ec2a200795ddb21e36ac566f1661dff0b78", "content": "The earlier examples demonstrate simple equals conditions in LDAP filters. The LDAP query builder has support for the following criteria types:\n\n* `is`: Specifies an equals (=) condition.\n* `gte`: Specifies a greater-than-or-equals (>=) condition.\n* `lte`: Specifies a less-than-or-equals (<=) condition.\n* `like`: Specifies a \"`like`\" condition where wildcards can be included in the query -- for example, `where(\"cn\").like(\"J*hn Doe\")` results in the following filter: `(cn=J*hn Doe)`.\n* `whitespaceWildcardsLike`: Specifies a condition where all whitespace is replaced with wildcards -- for example, `where(\"cn\").whitespaceWildcardsLike(\"John Doe\")` results in the following filter: `(cn=*John*Doe*)`.\n* `isPresent`: Specifies a condition that checks for the presence of an attribute -- for example, `where(\"cn\").isPresent()` results in the following filter: `(cn=*)`.\n* `not`: Specifies that the current condition should be negated -- for example, `where(\"sn\").not().is(\"Doe)` results in the following filter: `(!(sn=Doe))`\n\n[[hardcoded-filters]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/query-builder-advanced.adoc", "title": "query-builder-advanced", "heading": "Filter Criteria", "heading_level": 2, "file_order": 15, "section_index": 2, "content_hash": "7c942d57580dd7823684c91215a15ec2a200795ddb21e36ac566f1661dff0b78", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/query-builder-advanced.adoc"}}
{"id": "sha256:4932aec30427d4157d5460eb5cdce1f82fcd5f40d088ef5b44b2f976414410fe", "content": "There may be occasions when you want to specify a hardcoded filter as input to an `LdapQuery`. `LdapQueryBuilder` has two methods for this purpose:\n\n* `filter(String hardcodedFilter)`: Uses the specified string as a filter. Note that the specified input string is not touched in any way, meaning that this method is not particularly well suited if you are building filters from user input.\n\n* `filter(String filterFormat, String... params)`: Uses the specified string as input to `MessageFormat`, properly encoding the parameters and inserting them at the specified places in the filter string.\n\n* `filter(Filter filter)`: Uses the specified filter.\n\nYou cannot mix the hardcoded filter methods with the `where` approach described earlier. It is either one or the other. If you specify a filter by using `filter()`, you get an exception if you try to call `where` afterwards.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/query-builder-advanced.adoc", "title": "query-builder-advanced", "heading": "Hardcoded Filters", "heading_level": 2, "file_order": 15, "section_index": 3, "content_hash": "4932aec30427d4157d5460eb5cdce1f82fcd5f40d088ef5b44b2f976414410fe", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/query-builder-advanced.adoc"}}
{"id": "sha256:f21504610513403e7f43eaa57b110ba5d504aedd62d8c97b2dc593b053c52384", "content": "[[repositories]]\n\nSpring LDAP has built-in support for Spring Data repositories. The basic functionality and configuration is described https://docs.spring.io/spring-data/data-commons/docs/current/reference/html/#repositories[here]. When working with Spring LDAP repositories, you should remember the following:\n\n* You can enable Spring LDAP repositories by using an `<ldap:repositories>` element in your XML configuration or by using an `@EnableLdapRepositories` annotation on a configuration class.\n\n* To include support for `LdapQuery` parameters in automatically generated repositories, have your interface extend `LdapRepository` rather than `CrudRepository`.\n\n* All Spring LDAP repositories must work with entities that are annotated with the ODM annotations, as described in xref:odm.adoc[Object-Directory Mapping (ODM)].\n\n* Since all ODM managed classes must have a Distinguished Name as the ID, all Spring LDAP repositories must have the ID type parameter set to `javax.naming.Name`.\n The built-in `LdapRepository` takes only one type parameter: the managed entity class, defaulting the ID to `javax.naming.Name`.\n\n* Due to specifics of the LDAP protocol, paging and sorting are not supported for Spring LDAP repositories.\n\n[[querydsl-support]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/repositories.adoc", "title": "repositories", "heading": "repositories", "heading_level": 1, "file_order": 16, "section_index": 0, "content_hash": "f21504610513403e7f43eaa57b110ba5d504aedd62d8c97b2dc593b053c52384", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/repositories.adoc"}}
{"id": "sha256:fb89b42735998cdee82df4c235b110503e6c87adfb0dfa9ce8564f9f6284d707", "content": "Basic QueryDSL support is included in Spring LDAP. This support includes the following:\n\n* An annotation processor, called `LdapAnnotationProcessor`, for generating QueryDSL classes based on Spring LDAP ODM annotations. See xref:odm.adoc[Object-Directory Mapping (ODM)] for more information on the ODM annotations.\n\n* A Query implementation, called `QueryDslLdapQuery`, for building and running QueryDSL queries in code.\n\n* Spring Data repository support for QueryDSL predicates. `QueryDslPredicateExecutor` includes a number of additional methods with appropriate parameters. You can extend this interface along with `LdapRepository` to include this support in your repository.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/repositories.adoc", "title": "repositories", "heading": "QueryDSL support", "heading_level": 2, "file_order": 16, "section_index": 1, "content_hash": "fb89b42735998cdee82df4c235b110503e6c87adfb0dfa9ce8564f9f6284d707", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/repositories.adoc"}}
{"id": "sha256:cc33ff777660d28115eefa4abfdbd1427dff3fe16a89857acee0efed279b7d4b", "content": "[[spring-ldap-basic-usage]]\n\nThis section describes the basics of using Spring LDAP. It contains the following content:\n\n* xref:spring-ldap-basic-usage.adoc#spring-ldap-basic-usage-search-lookup-attributesmapper[Search and Lookup Using `AttributesMapper`]\n* xref:spring-ldap-basic-usage.adoc#basic-queries[Building LDAP Queries]\n* xref:spring-ldap-basic-usage.adoc#ldap-names[Dynamically Building Distinguished Names]\n* xref:spring-ldap-basic-usage.adoc#spring-ldap-basic-usage-examples[Examples]\n* xref:spring-ldap-basic-usage.adoc#spring-ldap-basic-usage-binding-unbinding[Binding and Unbinding]\n* xref:spring-ldap-basic-usage.adoc#spring-ldap-basic-usage-updating[Updating]\n\n[[spring-ldap-basic-usage-search-lookup-attributesmapper]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "spring-ldap-basic-usage", "heading_level": 1, "file_order": 17, "section_index": 0, "content_hash": "cc33ff777660d28115eefa4abfdbd1427dff3fe16a89857acee0efed279b7d4b", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:faf499c8c7f3ebfe83c3e99eea1da5157b72f51f3d7e7e907875634f5069702d", "content": "The following example uses an https://docs.spring.io/spring-ldap/docs/current/api/org/springframework/ldap/core/AttributesMapper.html[`AttributesMapper`] to build a List of all the common names of all the person objects.\n\n.`AttributesMapper` that returns a single attribute\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n\n public void setLdapClient(LdapClient ldapClient) {\n this.ldapClient = ldapClient;\n }\n\n public List<String> getAllPersonNames() {\n return ldapClient.search()\n .query(query().where(\"objectclass\").is(\"person\"))\n .toList(**(Attributes attrs) -> (String) attrs.get(\"cn\").get()**);\n }\n}\n----\n====\n\nThe inline implementation of `AttributesMapper` gets the desired attribute value from the `Attributes` object and returns it. Internally, `LdapClient` iterates over all entries found, calls the given `AttributesMapper` for each entry, and collects the results in a list. The list is then returned by the `search` method.\n\nNote that the `AttributesMapper` implementation could easily be modified to return a full `Person` object, as follows:\n\n.AttributesMapper that returns a Person object\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\nimport static org.springframework.ldap.query.LdapQueryBuilder.query;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n ...\n **private class PersonAttributesMapper implements AttributesMapper<Person> {\n public Person mapFromAttributes(Attributes attrs) throws NamingException {\n Person person = new Person();\n person.setFullName((String)attrs.get(\"cn\").get());\n person.setLastName((String)attrs.get(\"sn\").get());\n person.setDescription((String)attrs.get(\"description\").get());\n return person;\n }\n }**\n\n public List<Person> getAllPersons() {\n return ldapClient.search()\n .query(query().where(\"objectclass\").is(\"person\"))\n .toList(new PersonAttributesMapper());\n }\n}\n----\n====\n\nEntries in LDAP are uniquely identified by their distinguished name (DN).\nIf you have the DN of an entry, you can retrieve the entry directly without querying for it.\nThis is called a \"`lookup`\" in Java LDAP. The following example shows a lookup for a `Person` object:\n\n.A lookup resulting in a Person object\n====\n[source,java]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n ...\n public Person findPerson(String dn) {\n return ldapClient.search().name(dn).toObject(new PersonAttributesMapper());\n }\n}\n----\n====\n\nThe preceding example looks up the specified DN and passes the found attributes to the supplied `AttributesMapper` -- in this case, resulting in a `Person` object.\n\n[[basic-queries]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Search and Lookup Using `AttributesMapper`", "heading_level": 2, "file_order": 17, "section_index": 1, "content_hash": "faf499c8c7f3ebfe83c3e99eea1da5157b72f51f3d7e7e907875634f5069702d", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:4ae70da20feed153de9a958d4e228ef42818ede05209056e051ca7e8f16bc9ac", "content": "LDAP searches involve a number of parameters, including the following:\n\n* Base LDAP path: Where in the LDAP tree should the search start.\n* Search scope: How deep in the LDAP tree should the search go.\n* Attributes to return.\n* Search filter: The criteria to use when selecting elements within scope.\n\nSpring LDAP provides an https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/query/LdapQueryBuilder.html[`LdapQueryBuilder`] with a fluent API for building LDAP Queries.\n\nSuppose you want to perform a search starting at the base DN `dc=261consulting,dc=com`,\nlimiting the returned attributes to `cn` and `sn`, with a filter of `(&(objectclass=person)(sn=?))`, where we want the `?` to be replaced with the value of the `lastName` parameter.\nThe following example shows how to do it by using the `LdapQueryBuilder`:\n\n.Building a search filter dynamically\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n**import static org.springframework.ldap.query.LdapQueryBuilder.query;**\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n ...\n public List<String> getPersonNamesByLastName(String lastName) {\n\n **LdapQuery query = query()\n .base(\"dc=261consulting,dc=com\")\n .attributes(\"cn\", \"sn\")\n .where(\"objectclass\").is(\"person\")\n .and(\"sn\").is(lastName);**\n\n return ldapClient.search().query(**query**)\n .toObject((Attributes attrs) -> (String) attrs.get(\"cn\").get());\n }\n}\n----\n====\n\nNOTE: In addition to simplifying building of complex search parameters, the `LdapQueryBuilder` and its associated classes also provide proper escaping of any unsafe characters in search filters. This prevents \"`LDAP injection`\", where a user might use such characters to inject unwanted operations into your LDAP operations.\n\nNOTE: `LdapClient` includes many overloaded methods for performing LDAP searches. This is in order to accommodate as many different use cases and programming style preferences as possible. For the vast majority of use cases, the methods that take an `LdapQuery` as input are the recommended methods to use.\n\nNOTE: The `AttributesMapper` is only one of the available callback interfaces you can use when handling search and lookup data. See xref:dirobjectfactory.adoc[Simplifying Attribute Access and Manipulation with `DirContextAdapter`] for alternatives.\n\nFor more information on the `LdapQueryBuilder`, see xref:query-builder-advanced.adoc[Advanced LDAP Queries].\n\n[[ldap-names]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Building LDAP Queries", "heading_level": 2, "file_order": 17, "section_index": 2, "content_hash": "4ae70da20feed153de9a958d4e228ef42818ede05209056e051ca7e8f16bc9ac", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:3da468a91556cac273ade7a6da340e41ca34c2f8b47201e2ebcafb5b8bc75f11", "content": "The standard Java implementation of Distinguished Name (https://docs.oracle.com/javase/6/docs/api/javax/naming/ldap/LdapName.html[`LdapName`])\nperforms well when it comes to parsing Distinguished Names. However, in practical use, this implementation has a number of shortcomings:\n\n* The `LdapName` implementation is mutable, which is badly suited for an object that represents identity.\n* Despite its mutable nature, the API for dynamically building or modifying Distinguished Names by using `LdapName` is cumbersome.\n Extracting values of indexed or (particularly) named components is also a little bit awkward.\n* Many of the operations on `LdapName` throw checked exceptions, requiring `try-catch` statements for situations where the error is typically fatal and cannot be repaired in a meaningful manner.\n\nTo simplify working with Distinguished Names, Spring LDAP provides an https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/support/LdapNameBuilder.html[`LdapNameBuilder`],\nas well as a number of utility methods in https://docs.spring.io/spring-ldap/docs/current/apidocs/org/springframework/ldap/support/LdapUtils.html[`LdapUtils`] that help when working with `LdapName`.\n\n[[spring-ldap-basic-usage-examples]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Dynamically Building Distinguished Names", "heading_level": 2, "file_order": 17, "section_index": 3, "content_hash": "3da468a91556cac273ade7a6da340e41ca34c2f8b47201e2ebcafb5b8bc75f11", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:18a18d1a4a338217938337891f3f70cf9d7179cacebdeb3e63241525dc93de6f", "content": "This section presents a few examples of the subjects covered in the preceding sections.\nThe first example dynamically builds an `LdapName` by using `LdapNameBuilder`:\n\n.Dynamically building an `LdapName` by using `LdapNameBuilder`\n====\n[source,java,subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\nimport org.springframework.ldap.support.LdapNameBuilder;\nimport javax.naming.Name;\n\npublic class PersonRepoImpl implements PersonRepo {\n public static final String BASE_DN = \"dc=example,dc=com\";\n\n protected Name buildDn(Person p) {\n **return LdapNameBuilder.newInstance(BASE_DN)\n .add(\"c\", p.getCountry())\n .add(\"ou\", p.getCompany())\n .add(\"cn\", p.getFullname())\n .build();**\n }\n ...\n}\n----\n====\n\nAssume that a `Person` has the following attributes:\n\n|===\n| Attribute Name | Attribute Value\n\n| `country`\n| Sweden\n\n| `company`\n| Some Company\n\n| `fullname`\n| Some Person\n|===\n\nThe preceding code would then result in the following distinguished name:\n\n====\n[source]\n----\ncn=Some Person, ou=Some Company, c=Sweden, dc=example, dc=com\n----\n====\n\nThe following example extracts values from a distinguished name by using `LdapUtils`\n\n.Extracting values from a distinguished name by using `LdapUtils`\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\nimport org.springframework.ldap.support.LdapNameBuilder;\nimport javax.naming.Name;\npublic class PersonRepoImpl implements PersonRepo {\n...\n protected Person buildPerson(Name dn, Attributes attrs) {\n Person person = new Person();\n person.setCountry(**LdapUtils.getStringValue(dn, \"c\")**);\n person.setCompany(**LdapUtils.getStringValue(dn, \"ou\")**);\n person.setFullname(**LdapUtils.getStringValue(dn, \"cn\")**);\n // Populate rest of person object using attributes.\n\n return person;\n }\n}\n----\n====\n\nSince Java versions prior to and including 1.4 did not provide any public Distinguished Name implementation at all, Spring LDAP 1.x provided its own implementation, `DistinguishedName`.\nThis implementation suffered from a couple of shortcomings of its own and has been deprecated in version 2.0. You should now use `LdapName` along with the utilities described earlier.\n\n[[spring-ldap-basic-usage-binding-unbinding]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Examples", "heading_level": 3, "file_order": 17, "section_index": 4, "content_hash": "18a18d1a4a338217938337891f3f70cf9d7179cacebdeb3e63241525dc93de6f", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:400cb20e068d13b56d975032358974029963981bc9c81784ad6dfcdd3251df85", "content": "This section describes how to add and remove data. Updating is covered in the xref:spring-ldap-basic-usage.adoc#spring-ldap-basic-usage-updating[next section].\n\n[[basic-binding-data]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Binding and Unbinding", "heading_level": 2, "file_order": 17, "section_index": 5, "content_hash": "400cb20e068d13b56d975032358974029963981bc9c81784ad6dfcdd3251df85", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:cffcb9d19e130670cd4718cb77bb66bdb474742411c3c313f6c5c8b605e2b592", "content": "Inserting data in Java LDAP is called binding. This is somewhat confusing, because in LDAP terminology, \"`bind`\" means something completely different.\nA JNDI bind performs an LDAP Add operation, associating a new entry that has a specified distinguished name with a set of attributes.\nThe following example adds data by using `LdapClient`:\n\n.Adding data using Attributes\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n ...\n public void create(Person p) {\n Name dn = buildDn(p);\n **ldapClient.bind(dn).attributes(buildAttributes(p)).execute();**\n }\n\n private Attributes buildAttributes(Person p) {\n Attributes attrs = new BasicAttributes();\n BasicAttribute ocattr = new BasicAttribute(\"objectclass\");\n ocattr.add(\"top\");\n ocattr.add(\"person\");\n attrs.put(ocattr);\n attrs.put(\"cn\", \"Some Person\");\n attrs.put(\"sn\", \"Person\");\n return attrs;\n }\n}\n----\n====\n\nManual attributes building is -- while dull and verbose -- sufficient for many purposes. You can, however, simplify the binding operation further, as described in xref:dirobjectfactory.adoc[Simplifying Attribute Access and Manipulation with `DirContextAdapter`].\n\n[[removing-data]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Adding Data", "heading_level": 3, "file_order": 17, "section_index": 6, "content_hash": "cffcb9d19e130670cd4718cb77bb66bdb474742411c3c313f6c5c8b605e2b592", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:251d6e354ed9a4d85297bcf21d4ea1e68871894509860d742d05fdc9da9f64f5", "content": "Removing data in Java LDAP is called unbinding.\nA JNDI unbind performs an LDAP Delete operation, removing the entry associated with the specified distinguished name from the LDAP tree.\nThe following example removes data by using `LdapClient`:\n\n.Removing data\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n ...\n public void delete(Person p) {\n Name dn = buildDn(p);\n **ldapClient.unbind(dn).execute();**\n }\n}\n----\n====\n\n[[spring-ldap-basic-usage-updating]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Removing Data", "heading_level": 3, "file_order": 17, "section_index": 7, "content_hash": "251d6e354ed9a4d85297bcf21d4ea1e68871894509860d742d05fdc9da9f64f5", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:79bd0700faeb3836d63ab01e282f7d66d3396dfe0640b02769911ad663528a9e", "content": "In Java LDAP, data can be modified in two ways: either by using `rebind` or by using `modifyAttributes`.\n\n[[updating-by-using-rebind]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Updating", "heading_level": 2, "file_order": 17, "section_index": 8, "content_hash": "79bd0700faeb3836d63ab01e282f7d66d3396dfe0640b02769911ad663528a9e", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:7a4bef2af0c3bb554dfab25c1791acddba4dc60b71161ebe3d52e34fda7a0576", "content": "A `rebind` is a crude way to modify data. It is basically an `unbind` followed by a `bind`.\nThe following example invokes LDAP's `rebind`:\n\n.Modifying using rebind\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n ...\n public void update(Person p) {\n Name dn = buildDn(p);\n **ldapTemplate.bind(dn).attributes(buildAttributes(p)).replaceExisting(true).execute();**\n }\n}\n----\n====\n\n[[modify-modifyAttributes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Updating by Using Rebind", "heading_level": 3, "file_order": 17, "section_index": 9, "content_hash": "7a4bef2af0c3bb554dfab25c1791acddba4dc60b71161ebe3d52e34fda7a0576", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:97e54a11bd3772a685848c3ff5bab8b0ad2a7730a029d70ff86a540a125157b2", "content": "A more sophisticated way of modifying data is to use `modifyAttributes`. This operation takes an array of explicit attribute modifications\nand performs them on a specific entry, as follows:\n\n.Modifying using modifyAttributes\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npackage com.example.repo;\n\npublic class PersonRepoImpl implements PersonRepo {\n private LdapClient ldapClient;\n ...\n public void updateDescription(Person p) {\n Name dn = buildDn(p);\n Attribute attr = new BasicAttribute(\"description\", p.getDescription())\n ModificationItem item = new ModificationItem(DirContext.REPLACE_ATTRIBUTE, attr);\n **ldapTemplate.modify().name(dn).attributes(item).execute();**\n }\n}\n----\n====\n\nBuilding `Attributes` and `ModificationItem` arrays is a lot of work. However, as we describe in xref:dirobjectfactory.adoc[Simplifying Attribute Access and Manipulation with `DirContextAdapter`],\nSpring LDAP provides more help for simplifying these operations.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/spring-ldap-basic-usage.adoc", "title": "spring-ldap-basic-usage", "heading": "Updating by Using `modifyAttributes`", "heading_level": 3, "file_order": 17, "section_index": 10, "content_hash": "97e54a11bd3772a685848c3ff5bab8b0ad2a7730a029d70ff86a540a125157b2", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/spring-ldap-basic-usage.adoc"}}
{"id": "sha256:80f303512fb8164a0f6eaea4e239c80c5fb798921440957c7e225606eb354f55", "content": "[[testing]]\n\nThis section covers testing with Spring LDAP. It contains the following topics:\n\n* xref:testing.adoc#spring-ldap-testing-embedded-server[Using an Embedded Server]\n* xref:testing.adoc#spring-ldap-testing-apacheds[ApacheDS]\n* xref:testing.adoc#spring-ldap-testing-unboundid[UnboundID]\n\n[[spring-ldap-testing-embedded-server]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/testing.adoc", "title": "testing", "heading": "testing", "heading_level": 1, "file_order": 18, "section_index": 0, "content_hash": "80f303512fb8164a0f6eaea4e239c80c5fb798921440957c7e225606eb354f55", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/testing.adoc"}}
{"id": "sha256:e7ad2555209f43f8d26b4139bd83e77d8b98b4f43362178310b8867104cf4564", "content": "`spring-ldap-test` supplies an embedded LDAP server that is based on https://directory.apache.org/apacheds/[ApacheDS] or https://www.ldap.com/unboundid-ldap-sdk-for-java[UnboundID].\n\nNOTE: `spring-ldap-test` is compatible with ApacheDS 1.5.5. Newer versions of ApacheDS are not supported.\n\nTo get started, you need to include the `spring-ldap-test` dependency.\n\nThe following listing shows how to include the `spring-ldap-test` for Maven:\n\n====\n[source,xml,subs=\"+attributes\"]\n----\n<dependency>\n <groupId>org.springframework.ldap</groupId>\n <artifactId>spring-ldap-test</artifactId>\n <version>{project-version}</version>\n <scope>test</scope>\n</dependency>\n----\n====\n\nThe following listing shows how to include the `spring-ldap-test` for Gradle:\n\n====\n[source,groovy]\n[subs=\"verbatim,quotes,attributes\"]\n----\ntestCompile \"org.springframework.ldap:spring-ldap-test:{project-version}\"\n----\n====\n\n[[spring-ldap-testing-apacheds]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/testing.adoc", "title": "testing", "heading": "Using an Embedded Server", "heading_level": 2, "file_order": 18, "section_index": 1, "content_hash": "e7ad2555209f43f8d26b4139bd83e77d8b98b4f43362178310b8867104cf4564", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/testing.adoc"}}
{"id": "sha256:34f4b4452cdd90c294e36de9dadfacfd012dea97c3b94e6df01b91b02061a1ff", "content": "To use ApacheDS, you need to include a number of ApacheDS dependencies.\n\nThe following example shows how to include the ApacheDS dependencies for Maven:\n\n====\n[source,xml]\n----\n<dependency>\n <groupId>org.apache.directory.server</groupId>\n <artifactId>apacheds-core</artifactId>\n <version>1.5.5</version>\n <scope>test</scope>\n</dependency>\n<dependency>\n <groupId>org.apache.directory.server</groupId>\n <artifactId>apacheds-core-entry</artifactId>\n <version>1.5.5</version>\n <scope>test</scope>\n</dependency>\n<dependency>\n <groupId>org.apache.directory.server</groupId>\n <artifactId>apacheds-protocol-shared</artifactId>\n <version>1.5.5</version>\n <scope>test</scope>\n</dependency>\n<dependency>\n <groupId>org.apache.directory.server</groupId>\n <artifactId>apacheds-protocol-ldap</artifactId>\n <version>1.5.5</version>\n <scope>test</scope>\n</dependency>\n<dependency>\n <groupId>org.apache.directory.server</groupId>\n <artifactId>apacheds-server-jndi</artifactId>\n <version>1.5.5</version>\n <scope>test</scope>\n</dependency>\n<dependency>\n <groupId>org.apache.directory.shared</groupId>\n <artifactId>shared-ldap</artifactId>\n <version>0.9.15</version>\n <scope>test</scope>\n</dependency>\n----\n====\n\nThe following example shows how to include the ApacheDS dependencies for Gradle:\n\n====\n[source,groovy]\n[subs=\"verbatim,quotes\"]\n----\ntestCompile \"org.apache.directory.server:apacheds-core:1.5.5\",\n \"org.apache.directory.server:apacheds-core-entry:1.5.5\",\n \"org.apache.directory.server:apacheds-protocol-shared:1.5.5\",\n \"org.apache.directory.server:apacheds-protocol-ldap:1.5.5\",\n \"org.apache.directory.server:apacheds-server-jndi:1.5.5\",\n \"org.apache.directory.shared:shared-ldap:0.9.15\"\n----\n====\n\nThe following bean definition creates an embedded LDAP server:\n\n====\n[source,xml]\n----\n<bean id=\"embeddedLdapServer\" class=\"org.springframework.ldap.test.EmbeddedLdapServerFactoryBean\">\n <property name=\"partitionName\" value=\"example\"/>\n <property name=\"partitionSuffix\" value=\"dc=261consulting,dc=com\" />\n <property name=\"port\" value=\"9321\" />\n</bean>\n----\n====\n\n`spring-ldap-test` provides a mechanism to populate the LDAP server by using `org.springframework.ldap.test.LdifPopulator`. To use it, create a bean similar to the following:\n\n====\n[source,xml]\n----\n<bean class=\"org.springframework.ldap.test.LdifPopulator\" depends-on=\"embeddedLdapServer\">\n <property name=\"contextSource\" ref=\"contextSource\" />\n <property name=\"resource\" value=\"classpath:/setup_data.ldif\" />\n <property name=\"base\" value=\"dc=jayway,dc=se\" />\n <property name=\"clean\" value=\"true\" />\n <property name=\"defaultBase\" value=\"dc=jayway,dc=se\" />\n</bean>\n----\n====\n\nAnother way to work against an embedded LDAP server is by using `org.springframework.ldap.test.TestContextSourceFactoryBean`, as follows:\n\n====\n[source,xml]\n----\n<bean id=\"contextSource\" class=\"org.springframework.ldap.test.TestContextSourceFactoryBean\">\n <property name=\"defaultPartitionSuffix\" value=\"dc=jayway,dc=se\" />\n <property name=\"defaultPartitionName\" value=\"jayway\" />\n <property name=\"principal\" value=\"uid=admin,ou=system\" />\n <property name=\"password\" value=\"secret\" />\n <property name=\"ldifFile\" value=\"classpath:/setup_data.ldif\" />\n <property name=\"port\" value=\"1888\" />\n</bean>\n----\n====\n\nAlso, `org.springframework.ldap.test.LdapTestUtils` provides methods to programmatically work with an embedded LDAP server.\n\n[[spring-ldap-testing-unboundid]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/testing.adoc", "title": "testing", "heading": "ApacheDS", "heading_level": 2, "file_order": 18, "section_index": 2, "content_hash": "34f4b4452cdd90c294e36de9dadfacfd012dea97c3b94e6df01b91b02061a1ff", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/testing.adoc"}}
{"id": "sha256:c5c01451794c2847e7bd4d9f42df0bce5fc72510baadb859183d8c48f6f5544f", "content": "To use UnboundID, you need to include an UnboundID dependency.\n\nThe following example shows how to include the UnboundID dependency for Maven:\n\n====\n[source,xml]\n----\n<dependency>\n <groupId>com.unboundid</groupId>\n <artifactId>unboundid-ldapsdk</artifactId>\n <version>3.1.1</version>\n <scope>test</scope>\n</dependency>\n----\n====\n\nThe following example shows how to include the UnboundID dependency for Gradle:\n\n====\n[source,groovy]\n[subs=\"verbatim,quotes\"]\n----\ntestCompile \"com.unboundid:unboundid-ldapsdk:3.1.1\"\n----\n====\n\nThe following bean definition creates an embedded LDAP server:\n\n====\n[source,java]\n----\n@Bean\nEmbeddedLdapServer embeddedLdapServer() {\n return EmbeddedLdapServer.withPartitionSuffix(\"dc=jayway,dc=se\")\n .partitionName(\"jayway\")\n .port(18881)\n .configurationCustomizer((config) -> config.setCodeLogDetails(tempLogFile, true))\n .build();\n}\n----\n====\n\nAlternatively, you can use the `org.springframework.ldap.test.unboundid.LdifPopulator` to create and populate the LDAP server. To use it, create a bean similar to the following:\n\n====\n[source,xml]\n----\n<bean class=\"org.springframework.ldap.test.unboundid.LdifPopulator\" depends-on=\"embeddedLdapServer\">\n <property name=\"contextSource\" ref=\"contextSource\" />\n <property name=\"resource\" value=\"classpath:/setup_data.ldif\" />\n <property name=\"base\" value=\"dc=jayway,dc=se\" />\n <property name=\"clean\" value=\"true\" />\n <property name=\"defaultBase\" value=\"dc=jayway,dc=se\" />\n</bean>\n----\n====\n\nAnother way to work against an embedded LDAP server is by using `org.springframework.ldap.test.unboundid.TestContextSourceFactoryBean`.\nTo use it, create a bean similar to the following:\n\n====\n[source,xml]\n----\n<bean id=\"contextSource\" class=\"org.springframework.ldap.test.unboundid.TestContextSourceFactoryBean\">\n <property name=\"defaultPartitionSuffix\" value=\"dc=jayway,dc=se\" />\n <property name=\"defaultPartitionName\" value=\"jayway\" />\n <property name=\"principal\" value=\"uid=admin,ou=system\" />\n <property name=\"password\" value=\"secret\" />\n <property name=\"ldifFile\" value=\"classpath:/setup_data.ldif\" />\n <property name=\"port\" value=\"1888\" />\n</bean>\n----\n====\n\nAlso, `org.springframework.ldap.test.unboundid.LdapTestUtils` provide methods to programmatically work with an embedded LDAP server.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/testing.adoc", "title": "testing", "heading": "UnboundID", "heading_level": 2, "file_order": 18, "section_index": 3, "content_hash": "c5c01451794c2847e7bd4d9f42df0bce5fc72510baadb859183d8c48f6f5544f", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/testing.adoc"}}
{"id": "sha256:1cf9b18c324853b3a7e49df35159f3ebd440060b4db004e5c46a49358c9c2fd0", "content": "[[transaction-support]]\n\nProgrammers used to working with relational databases coming to the LDAP world often express surprise at the fact that there is no notion of transactions.\nIt is not specified in the protocol, and no LDAP servers support it.\nRecognizing that this may be a major problem, Spring LDAP provides support for client-side, compensating transactions on LDAP resources.\n\nLDAP transaction support is provided by `ContextSourceTransactionManager`, a `PlatformTransactionManager` implementation that manages Spring transaction support for LDAP operations. Along with its collaborators, it keeps track of the LDAP operations performed in a transaction, making a record of the state before each operation and taking steps to restore the initial state should the transaction need to be rolled back.\n\nIn addition to the actual transaction management, Spring LDAP transaction support also makes sure that the same `DirContext` instance is used throughout the same transaction. That is, the `DirContext` is not actually closed until the transaction is finished, allowing for more efficient resources usage.\n\nIMPORTANT: While the approach used by Spring LDAP to provide transaction support is sufficient for many cases, it is by no means \"`real`\" transactions in the traditional sense.\nThe server is completely unaware of the transactions, so (for example), if the connection is broken, there is no way to roll back the transaction.\nWhile this should be carefully considered, it should also be noted that the alternative is to operate without any transaction support whatsoever. Spring LDAP's transaction support is pretty much as good as it gets.\n\nNOTE: The client-side transaction support adds some overhead in addition to the work required by the original operations.\nWhile this overhead should not be something to worry about in most cases,\nif your application does not perform several LDAP operations within the same transaction (for example, `modifyAttributes` followed by `rebind`),\nor if transaction synchronization with a JDBC data source is not required (see xref:transaction-support.adoc#spring-ldap-jdbc-transaction-integration[JDBC Transaction Integration]), you gain little by using the LDAP transaction support.\n\n[[configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/transaction-support.adoc", "title": "transaction-support", "heading": "transaction-support", "heading_level": 1, "file_order": 19, "section_index": 0, "content_hash": "1cf9b18c324853b3a7e49df35159f3ebd440060b4db004e5c46a49358c9c2fd0", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/transaction-support.adoc"}}
{"id": "sha256:0257cc0f542f61e3f689f33fab00724cc109f2871eb2def5fac80d4116241471", "content": "Configuring Spring LDAP transactions should look very familiar if you are used to configuring Spring transactions. You can annotate your transacted classes with `@Transactional`, create a `TransactionManager` instance, and include a `<tx:annotation-driven>` element in your bean configuration. The following example shows how to do so:\n\n====\n[source,xml]\n[subs=\"verbatim,quotes\"]\n----\n<ldap:context-source\n url=\"ldap://localhost:389\"\n base=\"dc=example,dc=com\"\n username=\"cn=Manager\"\n password=\"secret\" />\n\n<ldap:ldap-template id=\"ldapTemplate\" />\n<ldap:transaction-manager>\n <!--\n Note this default configuration will not work for more complex scenarios;\n see below for more information on RenamingStrategies.\n -->\n <ldap:default-renaming-strategy />\n</ldap:transaction-manager>\n\n<!--\n The MyDataAccessObject class is annotated with @Transactional.\n-->\n<bean id=\"myDataAccessObject\" class=\"com.example.MyRepository\">\n <property name=\"ldapTemplate\" ref=\"ldapTemplate\" />\n</bean>\n\n<tx:annotation-driven />\n...\n----\n====\n\nNOTE: While this setup works fine for most simple use cases, some more complex scenarios require additional configuration.\nSpecifically, if you need to create or delete subtrees within transactions, you need to use an alternative `TempEntryRenamingStrategy`, as described in xref:transaction-support.adoc#renaming-strategies[Renaming Strategies].\n\nIn a real-world situation, you would probably apply the transactions on the service-object level rather than the repository level. The preceding example demonstrates the general idea.\n\n[[spring-ldap-jdbc-transaction-integration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/transaction-support.adoc", "title": "transaction-support", "heading": "Configuration", "heading_level": 2, "file_order": 19, "section_index": 1, "content_hash": "0257cc0f542f61e3f689f33fab00724cc109f2871eb2def5fac80d4116241471", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/transaction-support.adoc"}}
{"id": "sha256:4ad1516e054da83ae62789eb9aa8575f440d1a75e4c62154f11efb43ea554816", "content": "This support was removed in Spring LDAP 4.0.\n\n[[ldap-compensating-transactions-explained]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/transaction-support.adoc", "title": "transaction-support", "heading": "JDBC Transaction Integration", "heading_level": 2, "file_order": 19, "section_index": 2, "content_hash": "4ad1516e054da83ae62789eb9aa8575f440d1a75e4c62154f11efb43ea554816", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/transaction-support.adoc"}}
{"id": "sha256:5bd5889e42bd26af30feba426446c3870f8a81bf915de62a32d53aea26456454", "content": "Spring LDAP manages compensating transactions by making a record of the state in the LDAP tree before each modifying operation (`bind`, `unbind`, `rebind`, `modifyAttributes`, and `rename`).\nThis lets the system perform compensating operations should the transaction need to be rolled back.\n\nIn many cases, the compensating operation is pretty straightforward. For example, the compensating rollback operation for a `bind` operation is to unbind the entry.\nOther operations, however, require a different, more complicated approach because of some particular characteristics of LDAP databases.\nSpecifically, it is not always possible to get the values of all `Attributes` of an entry, making the aforementioned strategy insufficient for (for example) an `unbind` operation.\n\nThis is why each modifying operation performed within a Spring LDAP managed transaction is internally split up into four distinct operations: a recording operation,\na preparation operation, a commit operation, and a rollback operation. The following table describes each LDAP operation:\n\n|===\n| LDAP Operation | Recording | Preparation | Commit | Rollback\n\n| `bind`\n| Make a record of the DN of the entry to bind.\n| Bind the entry.\n| No operation.\n| Unbind the entry by using the recorded DN.\n\n| `rename`\n| Make a record of the original and target DN.\n| Rename the entry.\n| No operation.\n| Rename the entry back to its original DN.\n\n| `unbind`\n| Make a record of the original DN and calculate a temporary DN.\n| Rename the entry to the temporary location.\n| Unbind the temporary entry.\n| Rename the entry from the temporary location back to its original DN.\n\n| `rebind`\n| Make a record of the original DN and the new `Attributes` and calculate a temporary DN.\n| Rename the entry to a temporary location.\n| Bind the new `Attributes` at the original DN and unbind the original entry from its temporary location.\n| Rename the entry from the temporary location back to its original DN.\n\n| `modifyAttributes`\n| Make a record of the DN of the entry to modify and calculate compensating `ModificationItem` instances for the modifications to be done.\n| Perform the `modifyAttributes` operation.\n| No operation.\n| Perform a `modifyAttributes` operation by using the calculated compensating `ModificationItem` instances.\n|===\n\nA more detailed description of the internal workings of the Spring LDAP transaction support is available in the https://docs.spring.io/spring-ldap/docs/current/apidocs/[Javadoc].\n\n[[renaming-strategies]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/transaction-support.adoc", "title": "transaction-support", "heading": "LDAP Compensating Transactions Explained", "heading_level": 2, "file_order": 19, "section_index": 3, "content_hash": "5bd5889e42bd26af30feba426446c3870f8a81bf915de62a32d53aea26456454", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/transaction-support.adoc"}}
{"id": "sha256:218de67c6e83bdf5dbd0b2a26b3234ed31e09c9dddd5924bb69e47d8b240583c", "content": "As described in the table in the preceding section, the transaction management of some operations requires the original entry affected by the operation to be temporarily renamed before the actual modification can be made in the commit. The manner in which the temporary DN of the entry is calculated is managed by a `TempEntryRenamingStrategy` that is specified in a child element of the `<ldap:transaction-manager >` declaration in the configuration. Spring LDAP includes two implementations:\n\n* `DefaultTempEntryRenamingStrategy` (the default): Specified by using an `<ldap:default-renaming-strategy />` element. Adds a suffix to the least significant part of the entry DN. For example, for a DN of `cn=john doe, ou=users`, this strategy returns a temporary DN of `cn=john doe_temp, ou=users`. You can configure the suffix by setting the `temp-suffix` attribute.\n\n* `DifferentSubtreeTempEntryRenamingStrategy`: Specified by using an `<ldap:different-subtree-renaming-strategy />` element. It appends a subtree DN to the least significant part of the DN. Doing so makes all temporary entries be placed at a specific location in the LDAP tree. The temporary subtree DN is configured by setting the `subtree-node` attribute. For example, if `subtree-node` is `ou=tempEntries` and the original DN of the entry is `cn=john doe, ou=users`, the temporary DN is `cn=john doe, ou=tempEntries`. Note that the configured subtree node needs to be present in the LDAP tree.\n\nNOTE: The `DefaultTempEntryRenamingStrategy` does not work in some situations. For example, if you plan to do recursive deletes, you need to use `DifferentSubtreeTempEntryRenamingStrategy`. This is because the recursive delete operation actually consists of a depth-first delete of each node in the sub tree individually. Since you cannot rename an entry that has any children and `DefaultTempEntryRenamingStrategy` would leave each node in the same subtree (with a different name) instead of actually removing it, this operation would fail. When in doubt, use `DifferentSubtreeTempEntryRenamingStrategy`.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/transaction-support.adoc", "title": "transaction-support", "heading": "Renaming Strategies", "heading_level": 3, "file_order": 19, "section_index": 4, "content_hash": "218de67c6e83bdf5dbd0b2a26b3234ed31e09c9dddd5924bb69e47d8b240583c", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/transaction-support.adoc"}}
{"id": "sha256:8d3293c16de1fc0b37f3324930b95b7c4d1b783d9f366506791732ecb1cdc043", "content": "[[user-authentication]]\n\nThis section covers user authentication with Spring LDAP. It contains the following topics:\n\n* xref:user-authentication.adoc#spring-ldap-user-authentication-basic[Basic Authentication]\n* xref:user-authentication.adoc#operationsOnAuthenticatedContext[Performing Operations on the Authenticated Context]\n* xref:user-authentication.adoc#spring-ldap-authentication-obsolete[Obsolete Authentication Methods]\n* xref:user-authentication.adoc#spring-ldap-using-spring-security[Using Spring Security]\n\n[[spring-ldap-user-authentication-basic]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/user-authentication.adoc", "title": "user-authentication", "heading": "user-authentication", "heading_level": 1, "file_order": 20, "section_index": 0, "content_hash": "8d3293c16de1fc0b37f3324930b95b7c4d1b783d9f366506791732ecb1cdc043", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/user-authentication.adoc"}}
{"id": "sha256:45b9b2c7e7267564fd346e72e1d5d7b0666ef436f92b5a99ef8d9b9a299e3717", "content": "While the core functionality of the `ContextSource` is to provide `DirContext` instances for use by `LdapClient` and `LdapTemplate`, you can also use it for authenticating users against an LDAP server. The `getContext(principal, credentials)` method of `ContextSource` does exactly that. It constructs a `DirContext` instance according to the `ContextSource` configuration and authenticates the context by using the supplied principal and credentials. A custom authenticate method could look like the following example:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic boolean authenticate(String userDn, String credentials) {\n DirContext ctx = null;\n try {\n ctx = contextSource.getContext(userDn, credentials);\n return true;\n } catch (Exception e) {\n // Context creation failed - authentication did not succeed\n logger.error(\"Login failed\", e);\n return false;\n } finally {\n // It is imperative that the created DirContext instance is always closed\n LdapUtils.closeContext(ctx);\n }\n}\n----\n====\n\nThe `userDn` supplied to the `authenticate` method needs to be the full DN of the user to authenticate (regardless of the `base` setting on the `ContextSource`). You typically need to perform an LDAP search based on (for example) the user name to get this DN. The following example shows how to do so:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nprivate String getDnForUser(String uid) {\n List<String> result = ldapClient.search()\n .query(query().where(\"uid\").is(uid))\n .toList((Object ctx) -> ((DirContextOperations) ctx).getNameInNamespace());\n\n if(result.size() != 1) {\n throw new RuntimeException(\"User not found or not unique\");\n }\n\n return result.get(0);\n}\n----\n====\n\nThere are some drawbacks to this approach. You are forced to concern yourself with the DN of the user, you can search only for the user's uid, and the search always starts at the root of the tree (the empty path). A more flexible method would let you specify the search base, the search filter, and the credentials. Spring LDAP includes an authenticate method in `LdapClient` that provides this functionality.\n\nWhen you use this method, authentication becomes as simple as follows:\n\n.Authenticating a user using Spring LDAP\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nldapClient.authenticate().query(query().where(\"uid\").is(\"john.doe\")).password(\"secret\").execute();\n----\n====\n\nNOTE: As described in the xref:user-authentication.adoc#operationsOnAuthenticatedContext[Performing Operations on the Authenticated Context], some setups may require you to perform additional operations to get actual authentication to occur. See xref:user-authentication.adoc#operationsOnAuthenticatedContext[Performing Operations on the Authenticated Context] for details.\n\nTIP: Do not write your own custom authenticate methods. Use the ones provided in Spring LDAP.\n\n[[operationsOnAuthenticatedContext]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/user-authentication.adoc", "title": "user-authentication", "heading": "Basic Authentication", "heading_level": 2, "file_order": 20, "section_index": 1, "content_hash": "45b9b2c7e7267564fd346e72e1d5d7b0666ef436f92b5a99ef8d9b9a299e3717", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/user-authentication.adoc"}}
{"id": "sha256:a236b60cd64f0768e61ebda95666feb7f12df335648780e53cb244ad1c18339d", "content": "Some authentication schemes and LDAP servers require some operation to be performed on the created `DirContext` instance for the actual authentication to occur. You should test and make sure how your server setup and authentication schemes behave. Failure to do so might result in users being admitted into your system regardless of the supplied DN and credentials. The following example shows a nave implementation of an authenticate method where a hard-coded `lookup` operation is performed on the authenticated context:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\npublic boolean myAuthenticate(String userDn, String credentials) {\n DirContext ctx = null;\n try {\n ctx = contextSource.getContext(userDn, credentials);\n // Take care here - if a base was specified on the ContextSource\n // that needs to be removed from the user DN for the lookup to succeed.\n **ctx.lookup(userDn);**\n return true;\n } catch (Exception e) {\n // Context creation failed - authentication did not succeed\n logger.error(\"Login failed\", e);\n return false;\n } finally {\n // It is imperative that the created DirContext instance is always closed\n LdapUtils.closeContext(ctx);\n }\n}\n----\n====\n\nIt would be better if the operation could be provided as an implementation of a callback interface, rather than limiting the operation to always be a `lookup`. Spring LDAP includes the `AuthenticatedLdapEntryContextMapper` callback interface and a corresponding `authenticate` method.\n\nThis method lets any operation be performed on the authenticated context, as follows:\n\n.Performing an LDAP operation on the authenticated context using Spring LDAP\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nAuthenticatedLdapEntryContextMapper<DirContextOperations> mapper = new AuthenticatedLdapEntryContextMapper<DirContextOperations>() {\n public DirContextOperations mapWithContext(DirContext ctx, LdapEntryIdentification ldapEntryIdentification) {\n try {\n return (DirContextOperations) ctx.lookup(ldapEntryIdentification.getRelativeName());\n }\n catch (NamingException e) {\n throw new RuntimeException(\"Failed to lookup \" + ldapEntryIdentification.getRelativeName(), e);\n }\n }\n};\n\nldapClient.authenticate().query(query().where(\"uid\").is(\"john.doe\")).password(\"secret\").execute(mapper);\n----\n====\n\n[[spring-ldap-authentication-obsolete]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/user-authentication.adoc", "title": "user-authentication", "heading": "Performing Operations on the Authenticated Context", "heading_level": 2, "file_order": 20, "section_index": 2, "content_hash": "a236b60cd64f0768e61ebda95666feb7f12df335648780e53cb244ad1c18339d", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/user-authentication.adoc"}}
{"id": "sha256:1be2c261ca88974a37019641900c2453e23dc67a4582cb907b98420a320495ab", "content": "In addition to the `authenticate` methods described in the preceding sections, you can use a number of deprecated methods for authentication. While these work fine, we recommend using the `LdapQuery` methods instead.\n\n[[spring-ldap-using-spring-security]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/user-authentication.adoc", "title": "user-authentication", "heading": "Obsolete Authentication Methods", "heading_level": 2, "file_order": 20, "section_index": 3, "content_hash": "1be2c261ca88974a37019641900c2453e23dc67a4582cb907b98420a320495ab", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/user-authentication.adoc"}}
{"id": "sha256:549de3882e7cf3e1f9ba14948f57862cc9163bb4bb992ef482b015968bc70d7d", "content": "While the approach described in the preceding sections may be sufficient for simple authentication scenarios, requirements in this area commonly expand rapidly. A multitude of aspects apply, including authentication, authorization, web integration, user context management, and others. If you suspect that the requirements might expand beyond just simple authentication, you should definitely consider using https://spring.io/spring-security[Spring Security] for your security purposes instead. It is a full-featured, mature security framework that addresses the aforementioned aspects as well as several others.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/user-authentication.adoc", "title": "user-authentication", "heading": "Using Spring Security", "heading_level": 2, "file_order": 20, "section_index": 4, "content_hash": "549de3882e7cf3e1f9ba14948f57862cc9163bb4bb992ef482b015968bc70d7d", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/user-authentication.adoc"}}
{"id": "sha256:1aa6ecc32f76615d0c1d14b51178230d6d897211842b2917e5df9a0ff25af48e", "content": "[[utilities]]\n\nThis section describes additional utilities that you can use with Spring LDAP.\n\n[[incremental-retrieval-of-multi-valued-attributes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/utilities.adoc", "title": "utilities", "heading": "utilities", "heading_level": 1, "file_order": 21, "section_index": 0, "content_hash": "1aa6ecc32f76615d0c1d14b51178230d6d897211842b2917e5df9a0ff25af48e", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/utilities.adoc"}}
{"id": "sha256:f2720a1850e084a18a20717cdd42b01ddca6d60a1161d77a33380d6a4b8ef3c3", "content": "When there are a very large number of attribute values (>1500) for a specific attribute, Active Directory typically refuses to return all these values at once. Instead, the attribute values are returned according to the https://tools.ietf.org/html/draft-kashi-incremental-00[Incremental Retrieval of Multi-valued Properties] method. Doing so requires the calling part to inspect the returned attribute for specific markers and, if necessary, make additional lookup requests until all values are found.\n\nSpring LDAP's `org.springframework.ldap.core.support.DefaultIncrementalAttributesMapper` helps when working with this kind of attributes, as follows:\n\n====\n[source,java]\n[subs=\"verbatim,quotes\"]\n----\nObject[] attrNames = new Object[]{\"oneAttribute\", \"anotherAttribute\"};\nAttributes attrs = DefaultIncrementalAttributeMapper.lookupAttributes(ldapTemplate, theDn, attrNames);\n----\n====\n\nThe preceding example parses any returned attribute range markers and makes repeated requests as necessary until all values for all requested attributes have been retrieved.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-ldap", "path": "spring-ldap/modules/ROOT/pages/utilities.adoc", "title": "utilities", "heading": "Incremental Retrieval of Multi-Valued Attributes", "heading_level": 2, "file_order": 21, "section_index": 1, "content_hash": "f2720a1850e084a18a20717cdd42b01ddca6d60a1161d77a33380d6a4b8ef3c3", "source_url": "https://github.com/spring-projects/spring-ldap/blob/b633e96f5aa5aec9ce8fa92c7754932a7352aceb/modules/ROOT/pages/utilities.adoc"}}
