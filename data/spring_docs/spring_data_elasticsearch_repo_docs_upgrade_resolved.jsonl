{"id": "sha256:43cbd2549100ed63938f23081eadc0002eee8b9c544f083a434936d68ae31979", "content": "include::{commons}@data-commons::page$upgrade.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/commons/upgrade.adoc", "title": "upgrade", "heading": "upgrade", "heading_level": 1, "file_order": 0, "section_index": 0, "content_hash": "43cbd2549100ed63938f23081eadc0002eee8b9c544f083a434936d68ae31979", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/commons/upgrade.adoc"}}
{"id": "sha256:392d2e9524f71604b691a3b5a48abde533df56ab16b332e5833e6172b916b9fc", "content": "[[elasticsearch.cdi]]\n\nThe Spring Data Elasticsearch repositories can also be set up using CDI functionality.\n\n.Spring Data Elasticsearch repositories using CDI\n====\n[source,java]\n----\nclass ElasticsearchTemplateProducer {\n\n @Produces\n @ApplicationScoped\n public ElasticsearchOperations createElasticsearchTemplate() {\n // ... <1>\n }\n}\n\nclass ProductService {\n\n private ProductRepository repository; <2>\n public Page<Product> findAvailableBookByName(String name, Pageable pageable) {\n return repository.findByAvailableTrueAndNameStartingWith(name, pageable);\n }\n @Inject\n public void setRepository(ProductRepository repository) {\n this.repository = repository;\n }\n}\n----\n\n<1> Create a component by using the same calls as are used in the xref:elasticsearch/template.adoc[Elasticsearch Operations] chapter.\n<2> Let the CDI framework inject the Repository into your class.\n\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/cdi-integration.adoc", "title": "cdi-integration", "heading": "cdi-integration", "heading_level": 1, "file_order": 1, "section_index": 0, "content_hash": "392d2e9524f71604b691a3b5a48abde533df56ab16b332e5833e6172b916b9fc", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/cdi-integration.adoc"}}
{"id": "sha256:33119bd5454e6817839afdc6b01f52ccd40d4d19261b019975e2381bc28af385", "content": "[[elasticsearch.repositories]]\n\nThis chapter includes details of the Elasticsearch repository implementation.\n\n.The sample `Book` entity\n====\n[source,java]\n----\n@Document(indexName=\"books\")\nclass Book {\n @Id\n private String id;\n\n @Field(type = FieldType.Text)\n private String name;\n\n @Field(type = FieldType.Text)\n private String summary;\n\n @Field(type = FieldType.Integer)\n private Integer price;\n\n\t// getter/setter ...\n}\n----\n====\n\n[[elasticsearch.repositories.autocreation]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc", "title": "elasticsearch-repositories", "heading": "elasticsearch-repositories", "heading_level": 1, "file_order": 2, "section_index": 0, "content_hash": "33119bd5454e6817839afdc6b01f52ccd40d4d19261b019975e2381bc28af385", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc"}}
{"id": "sha256:b938e406c02f7b8592919678eb33ed833b43f9b59a09bed6114ab6720e134e2f", "content": "The `@Document` annotation has an argument `createIndex`.\nIf this argument is set to true - which is the default value - Spring Data Elasticsearch will during bootstrapping the repository support on application startup check if the index defined by the `@Document` annotation exists.\n\nIf it does not exist, the index will be created and the mappings derived from the entity's annotations (see xref:elasticsearch/object-mapping.adoc[Elasticsearch Object Mapping]) will be written to the newly created index.\nDetails of the index that will be created can be set by using the `@Setting` annotation, refer to xref:elasticsearch/misc.adoc#elasticsearc.misc.index.settings[Index settings] for further information.\n\n[[elasticsearch.repositories.annotations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc", "title": "elasticsearch-repositories", "heading": "Automatic creation of indices with the corresponding mapping", "heading_level": 2, "file_order": 2, "section_index": 1, "content_hash": "b938e406c02f7b8592919678eb33ed833b43f9b59a09bed6114ab6720e134e2f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc"}}
{"id": "sha256:23ed26d007d0363c966a22db2703c1a0d2e10f0d0c02d6a27f86995f9a6957dc", "content": "[[elasticsearch.repositories.annotations.highlight]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc", "title": "elasticsearch-repositories", "heading": "Annotations for repository methods", "heading_level": 2, "file_order": 2, "section_index": 2, "content_hash": "23ed26d007d0363c966a22db2703c1a0d2e10f0d0c02d6a27f86995f9a6957dc", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc"}}
{"id": "sha256:c576287fe373050c5976b84431ee4b77bc0665d7ead0979e31473645b57122bb", "content": "The `@Highlight` annotation on a repository method defines for which fields of the returned entity highlighting should be included.To search for some text in a `Book` 's name or summary and have the found data highlighted, the following repository method can be used:\n\n====\n[source,java]\n----\ninterface BookRepository extends Repository<Book, String> {\n\n @Highlight(fields = {\n @HighlightField(name = \"name\"),\n @HighlightField(name = \"summary\")\n })\n SearchHits<Book> findByNameOrSummary(String text, String summary);\n}\n----\n====\n\nIt is possible to define multiple fields to be highlighted like above, and both the `@Highlight` and the `@HighlightField` annotation can further be customized with a `@HighlightParameters` annotation. Check the Javadocs for the possible configuration options.\n\nIn the search results the highlight data can be retrieved from the `SearchHit` class.\n\n[[elasticsearch.repositories.annotations.sourcefilters]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc", "title": "elasticsearch-repositories", "heading": "@Highlight", "heading_level": 3, "file_order": 2, "section_index": 3, "content_hash": "c576287fe373050c5976b84431ee4b77bc0665d7ead0979e31473645b57122bb", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc"}}
{"id": "sha256:26bd9a221fe3a9ad68a1b455e874065e9d43baaa9db4b9cb03e3b55efa4b4113", "content": "Sometimes the user does not need to have all the properties of an entity returned from a search but only a subset.\nElasticsearch provides source filtering to reduce the amount of data that is transferred across the network to the\napplication.\n\nWhen working with `Query` implementations and the `ElasticsearchOperations` this is easily possible by setting a\nsource filter on the query.\n\nWhen using repository methods there is the `@SourceFilters` annotation:\n\n====\n[source,java]\n----\ninterface BookRepository extends Repository<Book, String> {\n\n @SourceFilters(includes = \"name\")\n SearchHits<Book> findByName(String text);\n}\n----\n====\n\nIn this example, all the properties of the returned `Book` objects would be `null` except the name.\n\n[[elasticsearch.annotation]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc", "title": "elasticsearch-repositories", "heading": "@SourceFilters", "heading_level": 3, "file_order": 2, "section_index": 4, "content_hash": "26bd9a221fe3a9ad68a1b455e874065e9d43baaa9db4b9cb03e3b55efa4b4113", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc"}}
{"id": "sha256:de42aea0667d8266d1285d03379ce85b414c0e473eb59ba8d5031ce3d15b8a9d", "content": "The Spring Data Elasticsearch repositories support can be activated using an annotation through JavaConfig.\n\n.Spring Data Elasticsearch repositories using JavaConfig\n====\n[source,java]\n----\n@Configuration\n@EnableElasticsearchRepositories( <1>\n basePackages = \"org.springframework.data.elasticsearch.repositories\"\n )\nstatic class Config {\n\n @Bean\n public ElasticsearchOperations elasticsearchTemplate() { <2>\n // ...\n }\n}\n\nclass ProductService {\n\n private ProductRepository repository; <3>\n\n public ProductService(ProductRepository repository) {\n this.repository = repository;\n }\n\n public Page<Product> findAvailableBookByName(String name, Pageable pageable) {\n return repository.findByAvailableTrueAndNameStartingWith(name, pageable);\n }\n}\n----\n\n<1> The `EnableElasticsearchRepositories` annotation activates the Repository support.\nIf no base package is configured, it will use the one of the configuration class it is put on.\n<2> Provide a Bean named `elasticsearchTemplate` of type `ElasticsearchOperations` by using one of the configurations shown in the xref:elasticsearch/template.adoc[Elasticsearch Operations] chapter.\n<3> Let Spring inject the Repository bean into your class.\n====\n\n[[elasticsearch.namespace]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc", "title": "elasticsearch-repositories", "heading": "Annotation based configuration", "heading_level": 2, "file_order": 2, "section_index": 5, "content_hash": "de42aea0667d8266d1285d03379ce85b414c0e473eb59ba8d5031ce3d15b8a9d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc"}}
{"id": "sha256:6d5ebd8b448b312f73353f69a67e2432a69fc53624e97344470fdfea1464c698", "content": "The Spring Data Elasticsearch module contains a custom namespace allowing definition of repository beans as well as elements for instantiating a `ElasticsearchServer` .\n\nUsing the `repositories` element looks up Spring Data repositories as described in xref:repositories/create-instances.adoc[].\n\n.Setting up Elasticsearch repositories using Namespace\n====\n[source,xml]\n----\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xmlns:elasticsearch=\"http://www.springframework.org/schema/data/elasticsearch\"\n xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n https://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n http://www.springframework.org/schema/data/elasticsearch\n https://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch-1.0.xsd\">\n\n <elasticsearch:repositories base-package=\"com.acme.repositories\" />\n\n</beans>\n----\n====\n\nUsing the `Transport Client` or `Rest Client` element registers an instance of `Elasticsearch Server` in the context.\n\n.Transport Client using Namespace\n====\n[source,xml]\n----\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xmlns:elasticsearch=\"http://www.springframework.org/schema/data/elasticsearch\"\n xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n https://www.springframework.org/schema/beans/spring-beans-3.1.xsd\n http://www.springframework.org/schema/data/elasticsearch\n https://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch-1.0.xsd\">\n\n <elasticsearch:transport-client id=\"client\" cluster-nodes=\"localhost:9300,someip:9300\" />\n\n</beans>\n----\n====\n\n.Rest Client using Namespace\n====\n[source,xml]\n----\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xmlns:elasticsearch=\"http://www.springframework.org/schema/data/elasticsearch\"\n xsi:schemaLocation=\"http://www.springframework.org/schema/data/elasticsearch\n https://www.springframework.org/schema/data/elasticsearch/spring-elasticsearch.xsd\n http://www.springframework.org/schema/beans\n https://www.springframework.org/schema/beans/spring-beans.xsd\">\n\n <elasticsearch:rest-client id=\"restClient\" hosts=\"http://localhost:9200\">\n\n</beans>\n----\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc", "title": "elasticsearch-repositories", "heading": "Spring Namespace", "heading_level": 2, "file_order": 2, "section_index": 6, "content_hash": "6d5ebd8b448b312f73353f69a67e2432a69fc53624e97344470fdfea1464c698", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repositories.adoc"}}
{"id": "sha256:b7b7c2146e0b6dd9218017b29c8180cb55ba4b6dcaa4969eb5157f21145a1723", "content": "[[elasticsearch.query-methods]]\n\n[[elasticsearch.query-methods.finders]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "elasticsearch-repository-queries", "heading_level": 1, "file_order": 3, "section_index": 0, "content_hash": "b7b7c2146e0b6dd9218017b29c8180cb55ba4b6dcaa4969eb5157f21145a1723", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:653b2f5d5cb4a095a9b5c481a7c764794f481ccaf874254b65e2338c272e14f4", "content": "The Elasticsearch module supports all basic query building feature as string queries, native search queries, criteria based queries or have it being derived from the method name.\n\n[[elasticsearch.query-methods.finders.declared]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "Query lookup strategies", "heading_level": 2, "file_order": 3, "section_index": 1, "content_hash": "653b2f5d5cb4a095a9b5c481a7c764794f481ccaf874254b65e2338c272e14f4", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:6b9e1dffffdfff2d617c0b5f808346827856e912544c59037f637bd2ee5c7236", "content": "Deriving the query from the method name is not always sufficient and/or may result in unreadable method names.\nIn this case one might make use of the `@Query` annotation (see xref:elasticsearch/repositories/elasticsearch-repository-queries.adoc#elasticsearch.query-methods.at-query[Using the @Query Annotation] ).\n\nAnother possibility is the use of a search-template, (see xref:elasticsearch/repositories/elasticsearch-repository-queries.adoc#elasticsearch.query-methods.at-searchtemplate-query[Using the @SearchTemplateQuery Annotation] ).\n\n[[elasticsearch.query-methods.criterions]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "Declared queries", "heading_level": 3, "file_order": 3, "section_index": 2, "content_hash": "6b9e1dffffdfff2d617c0b5f808346827856e912544c59037f637bd2ee5c7236", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:b8691639dcb5a09254813ad4599d07f10a544305e1b39fea3926aeb5dfd1fdcb", "content": "Generally the query creation mechanism for Elasticsearch works as described in xref:repositories/query-methods-details.adoc[].\nHere's a short example of what a Elasticsearch query method translates into:\n\n.Query creation from method names\n====\n[source,java]\n----\ninterface BookRepository extends Repository<Book, String> {\n List<Book> findByNameAndPrice(String name, Integer price);\n}\n----\n====\n\nThe method name above will be translated into the following Elasticsearch json query\n\n[source]\n----\n{\n \"query\": {\n \"bool\" : {\n \"must\" : [\n { \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"name\" ] } },\n { \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"price\" ] } }\n ]\n }\n }\n}\n----\n\nA list of supported keywords for Elasticsearch is shown below.\n\n[cols=\"1,2,3\",options=\"header\"]\n.Supported keywords inside method names\n|===\n| Keyword\n| Sample\n| Elasticsearch Query String\n\n| `And`\n| `findByNameAndPrice`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"name\" ] } },\n{ \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"price\" ] } }\n]\n}\n}}`\n\n| `Or`\n| `findByNameOrPrice`\n| `{ \"query\" : {\n\"bool\" : {\n\"should\" : [\n{ \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"name\" ] } },\n{ \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"price\" ] } }\n]\n}\n}}`\n\n| `Is`\n| `findByName`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"name\" ] } }\n]\n}\n}}`\n\n| `Not`\n| `findByNameNot`\n| `{ \"query\" : {\n\"bool\" : {\n\"must_not\" : [\n{ \"query_string\" : { \"query\" : \"?\", \"fields\" : [ \"name\" ] } }\n]\n}\n}}`\n\n| `Between`\n| `findByPriceBetween`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"range\" : {\"price\" : {\"from\" : ?, \"to\" : ?, \"include_lower\" : true, \"include_upper\" : true } } }\n]\n}\n}}`\n\n| `LessThan`\n| `findByPriceLessThan`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"range\" : {\"price\" : {\"from\" : null, \"to\" : ?, \"include_lower\" : true, \"include_upper\" : false } } }\n]\n}\n}}`\n\n| `LessThanEqual`\n| `findByPriceLessThanEqual`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"range\" : {\"price\" : {\"from\" : null, \"to\" : ?, \"include_lower\" : true, \"include_upper\" : true } } }\n]\n}\n}}`\n\n| `GreaterThan`\n| `findByPriceGreaterThan`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"range\" : {\"price\" : {\"from\" : ?, \"to\" : null, \"include_lower\" : false, \"include_upper\" : true } } }\n]\n}\n}}`\n\n| `GreaterThanEqual`\n| `findByPriceGreaterThanEqual`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"range\" : {\"price\" : {\"from\" : ?, \"to\" : null, \"include_lower\" : true, \"include_upper\" : true } } }\n]\n}\n}}`\n\n| `Before`\n| `findByPriceBefore`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"range\" : {\"price\" : {\"from\" : null, \"to\" : ?, \"include_lower\" : true, \"include_upper\" : true } } }\n]\n}\n}}`\n\n| `After`\n| `findByPriceAfter`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"range\" : {\"price\" : {\"from\" : ?, \"to\" : null, \"include_lower\" : true, \"include_upper\" : true } } }\n]\n}\n}}`\n\n| `Like`\n| `findByNameLike`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"?*\", \"fields\" : [ \"name\" ] }, \"analyze_wildcard\": true }\n]\n}\n}}`\n\n| `StartingWith`\n| `findByNameStartingWith`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"?*\", \"fields\" : [ \"name\" ] }, \"analyze_wildcard\": true }\n]\n}\n}}`\n\n| `EndingWith`\n| `findByNameEndingWith`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"*?\", \"fields\" : [ \"name\" ] }, \"analyze_wildcard\": true }\n]\n}\n}}`\n\n| `Contains/Containing`\n| `findByNameContaining`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"\\*?*\", \"fields\" : [ \"name\" ] }, \"analyze_wildcard\": true }\n]\n}\n}}`\n\n| `In` (when annotated as FieldType.Keyword)\n| `findByNameIn(Collection<String>names)`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"bool\" : {\"must\" : [\n{\"terms\" : {\"name\" : [\"?\",\"?\"]}}\n]\n}\n}\n]\n}\n}}`\n\n| `In`\n| `findByNameIn(Collection<String>names)`\n| `{ \"query\": {\"bool\": {\"must\": [{\"query_string\":{\"query\": \"\\\"?\\\" \\\"?\\\"\", \"fields\": [\"name\"]}}]}}}`\n\n| `NotIn` (when annotated as FieldType.Keyword)\n| `findByNameNotIn(Collection<String>names)`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{\"bool\" : {\"must_not\" : [\n{\"terms\" : {\"name\" : [\"?\",\"?\"]}}\n]\n}\n}\n]\n}\n}}`\n\n| `NotIn`\n| `findByNameNotIn(Collection<String>names)`\n| `{\"query\": {\"bool\": {\"must\": [{\"query_string\": {\"query\": \"NOT(\\\"?\\\" \\\"?\\\")\", \"fields\": [\"name\"]}}]}}}`\n\n| `True`\n| `findByAvailableTrue`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"true\", \"fields\" : [ \"available\" ] } }\n]\n}\n}}`\n\n| `False`\n| `findByAvailableFalse`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"false\", \"fields\" : [ \"available\" ] } }\n]\n}\n}}`\n\n| `OrderBy`\n| `findByAvailableTrueOrderByNameDesc`\n| `{ \"query\" : {\n\"bool\" : {\n\"must\" : [\n{ \"query_string\" : { \"query\" : \"true\", \"fields\" : [ \"available\" ] } }\n]\n}\n}, \"sort\":[{\"name\":{\"order\":\"desc\"}}]\n}`\n\n| `Exists`\n| `findByNameExists`\n| `{\"query\":{\"bool\":{\"must\":[{\"exists\":{\"field\":\"name\"}}]}}}`\n\n| `IsNull`\n| `findByNameIsNull`\n| `{\"query\":{\"bool\":{\"must_not\":[{\"exists\":{\"field\":\"name\"}}]}}}`\n\n| `IsNotNull`\n| `findByNameIsNotNull`\n| `{\"query\":{\"bool\":{\"must\":[{\"exists\":{\"field\":\"name\"}}]}}}`\n\n| `IsEmpty`\n| `findByNameIsEmpty`\n| `{\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"exists\":{\"field\":\"name\"}}],\"must_not\":[{\"wildcard\":{\"name\":{\"wildcard\":\"*\"}}}]}}]}}}`\n\n| `IsNotEmpty`\n| `findByNameIsNotEmpty`\n| `{\"query\":{\"bool\":{\"must\":[{\"wildcard\":{\"name\":{\"wildcard\":\"*\"}}}]}}}`\n\n|===\n\nNOTE: Methods names to build Geo-shape queries taking `GeoJson` parameters are not supported.\nUse `ElasticsearchOperations` with `CriteriaQuery` in a custom repository implementation if you need to have such a function in a repository.\n\n[[elasticsearch.query-methods.return-types]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "Query creation", "heading_level": 2, "file_order": 3, "section_index": 3, "content_hash": "b8691639dcb5a09254813ad4599d07f10a544305e1b39fea3926aeb5dfd1fdcb", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:8b2b230cfd639d3ca55a9af988735dfaa4c16dd6a34eb50f28a9203600bf17ff", "content": "Repository methods can be defined to have the following return types for returning multiple Elements:\n\n* `List<T>`\n* `Stream<T>`\n* `SearchHits<T>`\n* `List<SearchHit<T>>`\n* `Stream<SearchHit<T>>`\n* `SearchPage<T>`\n\n[[elasticsearch.query-methods.at-query]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "Method return types", "heading_level": 2, "file_order": 3, "section_index": 4, "content_hash": "8b2b230cfd639d3ca55a9af988735dfaa4c16dd6a34eb50f28a9203600bf17ff", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:877d399868d75b166dd29493b832a8a6b90eee25cd5df21fe931fbdb4f8b90d1", "content": ".Declare query on the method using the `@Query` annotation.\n====\nThe arguments passed to the method can be inserted into placeholders in the query string.\nThe placeholders are of the form `?0`, `?1`, `?2` etc. for the first, second, third parameter and so on.\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @Query(\"{\\\"match\\\": {\\\"name\\\": {\\\"query\\\": \\\"?0\\\"}}}\")\n Page<Book> findByName(String name,Pageable pageable);\n}\n----\n\nThe String that is set as the annotation argument must be a valid Elasticsearch JSON query.\nIt will be sent to Easticsearch as value of the query element; if for example the function is called with the parameter _John_, it would produce the following query body:\n\n[source,json]\n----\n{\n \"query\": {\n \"match\": {\n \"name\": {\n \"query\": \"John\"\n }\n }\n }\n}\n----\n====\n\n.`@Query` annotation on a method taking a Collection argument\n====\nA repository method such as\n\n[source,java]\n----\n@Query(\"{\\\"ids\\\": {\\\"values\\\": ?0 }}\")\nList<SampleEntity> getByIds(Collection<String> ids);\n----\n\nwould make an https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-ids-query.html[IDs query] to return all the matching documents.\nSo calling the method with a `List` of `[\"id1\", \"id2\", \"id3\"]` would produce the query body\n\n[source,json]\n----\n{\n \"query\": {\n \"ids\": {\n \"values\": [\"id1\", \"id2\", \"id3\"]\n }\n }\n}\n----\n====\n\n[[elasticsearch.query-methods.at-query.spel]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "Using the @Query Annotation", "heading_level": 2, "file_order": 3, "section_index": 5, "content_hash": "877d399868d75b166dd29493b832a8a6b90eee25cd5df21fe931fbdb4f8b90d1", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:fff1f84811b0d17f678c001e2956a80b9da37da4e61a2e7a1b979714a055ff26", "content": ".Declare query on the method using the `@Query` annotation with SpEL expression.\n====\n{spring-framework-docs}/core/expressions.html[SpEL expression] is also supported when defining query in `@Query`.\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @Query(\"\"\"\n {\n \"bool\":{\n \"must\":[\n {\n \"term\":{\n \"name\": \"#{#name}\"\n }\n }\n ]\n }\n }\n \"\"\")\n Page<Book> findByName(String name, Pageable pageable);\n}\n----\n\nIf for example the function is called with the parameter _John_, it would produce the following query body:\n\n[source,json]\n----\n{\n \"bool\":{\n \"must\":[\n {\n \"term\":{\n \"name\": \"John\"\n }\n }\n ]\n }\n}\n----\n====\n\n.accessing parameter property.\n====\nSupposing that we have the following class as query parameter type:\n\n[source,java]\n----\npublic record QueryParameter(String value) {\n}\n----\n\nIt's easy to access the parameter by `#` symbol, then reference the property `value` with a simple `.`:\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @Query(\"\"\"\n {\n \"bool\":{\n \"must\":[\n {\n \"term\":{\n \"name\": \"#{#parameter.value}\"\n }\n }\n ]\n }\n }\n \"\"\")\n Page<Book> findByName(QueryParameter parameter, Pageable pageable);\n}\n----\n\nWe can pass `new QueryParameter(\"John\")` as the parameter now, and it will produce the same query string as above.\n====\n\n.accessing bean property.\n====\n{spring-framework-docs}/core/expressions/language-ref/bean-references.html[Bean property] is also supported to access.\nGiven that there is a bean named `queryParameter` of type `QueryParameter`, we can access the bean with symbol `@` rather than `#`, and there is no need to declare a parameter of type `QueryParameter` in the query method:\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @Query(\"\"\"\n {\n \"bool\":{\n \"must\":[\n {\n \"term\":{\n \"name\": \"#{@queryParameter.value}\"\n }\n }\n ]\n }\n }\n \"\"\")\n Page<Book> findByName(Pageable pageable);\n}\n----\n====\n\n.SpEL and `Collection` param.\n====\n`Collection` parameter is also supported and is as easy to use as normal `String`, such as the following `terms` query:\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @Query(\"\"\"\n {\n \"bool\":{\n \"must\":[\n {\n \"terms\":{\n \"name\": #{#names}\n }\n }\n ]\n }\n }\n \"\"\")\n Page<Book> findByName(Collection<String> names, Pageable pageable);\n}\n----\n\nNOTE: collection values should not be quoted when declaring the elasticsearch json query.\n\nA collection of `names` like `List.of(\"name1\", \"name2\")` will produce the following terms query:\n\n[source,json]\n----\n{\n \"bool\":{\n \"must\":[\n {\n \"terms\":{\n \"name\": [\"name1\", \"name2\"]\n }\n }\n ]\n }\n}\n----\n====\n\n.access property in the `Collection` param.\n====\n{spring-framework-docs}/core/expressions/language-ref/collection-projection.html[SpEL Collection Projection] is convenient to use when values in the `Collection` parameter is not plain `String`:\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @Query(\"\"\"\n {\n \"bool\":{\n \"must\":[\n {\n \"terms\":{\n \"name\": #{#parameters.![value]}\n }\n }\n ]\n }\n }\n \"\"\")\n Page<Book> findByName(Collection<QueryParameter> parameters, Pageable pageable);\n}\n----\n\nThis will extract all the `value` property values as a new `Collection` from `QueryParameter` collection, thus takes the same effect as above.\n====\n\n.alter parameter name by using `@Param`\n====\nWhen accessing the parameter by SpEL, it's also useful to alter the parameter name to another one by `@Param` annotation in Sping Data:\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @Query(\"\"\"\n {\n \"bool\":{\n \"must\":[\n {\n \"terms\":{\n \"name\": #{#another.![value]}\n }\n }\n ]\n }\n }\n \"\"\")\n Page<Book> findByName(@Param(\"another\") Collection<QueryParameter> parameters, Pageable pageable);\n}\n----\n\n====\n\n[[elasticsearch.query-methods.at-searchtemplate-query]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "Using SpEL Expressions", "heading_level": 3, "file_order": 3, "section_index": 6, "content_hash": "fff1f84811b0d17f678c001e2956a80b9da37da4e61a2e7a1b979714a055ff26", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:5677c1446d9ac47fffe3acd7af25861f3edf82814695179b68376f7e215a52ec", "content": "When using Elasticsearch search templates - (see xref:elasticsearch/misc.adoc#elasticsearch.misc.searchtemplates [Search Template support]) it is possible to specify that a repository method should use a template by adding the `@SearchTemplateQuery` annotation to that method.\n\nLet's assume that there is a search template stored with the name \"book-by-title\" and this template need a parameter named \"title\", then a repository method using that search template can be defined like this:\n\n[source,java]\n----\ninterface BookRepository extends ElasticsearchRepository<Book, String> {\n @SearchTemplateQuery(id = \"book-by-title\")\n SearchHits<Book> findByTitle(String title);\n}\n----\n\nThe parameters of the repository method are sent to the seacrh template as key/value pairs where the key is the parameter name and the value is taken from the actual value when the method is invoked.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc", "title": "elasticsearch-repository-queries", "heading": "Using the @SearchTemplateQuery Annotation", "heading_level": 2, "file_order": 3, "section_index": 7, "content_hash": "5677c1446d9ac47fffe3acd7af25861f3edf82814695179b68376f7e215a52ec", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/elasticsearch-repository-queries.adoc"}}
{"id": "sha256:c6cc88bb479e9a48fffa54a076a436b07cb50f5dbf2d12c22f1bd107bd5f8481", "content": "[[elasticsearch.reactive.repositories]]\n\nReactive Elasticsearch repository support builds on the core repository support explained in xref:repositories.adoc[] utilizing operations provided via xref:elasticsearch/reactive-template.adoc[] executed by a xref:elasticsearch/clients.adoc#elasticsearch.clients.reactiverestclient[Reactive REST Client].\n\nSpring Data Elasticsearch reactive repository support uses https://projectreactor.io/[Project Reactor] as its reactive composition library of choice.\n\nThere are 3 main interfaces to be used:\n\n* `ReactiveRepository`\n* `ReactiveCrudRepository`\n* `ReactiveSortingRepository`\n\n[[elasticsearch.reactive.repositories.usage]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/reactive-elasticsearch-repositories.adoc", "title": "reactive-elasticsearch-repositories", "heading": "reactive-elasticsearch-repositories", "heading_level": 1, "file_order": 4, "section_index": 0, "content_hash": "c6cc88bb479e9a48fffa54a076a436b07cb50f5dbf2d12c22f1bd107bd5f8481", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/reactive-elasticsearch-repositories.adoc"}}
{"id": "sha256:c4ea5fc3462d77e727e5ab63cd6b5d1fdb2d841c6be512613e0f37ccbc860f81", "content": "To access domain objects stored in a Elasticsearch using a `Repository`, just create an interface for it.\nBefore you can actually go on and do that you will need an entity.\n\n.Sample `Person` entity\n====\n[source,java]\n----\npublic class Person {\n\n @Id\n private String id;\n private String firstname;\n private String lastname;\n private Address address;\n\n // â€¦ getters and setters omitted\n}\n----\n====\n\nNOTE: Please note that the `id` property needs to be of type `String`.\n\n.Basic repository interface to persist Person entities\n====\n[source]\n----\ninterface ReactivePersonRepository extends ReactiveSortingRepository<Person, String> {\n\n Flux<Person> findByFirstname(String firstname); <1>\n\n Flux<Person> findByFirstname(Publisher<String> firstname); <2>\n\n Flux<Person> findByFirstnameOrderByLastname(String firstname); <3>\n\n Flux<Person> findByFirstname(String firstname, Sort sort); <4>\n\n Flux<Person> findByFirstname(String firstname, Pageable page); <5>\n\n Mono<Person> findByFirstnameAndLastname(String firstname, String lastname); <6>\n\n Mono<Person> findFirstByLastname(String lastname); <7>\n\n @Query(\"{ \\\"bool\\\" : { \\\"must\\\" : { \\\"term\\\" : { \\\"lastname\\\" : \\\"?0\\\" } } } }\")\n Flux<Person> findByLastname(String lastname); <8>\n\n Mono<Long> countByFirstname(String firstname) <9>\n\n Mono<Boolean> existsByFirstname(String firstname) <10>\n\n Mono<Long> deleteByFirstname(String firstname) <11>\n}\n----\n<1> The method shows a query for all people with the given `lastname`.\n<2> Finder method awaiting input from `Publisher` to bind parameter value for `firstname`.\n<3> Finder method ordering matching documents by `lastname`.\n<4> Finder method ordering matching documents by the expression defined via the `Sort` parameter.\n<5> Use `Pageable` to pass offset and sorting parameters to the database.\n<6> Finder method concating criteria using `And` / `Or` keywords.\n<7> Find the first matching entity.\n<8> The method shows a query for all people with the given `lastname` looked up by running the annotated `@Query` with given\nparameters.\n<9> Count all entities with matching `firstname`.\n<10> Check if at least one entity with matching `firstname` exists.\n<11> Delete all entities with matching `firstname`.\n====\n\n[[elasticsearch.reactive.repositories.configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/reactive-elasticsearch-repositories.adoc", "title": "reactive-elasticsearch-repositories", "heading": "Usage", "heading_level": 2, "file_order": 4, "section_index": 1, "content_hash": "c4ea5fc3462d77e727e5ab63cd6b5d1fdb2d841c6be512613e0f37ccbc860f81", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/reactive-elasticsearch-repositories.adoc"}}
{"id": "sha256:f1fe30e6816a4519044378850569348a31a4d0d421cb732c6a5b7e0c1a5c15bd", "content": "For Java configuration, use the `@EnableReactiveElasticsearchRepositories` annotation. If no base package is configured,\nthe infrastructure scans the package of the annotated configuration class.\n\nThe following listing shows how to use Java configuration for a repository:\n\n.Java configuration for repositories\n====\n[source,java]\n----\n@Configuration\n@EnableReactiveElasticsearchRepositories\npublic class Config extends AbstractReactiveElasticsearchConfiguration {\n\n @Override\n public ReactiveElasticsearchClient reactiveElasticsearchClient() {\n return ReactiveRestClients.create(ClientConfiguration.localhost());\n }\n}\n----\n====\n\nBecause the repository from the previous example extends `ReactiveSortingRepository`, all CRUD operations are available\nas well as methods for sorted access to the entities. Working with the repository instance is a matter of dependency\ninjecting it into a client, as the following example shows:\n\n.Sorted access to Person entities\n====\n[source,java]\n----\npublic class PersonRepositoryTests {\n\n @Autowired ReactivePersonRepository repository;\n\n @Test\n public void sortsElementsCorrectly() {\n\n Flux<Person> persons = repository.findAll(Sort.by(new Order(ASC, \"lastname\")));\n\n // ...\n }\n}\n----\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/repositories/reactive-elasticsearch-repositories.adoc", "title": "reactive-elasticsearch-repositories", "heading": "Configuration", "heading_level": 2, "file_order": 4, "section_index": 2, "content_hash": "f1fe30e6816a4519044378850569348a31a4d0d421cb732c6a5b7e0c1a5c15bd", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/repositories/reactive-elasticsearch-repositories.adoc"}}
{"id": "sha256:168458a01e6f28ed8da1cc80e9390d149157d75e8f34f7e85517f6e450df8076", "content": "[[elasticsearch.auditing]]\n\n[[elasticsearch.auditing.preparing]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/auditing.adoc", "title": "auditing", "heading": "auditing", "heading_level": 1, "file_order": 5, "section_index": 0, "content_hash": "168458a01e6f28ed8da1cc80e9390d149157d75e8f34f7e85517f6e450df8076", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/auditing.adoc"}}
{"id": "sha256:ff90643d5bb223883320fce81aa1f262bb7566b91ccf569151c4fda67fe13ddf", "content": "In order for the auditing code to be able to decide whether an entity instance is new, the entity must implement the `Persistable<ID>` interface which is defined as follows:\n\n[source,java]\n----\npackage org.springframework.data.domain;\n\nimport org.jspecify.annotations.Nullable;\n\npublic interface Persistable<ID> {\n @Nullable\n ID getId();\n\n boolean isNew();\n}\n----\n\nAs the existence of an Id is not a sufficient criterion to determine if an enitity is new in Elasticsearch, additional information is necessary. One way is to use the creation-relevant auditing fields for this decision:\n\nA `Person` entity might look as follows - omitting getter and setter methods for brevity:\n\n[source,java]\n----\n@Document(indexName = \"person\")\npublic class Person implements Persistable<Long> {\n @Id private Long id;\n private String lastName;\n private String firstName;\n @CreatedDate\n @Field(type = FieldType.Date, format = DateFormat.basic_date_time)\n private Instant createdDate;\n @CreatedBy\n private String createdBy\n @Field(type = FieldType.Date, format = DateFormat.basic_date_time)\n @LastModifiedDate\n private Instant lastModifiedDate;\n @LastModifiedBy\n private String lastModifiedBy;\n\n public Long getId() { // <.>\n return id;\n }\n\n @Override\n public boolean isNew() {\n return id == null || (createdDate == null && createdBy == null); // <.>\n }\n}\n----\n<.> the getter is the required implementation from the interface\n<.> an object is new if it either has no `id` or none of fields containing creation attributes are set.\n\n[[elasticsearch.auditing.activating]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/auditing.adoc", "title": "auditing", "heading": "Preparing entities", "heading_level": 2, "file_order": 5, "section_index": 1, "content_hash": "ff90643d5bb223883320fce81aa1f262bb7566b91ccf569151c4fda67fe13ddf", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/auditing.adoc"}}
{"id": "sha256:ef042bb092e8a5b6b0d93e2e93806d0c85905eeaa82b7ba967d0ae49cfeb7441", "content": "After the entities have been set up and providing the `AuditorAware` - or `ReactiveAuditorAware` - the Auditing must be activated by setting the `@EnableElasticsearchAuditing` on a configuration class:\n\n[source,java]\n----\n@Configuration\n@EnableElasticsearchRepositories\n@EnableElasticsearchAuditing\nclass MyConfiguration {\n // configuration code\n}\n----\n\nWhen using the reactive stack this must be:\n[source,java]\n----\n@Configuration\n@EnableReactiveElasticsearchRepositories\n@EnableReactiveElasticsearchAuditing\nclass MyConfiguration {\n // configuration code\n}\n----\n\nIf your code contains more than one `AuditorAware` bean for different types, you must provide the name of the bean to use as an argument to the `auditorAwareRef` parameter of the\n `@EnableElasticsearchAuditing` annotation.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/auditing.adoc", "title": "auditing", "heading": "Activating auditing", "heading_level": 2, "file_order": 5, "section_index": 2, "content_hash": "ef042bb092e8a5b6b0d93e2e93806d0c85905eeaa82b7ba967d0ae49cfeb7441", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/auditing.adoc"}}
{"id": "sha256:49cc839f7993703cd11f34a7ae0239a2f3d6fd2c2565f9c6d68d2923a39d4df9", "content": "[[elasticsearch.clients]]\n\nThis chapter illustrates configuration and usage of supported Elasticsearch client implementations.\n\nSpring Data Elasticsearch operates upon an Elasticsearch client (provided by Elasticsearch client libraries) that is connected to a single Elasticsearch node or a cluster.\nAlthough the Elasticsearch Client can be used directly to work with the cluster, applications using Spring Data Elasticsearch normally use the higher level abstractions of xref:elasticsearch/template.adoc[Elasticsearch Operations] and xref:elasticsearch/repositories/elasticsearch-repositories.adoc[Elasticsearch Repositories].\n\n[[elasticsearch.clients.rest5client]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "clients", "heading_level": 1, "file_order": 6, "section_index": 0, "content_hash": "49cc839f7993703cd11f34a7ae0239a2f3d6fd2c2565f9c6d68d2923a39d4df9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:af36d889d78ca145f560a1aca63ad90f47ff9ad24bb959e8d21c99af62129d06", "content": "To use the imperative (non-reactive) Rest5Client - the default client provided by the Elasticsearch Java client library from version 9 on -, a configuration bean must be configured like this:\n\n====\n[source,java]\n----\nimport org.springframework.data.elasticsearch.client.elc.ElasticsearchConfiguration;\n\n@Configuration\npublic class MyClientConfig extends ElasticsearchConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() <.>\n .connectedTo(\"localhost:9200\")\n .build();\n\t}\n}\n----\n\n<.> for a detailed description of the builder methods see xref:elasticsearch/clients.adoc#elasticsearch.clients.configuration[Client Configuration]\n====\n\nThe javadoc:org.springframework.data.elasticsearch.client.elc.ElasticsearchConfiguration[] class allows further configuration by overriding for example the `jsonpMapper()` or `transportOptions()` methods.\n\nThe following beans can then be injected in other Spring components:\n\n====\n[source,java]\n----\nimport org.springframework.beans.factory.annotation.Autowired;\n\n@Autowired\nElasticsearchOperations operations; <.>\n\n@Autowired\nElasticsearchClient elasticsearchClient; <.>\n\n@Autowired\nRest5Client rest5Client; <.>\n\n@Autowired\nJsonpMapper jsonpMapper; <.>\n----\n\n<.> an implementation of javadoc:org.springframework.data.elasticsearch.core.ElasticsearchOperations[]\n<.> the `co.elastic.clients.elasticsearch.ElasticsearchClient` that is used.\n<.> the low level `Rest5Client` from the Elasticsearch libraries\n<.> the `JsonpMapper` user by the Elasticsearch `Transport`\n====\n\nBasically one should just use the javadoc:org.springframework.data.elasticsearch.core.ElasticsearchOperations[] to interact with the Elasticsearch cluster.\nWhen using repositories, this instance is used under the hood as well.\n\n[[elasticsearch.clients.restclient]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Imperative Rest5Client", "heading_level": 2, "file_order": 6, "section_index": 1, "content_hash": "af36d889d78ca145f560a1aca63ad90f47ff9ad24bb959e8d21c99af62129d06", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:b83267396abe679d11c03d382e05c8f5ff2f9da8fcc3604ccfe0770d6cfc6ea6", "content": "To use the imperative (non-reactive) RestClient - deprecated since version 6 - , the following dependency needs to be added, adapt the correct version. The exclusion is needed in a Spring Boot application:\n====\n[source,xml]\n----\n <dependency>\n <groupId>org.elasticsearch.client</groupId>\n <artifactId>elasticsearch-rest-client</artifactId>\n <version>${elasticsearch-client.version}</version>\n <exclusions>\n <exclusion>\n <groupId>commons-logging</groupId>\n <artifactId>commons-logging</artifactId>\n </exclusion>\n </exclusions>\n </dependency>\n\n----\n====\n\nThe configuration bean must then be configured like this:\n\n====\n[source,java]\n----\nimport org.springframework.data.elasticsearch.client.elc.ElasticsearchLegacyRestClientConfiguration;\n\n@Configuration\npublic class MyClientConfig extends ElasticsearchLegacyRestClientConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() <.>\n .connectedTo(\"localhost:9200\")\n .build();\n\t}\n}\n----\n\n<.> for a detailed description of the builder methods see xref:elasticsearch/clients.adoc#elasticsearch.clients.configuration[Client Configuration]\n====\n\nThe javadoc:org.springframework.data.elasticsearch.client.elc.ElasticsearchConfiguration[] class allows further configuration by overriding for example the `jsonpMapper()` or `transportOptions()` methods.\n\nThe following beans can then be injected in other Spring components:\n\n====\n[source,java]\n----\nimport org.springframework.beans.factory.annotation.Autowired;\n\n@Autowired\nElasticsearchOperations operations; <.>\n\n@Autowired\nElasticsearchClient elasticsearchClient; <.>\n\n@Autowired\nRestClient restClient; <.>\n\n@Autowired\nJsonpMapper jsonpMapper; <.>\n----\n\n<.> an implementation of javadoc:org.springframework.data.elasticsearch.core.ElasticsearchOperations[]\n<.> the `co.elastic.clients.elasticsearch.ElasticsearchClient` that is used.\n<.> the low level `RestClient` from the Elasticsearch libraries\n<.> the `JsonpMapper` user by the Elasticsearch `Transport`\n====\n\nBasically one should just use the javadoc:org.springframework.data.elasticsearch.core.ElasticsearchOperations[] to interact with the Elasticsearch cluster.\nWhen using repositories, this instance is used under the hood as well.\n\n[[elasticsearch.clients.reactiverest5client]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Deprecated Imperative RestClient", "heading_level": 2, "file_order": 6, "section_index": 2, "content_hash": "b83267396abe679d11c03d382e05c8f5ff2f9da8fcc3604ccfe0770d6cfc6ea6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:8cdc19ed0e812174761632a75f84a7e4a5b8962dab3ff391fa59a501d0a69c2e", "content": "When working with the reactive stack, the configuration must be derived from a different class:\n\n====\n[source,java]\n----\nimport org.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchConfiguration;\n\n@Configuration\npublic class MyClientConfig extends ReactiveElasticsearchConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() <.>\n .connectedTo(\"localhost:9200\")\n .build();\n\t}\n}\n----\n\n<.> for a detailed description of the builder methods see xref:elasticsearch/clients.adoc#elasticsearch.clients.configuration[Client Configuration]\n====\n\nThe javadoc:org.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchConfiguration[] class allows further configuration by overriding for example the `jsonpMapper()` or `transportOptions()` methods.\n\nThe following beans can then be injected in other Spring components:\n\n====\n[source,java]\n----\nimport org.springframework.beans.factory.annotation.Autowired;\n\n@Autowired\nReactiveElasticsearchOperations operations; <.>\n\n@Autowired\nReactiveElasticsearchClient elasticsearchClient; <.>\n\n@Autowired\nRest5Client rest5Client; <.>\n\n@Autowired\nJsonpMapper jsonpMapper; <.>\n----\n\nthe following can be injected:\n\n<.> an implementation of javadoc:org.springframework.data.elasticsearch.core.ReactiveElasticsearchOperations[]\n<.> the `org.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchClient` that is used.\nThis is a reactive implementation based on the Elasticsearch client implementation.\n<.> the low level `RestClient` from the Elasticsearch libraries\n<.> the `JsonpMapper` user by the Elasticsearch `Transport`\n====\n\nBasically one should just use the javadoc:org.springframework.data.elasticsearch.core.ReactiveElasticsearchOperations[] to interact with the Elasticsearch cluster.\nWhen using repositories, this instance is used under the hood as well.\n\n[[elasticsearch.clients.reactiverestclient]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Reactive Rest5Client", "heading_level": 2, "file_order": 6, "section_index": 3, "content_hash": "8cdc19ed0e812174761632a75f84a7e4a5b8962dab3ff391fa59a501d0a69c2e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:8ff9922f27bd380e432e811f7188e34718b3bba4459546443fc3df7079b888ab", "content": "See the section above for the imperative code to use the deprecated RestClient for the necessary dependencies to include.\n\nWhen working with the reactive stack, the configuration must be derived from a different class:\n\n====\n[source,java]\n----\nimport org.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchLegacyRestClientConfiguration;\n\n@Configuration\npublic class MyClientConfig extends ReactiveElasticsearchLegacyRestClientConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() <.>\n .connectedTo(\"localhost:9200\")\n .build();\n\t}\n}\n----\n\n<.> for a detailed description of the builder methods see xref:elasticsearch/clients.adoc#elasticsearch.clients.configuration[Client Configuration]\n====\n\nThe javadoc:org.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchConfiguration[] class allows further configuration by overriding for example the `jsonpMapper()` or `transportOptions()` methods.\n\nThe following beans can then be injected in other Spring components:\n\n====\n[source,java]\n----\nimport org.springframework.beans.factory.annotation.Autowired;\n\n@Autowired\nReactiveElasticsearchOperations operations; <.>\n\n@Autowired\nReactiveElasticsearchClient elasticsearchClient; <.>\n\n@Autowired\nRestClient restClient; <.>\n\n@Autowired\nJsonpMapper jsonpMapper; <.>\n----\n\nthe following can be injected:\n\n<.> an implementation of javadoc:org.springframework.data.elasticsearch.core.ReactiveElasticsearchOperations[]\n<.> the `org.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchClient` that is used.\nThis is a reactive implementation based on the Elasticsearch client implementation.\n<.> the low level `RestClient` from the Elasticsearch libraries\n<.> the `JsonpMapper` user by the Elasticsearch `Transport`\n====\n\nBasically one should just use the javadoc:org.springframework.data.elasticsearch.core.ReactiveElasticsearchOperations[] to interact with the Elasticsearch cluster.\nWhen using repositories, this instance is used under the hood as well.\n\n[[elasticsearch.clients.configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Deprecated Reactive RestClient", "heading_level": 2, "file_order": 6, "section_index": 4, "content_hash": "8ff9922f27bd380e432e811f7188e34718b3bba4459546443fc3df7079b888ab", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:2bcfa2bfb08a111e265cc86f0aa015b57880c0a41a30cd29bea1d7bd860f656f", "content": "Client behaviour can be changed via the javadoc:org.springframework.data.elasticsearch.client.ClientConfiguration[] that allows to set options for SSL, connect and socket timeouts, headers and other parameters.\n\n.Client Configuration\n====\n[source,java]\n----\nimport org.springframework.data.elasticsearch.client.ClientConfiguration;\nimport org.springframework.data.elasticsearch.support.HttpHeaders;\n\nimport static org.springframework.data.elasticsearch.client.elc.ElasticsearchClients.*;\n\nHttpHeaders httpHeaders = new HttpHeaders();\nhttpHeaders.add(\"some-header\", \"on every request\") <.>\n\nClientConfiguration clientConfiguration = ClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\") <.>\n .usingSsl() <.>\n .withProxy(\"localhost:8888\") <.>\n .withPathPrefix(\"ela\") <.>\n .withConnectTimeout(Duration.ofSeconds(5)) <.>\n .withSocketTimeout(Duration.ofSeconds(3)) <.>\n .withDefaultHeaders(defaultHeaders) <.>\n .withBasicAuth(username, password) <.>\n .withHeaders(() -> { <.>\n HttpHeaders headers = new HttpHeaders();\n headers.add(\"currentTime\", LocalDateTime.now().format(DateTimeFormatter.ISO_LOCAL_DATE_TIME));\n return headers;\n })\n .withClientConfigurer( <.>\n ElasticsearchHttpClientConfigurationCallback.from(clientBuilder -> {\n // ...\n return clientBuilder;\n }))\n . // ... other options\n .build();\n\n----\n\n<.> Define default headers, if they need to be customized\n<.> Use the builder to provide cluster addresses, set default `HttpHeaders` or enable SSL.\n<.> Optionally enable SSL.There exist overloads of this function that can take a `SSLContext` or as an alternative the fingerprint of the certificate as it is output by Elasticsearch on startup (since version 8).\n<.> Optionally set a proxy.\n<.> Optionally set a path prefix, mostly used when different clusters a behind some reverse proxy.\n<.> Set the connection timeout.\n<.> Set the socket timeout.\n<.> Optionally set headers.\n<.> Add basic authentication.\n<.> A `Supplier<HttpHeaders>` function can be specified which is called every time before a request is sent to Elasticsearch - here, as an example, the current time is written in a header.\n<.> a function to configure the created client (see xref:elasticsearch/clients.adoc#elasticsearch.clients.configuration.callbacks[Client configuration callbacks]), can be added multiple times.\n====\n\nIMPORTANT: Adding a Header supplier as shown in above example allows to inject headers that may change over the time, like authentication JWT tokens.\nIf this is used in the reactive setup, the supplier function *must not* block!\n\n[[elasticsearch.clients.configuration.callbacks]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Client Configuration", "heading_level": 2, "file_order": 6, "section_index": 5, "content_hash": "2bcfa2bfb08a111e265cc86f0aa015b57880c0a41a30cd29bea1d7bd860f656f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:30f663238befd610037403dbe4758ea21891b43699c0034d4825e02e209b01bc", "content": "The javadoc:org.springframework.data.elasticsearch.client.ClientConfiguration[] class offers the most common parameters to configure the client.\nIn the case this is not enough, the user can add callback functions by using the `withClientConfigurer(ClientConfigurationCallback<?>)` method.\n\nThe following callbacks are provided:\n\n[[elasticsearch.clients.configuration.callbacks.rest5]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Client configuration callbacks", "heading_level": 3, "file_order": 6, "section_index": 6, "content_hash": "30f663238befd610037403dbe4758ea21891b43699c0034d4825e02e209b01bc", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:9d1ad691d7d8141a4f4621cdb2660b2256b3003ff4c15d2446267f103082f37b", "content": "This callback provides a `org.elasticsearch.client.RestClientBuilder` that can be used to configure the Elasticsearch\n`Rest5Client`:\n====\n[source,java]\n----\nClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\")\n .withClientConfigurer(Rest5Clients.ElasticsearchRest5ClientConfigurationCallback.from(restClientBuilder -> {\n // configure the Elasticsearch Rest5Client\n return restClientBuilder;\n }))\n .build();\n----\n====\n[[elasticsearch.clients.configuration.callbacks.rest]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Configuration of the low level Elasticsearch `Rest5Client`:", "heading_level": 4, "file_order": 6, "section_index": 7, "content_hash": "9d1ad691d7d8141a4f4621cdb2660b2256b3003ff4c15d2446267f103082f37b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:4b2669e0d487f0a77aa57d825a5f6939caf1282c62823bd804594c4e3027a091", "content": "This callback provides a `org.elasticsearch.client.RestClientBuilder` that can be used to configure the Elasticsearch\n`RestClient`:\n====\n[source,java]\n----\nClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\")\n .withClientConfigurer(RestClients.ElasticsearchRestClientConfigurationCallback.from(restClientBuilder -> {\n // configure the Elasticsearch RestClient\n return restClientBuilder;\n }))\n .build();\n----\n====\n\n[[elasticsearch.clients.configurationcallbacks.httpasync5]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Configuration of the deprecated low level Elasticsearch `RestClient`:", "heading_level": 4, "file_order": 6, "section_index": 8, "content_hash": "4b2669e0d487f0a77aa57d825a5f6939caf1282c62823bd804594c4e3027a091", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:fb99a245cf537ac4d768ef959d36e84866c7171540b2f7c5568c7be246c545c0", "content": "This callback provides a `org.apache.hc.client5.http.impl.async.HttpAsyncClientBuilder` to configure the HttpClient that is\nused by the `Rest5Client`.\n\n====\n[source,java]\n----\nClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\")\n .withClientConfigurer(Rest5Clients.ElasticsearchHttpClientConfigurationCallback.from(httpAsyncClientBuilder -> {\n // configure the HttpAsyncClient\n return httpAsyncClientBuilder;\n }))\n .build();\n----\n====\n\n[[elasticsearch.clients.configurationcallbacks.httpasync]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Configuration of the HttpAsyncClient used by the low level Elasticsearch `Rest5Client`:", "heading_level": 4, "file_order": 6, "section_index": 9, "content_hash": "fb99a245cf537ac4d768ef959d36e84866c7171540b2f7c5568c7be246c545c0", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:2c54cf52c4a5a79e2a9b1bd81fbc3f5e21db1d6b8a4c774c81ae671c2bf16dc1", "content": "This callback provides a `org.apache.http.impl.nio.client.HttpAsyncClientBuilder` to configure the HttpClient that is\nused by the `RestClient`.\n\n====\n[source,java]\n----\nClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\")\n .withClientConfigurer(RestClients.ElasticsearchHttpClientConfigurationCallback.from(httpAsyncClientBuilder -> {\n // configure the HttpAsyncClient\n return httpAsyncClientBuilder;\n }))\n .build();\n----\n====\n\n[[elasticsearch.clients.configurationcallbacks.connectionconfig]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Configuration of the HttpAsyncClient used by the deprecated low level Elasticsearch `RestClient`:", "heading_level": 4, "file_order": 6, "section_index": 10, "content_hash": "2c54cf52c4a5a79e2a9b1bd81fbc3f5e21db1d6b8a4c774c81ae671c2bf16dc1", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:94db564b3de5f91a54df297a25a1d0894996202d6d15248269954a3b0a24147a", "content": "This callback provides a `org.apache.hc.client5.http.config.ConnectionConfig` to configure the connection that is\nused by the `Rest5Client`.\n\n====\n[source,java]\n----\nClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\")\n .withClientConfigurer(Rest5Clients.ElasticsearchConnectionConfigurationCallback.from(connectionConfigBuilder -> {\n // configure the connection\n return connectionConfigBuilder;\n }))\n .build();\n----\n====\n\n[[elasticsearch.clients.configurationcallbacks.connectioncmanager]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Configuration of the ConnectionConfig used by the low level Elasticsearch `Rest5Client`:", "heading_level": 4, "file_order": 6, "section_index": 11, "content_hash": "94db564b3de5f91a54df297a25a1d0894996202d6d15248269954a3b0a24147a", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:f1dbd3ac270abe34b575212b5a646b88b5a2a9afa81a3dffbcff960737236f41", "content": "This callback provides a `org.apache.hc.client5.http.impl.nio.PoolingAsyncClientConnectionManagerBuilder` to configure the connection manager that is\nused by the `Rest5Client`.\n\n====\n[source,java]\n----\nClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\")\n .withClientConfigurer(Rest5Clients.ElasticsearchConnectionManagerCallback.from(connectionManagerBuilder -> {\n // configure the connection manager\n return connectionManagerBuilder;\n }))\n .build();\n----\n====\n\n[[elasticsearch.clients.configurationcallbacks.requestconfig]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Configuration of the ConnectionManager used by the low level Elasticsearch `Rest5Client`:", "heading_level": 4, "file_order": 6, "section_index": 12, "content_hash": "f1dbd3ac270abe34b575212b5a646b88b5a2a9afa81a3dffbcff960737236f41", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:2ee037896c50e8c23cd0688cd2afe29e140fefba752f693c3e188bc6135dbf37", "content": "This callback provides a `org.apache.hc.client5.http.config.RequestConfig` to configure the RequestConfig that is\nused by the `Rest5Client`.\n\n====\n[source,java]\n----\nClientConfiguration.builder()\n .connectedTo(\"localhost:9200\", \"localhost:9291\")\n .withClientConfigurer(Rest5Clients.ElasticsearchRequestConfigCallback.from(requestConfigBuilder -> {\n // configure the request config\n return requestConfigBuilder;\n }))\n .build();\n----\n====\n\n[[elasticsearch.clients.logging]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Configuration of the RequestConfig used by the low level Elasticsearch `Rest5Client`:", "heading_level": 4, "file_order": 6, "section_index": 13, "content_hash": "2ee037896c50e8c23cd0688cd2afe29e140fefba752f693c3e188bc6135dbf37", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:9411b36c472695722800d1fdc7bddc15225de86761f401e063d8916d9ab89a38", "content": "To see what is actually sent to and received from the server `Request` / `Response` logging on the transport level needs to be turned on as outlined in the snippet below.\nThis can be enabled in the Elasticsearch client by setting the level of the `co.elastic.clients.transport.rest5_client.low_level.Request` package to \"trace\" (see\nhttps://www.elastic.co/docs/reference/elasticsearch/clients/java/transport/rest5-client/usage/logging)\n\n.Enable transport layer logging\n[tabs]\n======\nXML::\n+\n[source,xml]\n----\n<logger name=\"co.elastic.clients.transport.rest5_client.low_level.Request\" level=\"trace\"/>\n----\n\nyml::\n+\n[source,yml]\n----\nlogging.level:\n co.elastic.clients.transport.rest5_client.low_level.Request: trace\n----\n\nini::\n+\n[source,ini]\n----\nlogging.level.co.elastic.clients.transport.rest5_client.low_level.Request=trace\n----\n======", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/clients.adoc", "title": "clients", "heading": "Client Logging", "heading_level": 2, "file_order": 6, "section_index": 14, "content_hash": "9411b36c472695722800d1fdc7bddc15225de86761f401e063d8916d9ab89a38", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/clients.adoc"}}
{"id": "sha256:2ce9d3d714c46d6cf0f038f36ec3a1c9b905a6a782c8e084dd69af8eed46a70f", "content": "[[new-features]]\n\n[[new-features.6-1-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "elasticsearch-new", "heading_level": 1, "file_order": 7, "section_index": 0, "content_hash": "2ce9d3d714c46d6cf0f038f36ec3a1c9b905a6a782c8e084dd69af8eed46a70f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:c4e9f3789f113ae0c7769c54b7ba3a0cc19ec7a44424aac5a779f59277bac76e", "content": "* Upgrade to Elasticsearch 9.2.5\n* Add support to use `IndexCoordinates` as repository query parameter\n\n[[new-features.6-0-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 6.1", "heading_level": 2, "file_order": 7, "section_index": 1, "content_hash": "c4e9f3789f113ae0c7769c54b7ba3a0cc19ec7a44424aac5a779f59277bac76e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:d9370d3d4bf8418036483a1450cf9d90984dbb2ff47634de8a19f6dfbecf5672", "content": "* Upgrade to Spring 7\n* Switch to jspecify nullability annotations\n* Upgrade to Elasticsearch 9.2.1\n* Use the new Elasticsearch Rest5Client as default\n* Add support for SpEL expressions in the `settingPath` parameter of the `@Setting` annotation\n\n[[new-features.5-5-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 6.0", "heading_level": 2, "file_order": 7, "section_index": 2, "content_hash": "d9370d3d4bf8418036483a1450cf9d90984dbb2ff47634de8a19f6dfbecf5672", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:ce2a687b5172163784b355ec68cfa6e968bd3e8f291b43414cc8140013b4df79", "content": "* Upgrade to Elasticsearch 8.18.1.\n* Add support for the `@SearchTemplateQuery` annotation on repository methods.\n* Scripted field properties of type collection can be populated from scripts returning arrays.\n\n[[new-features.5-4-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 5.5", "heading_level": 2, "file_order": 7, "section_index": 3, "content_hash": "ce2a687b5172163784b355ec68cfa6e968bd3e8f291b43414cc8140013b4df79", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:c914a750af8410294eba376593d9495e330e84c876b1baafeb5fadffb8c64a6b", "content": "* Upgrade to Elasticsearch 8.15.3.\n* Allow to customize the mapped type name for `@InnerField` and `@Field` annotations.\n* Support for Elasticsearch SQL.\n* Add support for retrieving request executionDuration.\n\n[[new-features.5-3-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 5.4", "heading_level": 2, "file_order": 7, "section_index": 4, "content_hash": "c914a750af8410294eba376593d9495e330e84c876b1baafeb5fadffb8c64a6b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:44a23cea4f69a9905f95df9e9ca06ba272da616f9b47aec7491139f74f123e1e", "content": "* Upgrade to Elasticsearch 8.13.2.\n* Add support for highlight queries in highlighting.\n* Add shard statistics to the `SearchHit` class.\n* Add support for multi search template API.\n* Add support for SpEL in @Query.\n* Add support for field aliases in the index mapping.\n* Add support for has_child and has_parent queries.\n\n[[new-features.5-2-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 5.3", "heading_level": 2, "file_order": 7, "section_index": 5, "content_hash": "44a23cea4f69a9905f95df9e9ca06ba272da616f9b47aec7491139f74f123e1e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:68a1834fe6a4246fd0cd594281efc19e5ee6aeb072201e75c20dce2a21eb584f", "content": "* Upgrade to Elasticsearch 8.11.1\n* The `JsonpMapper` for Elasticsearch is now configurable and provided as bean.\n* Improved AOT runtime hints for Elasticsearch client library classes.\n* Add Kotlin extensions and repository coroutine support.\n* Introducing `VersionConflictException` class thrown in case thatElasticsearch reports an 409 error with a version conflict.\n* Enable MultiField annotation on property getter\n* Support nested sort option\n* Improved scripted und runtime field support\n* Improved refresh policy support\n\n[[new-features.5-1-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 5.2", "heading_level": 2, "file_order": 7, "section_index": 6, "content_hash": "68a1834fe6a4246fd0cd594281efc19e5ee6aeb072201e75c20dce2a21eb584f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:f6cbca39f8e0f85e6fd1f8360a1e0bbaa0b07ec36e6d4601d4e0ddeaf4e4a13d", "content": "* Upgrade to Elasticsearch 8.7.1\n* Allow specification of the TLS certificate when connecting to an Elasticsearch 8 cluster\n\n[[new-features.5-0-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 5.1", "heading_level": 2, "file_order": 7, "section_index": 7, "content_hash": "f6cbca39f8e0f85e6fd1f8360a1e0bbaa0b07ec36e6d4601d4e0ddeaf4e4a13d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:1a1cf1d048c10e08694a847669d1b133a15907044e5fe1e6d4571dbee239d3e2", "content": "* Upgrade to Java 17 baseline\n* Upgrade to Spring Framework 6\n* Upgrade to Elasticsearch 8.5.0\n* Use the new Elasticsearch client library\n\n[[new-features.4-4-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 5.0", "heading_level": 2, "file_order": 7, "section_index": 8, "content_hash": "1a1cf1d048c10e08694a847669d1b133a15907044e5fe1e6d4571dbee239d3e2", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:02076263d4fb5528063e922a19f16d498485887b7210e62dcfa1617ac77284df", "content": "* Introduction of new imperative and reactive clients using the classes from the new Elasticsearch Java client\n* Upgrade to Elasticsearch 7.17.3.\n\n[[new-features.4-3-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 4.4", "heading_level": 2, "file_order": 7, "section_index": 9, "content_hash": "02076263d4fb5528063e922a19f16d498485887b7210e62dcfa1617ac77284df", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:2872265164ccbc3f45af4ab609c8a731250792959bc9b944d82e71ac5392643a", "content": "* Upgrade to Elasticsearch 7.15.2.\n* Allow runtime_fields to be defined in the index mapping.\n* Add native support for range field types by using a range object.\n* Add repository search for nullable or empty properties.\n* Enable custom converters for single fields.\n* Supply a custom `Sort.Order` providing Elasticsearch specific parameters.\n\n[[new-features.4-2-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 4.3", "heading_level": 2, "file_order": 7, "section_index": 10, "content_hash": "2872265164ccbc3f45af4ab609c8a731250792959bc9b944d82e71ac5392643a", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:9ab051839b31e4c8d40a2cb7a1446120e67d6b04944e3115f698528af6732d48", "content": "* Upgrade to Elasticsearch 7.10.0.\n* Support for custom routing values\n\n[[new-features.4-1-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 4.2", "heading_level": 2, "file_order": 7, "section_index": 11, "content_hash": "9ab051839b31e4c8d40a2cb7a1446120e67d6b04944e3115f698528af6732d48", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:c135ba4bfc39debb68e519b9c0e95b33fa558859179bbf80975975af3f9a5ae8", "content": "* Uses Spring 5.3.\n* Upgrade to Elasticsearch 7.9.3.\n* Improved API for alias management.\n* Introduction of `ReactiveIndexOperations` for index management.\n* Index templates support.\n* Support for Geo-shape data with GeoJson.\n\n[[new-features.4-0-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 4.1", "heading_level": 2, "file_order": 7, "section_index": 12, "content_hash": "c135ba4bfc39debb68e519b9c0e95b33fa558859179bbf80975975af3f9a5ae8", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:25842038ee01aa5bbd0e4fbd351fd3f9b9305e1883469d85f8321d0c95bd4ab7", "content": "* Uses Spring 5.2.\n* Upgrade to Elasticsearch 7.6.2.\n* Deprecation of `TransportClient` usage.\n* Implements most of the mapping-types available for the index mappings.\n* Removal of the Jackson `ObjectMapper`, now using the xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model[MappingElasticsearchConverter]\n* Cleanup of the API in the `*Operations` interfaces, grouping and renaming methods so that they match the Elasticsearch API, deprecating the old methods, aligning with other Spring Data modules.\n* Introduction of `SearchHit<T>` class to represent a found document together with the relevant result metadata for this document (i.e. _sortValues_).\n* Introduction of the `SearchHits<T>` class to represent a whole search result together with the metadata for the complete search result (i.e. _max_score_).\n* Introduction of `SearchPage<T>` class to represent a paged result containing a `SearchHits<T>` instance.\n* Introduction of the `GeoDistanceOrder` class to be able to create sorting by geographical distance\n* Implementation of Auditing Support\n* Implementation of lifecycle entity callbacks\n\n[[new-features.3-2-0]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 4.0", "heading_level": 2, "file_order": 7, "section_index": 13, "content_hash": "25842038ee01aa5bbd0e4fbd351fd3f9b9305e1883469d85f8321d0c95bd4ab7", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:36a6d9ea09af4421d2b716a1b00fc27bbbce356169809393518752366a028171", "content": "* Secured Elasticsearch cluster support with Basic Authentication and SSL transport.\n* Upgrade to Elasticsearch 6.8.1.\n* Reactive programming support with xref:elasticsearch/repositories/reactive-elasticsearch-repositories.adoc[Reactive Elasticsearch Repositories] and xref:.\n* Introduction of the xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model[ElasticsearchEntityMapper] as an alternative to the Jackson `ObjectMapper`.\n* Field name customization in `@Field`.\n* Support for Delete by Query.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc", "title": "elasticsearch-new", "heading": "New in Spring Data Elasticsearch 3.2", "heading_level": 2, "file_order": 7, "section_index": 14, "content_hash": "36a6d9ea09af4421d2b716a1b00fc27bbbce356169809393518752366a028171", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/elasticsearch-new.adoc"}}
{"id": "sha256:22eb98abd885331145113cd9b805a0c9f2c86265f2163822a9754f706dc8ac05", "content": "include::{commons}@data-commons::page$entity-callbacks.adoc[]\n\n[[elasticsearch.entity-callbacks]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/entity-callbacks.adoc", "title": "entity-callbacks", "heading": "entity-callbacks", "heading_level": 1, "file_order": 8, "section_index": 0, "content_hash": "22eb98abd885331145113cd9b805a0c9f2c86265f2163822a9754f706dc8ac05", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/entity-callbacks.adoc"}}
{"id": "sha256:71f5357dd81bda0ee327e7b6d77f46b64e0b5566b5d0d4f73433653f7898c2dd", "content": "Spring Data Elasticsearch uses the `EntityCallback` API internally for its auditing support and reacts on the following callbacks:\n\n.Supported Entity Callbacks\n[%header,cols=\"4\"]\n|===\n| Callback\n| Method\n| Description\n| Order\n\n| Reactive/BeforeConvertCallback\n| `onBeforeConvert(T entity, IndexCoordinates index)`\n| Invoked before a domain object is converted to `org.springframework.data.elasticsearch.core.document.Document`.\nCan return the `entity` or a modified entity which then will be converted.\n| `Ordered.LOWEST_PRECEDENCE`\n\n| Reactive/AfterLoadCallback\n| `onAfterLoad(Document document, Class<T> type, IndexCoordinates indexCoordinates)`\n| Invoked after the result from Elasticsearch has been read into a `org.springframework.data.elasticsearch.core.document.Document`.\n| `Ordered.LOWEST_PRECEDENCE`\n\n| Reactive/AfterConvertCallback\n| `onAfterConvert(T entity, Document document, IndexCoordinates indexCoordinates)`\n| Invoked after a domain object is converted from `org.springframework.data.elasticsearch.core.document.Document` on reading result data from Elasticsearch.\n| `Ordered.LOWEST_PRECEDENCE`\n\n| Reactive/AuditingEntityCallback\n| `onBeforeConvert(Object entity, IndexCoordinates index)`\n| Marks an auditable entity _created_ or _modified_\n| 100\n\n| Reactive/AfterSaveCallback\n| `T onAfterSave(T entity, IndexCoordinates index)`\n| Invoked after a domain object is saved.\n| `Ordered.LOWEST_PRECEDENCE`\n\n|===", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/entity-callbacks.adoc", "title": "entity-callbacks", "heading": "Store specific EntityCallbacks", "heading_level": 2, "file_order": 8, "section_index": 1, "content_hash": "71f5357dd81bda0ee327e7b6d77f46b64e0b5566b5d0d4f73433653f7898c2dd", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/entity-callbacks.adoc"}}
{"id": "sha256:cbce1340e519ebdff08dbc8eb019a049bfc3ba5e30b05887cc58cc0a6cf6d851", "content": "[[elasticsearch.jointype]]\n\nSpring Data Elasticsearch supports the https://www.elastic.co/guide/en/elasticsearch/reference/current/parent-join.html[Join data type] for creating the corresponding index mappings and for storing the relevant information.\n\n[[elasticsearch.jointype.setting-up]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/join-types.adoc", "title": "join-types", "heading": "join-types", "heading_level": 1, "file_order": 9, "section_index": 0, "content_hash": "cbce1340e519ebdff08dbc8eb019a049bfc3ba5e30b05887cc58cc0a6cf6d851", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/join-types.adoc"}}
{"id": "sha256:cb5a7a3f354791bc0f679d2b79044fae346d192ab28c677d698664820c31323a", "content": "For an entity to be used in a parent child join relationship, it must have a property of type `JoinField` which must be annotated.\nLet's assume a `Statement` entity where a statement may be a _question_, an _answer_, a _comment_ or a _vote_ (a _Builder_ is also shown in this example, it's not necessary, but later used in the sample code):\n\n====\n[source,java]\n----\n@Document(indexName = \"statements\")\n@Routing(\"routing\") <.>\npublic class Statement {\n @Id\n private String id;\n\n @Field(type = FieldType.Text)\n private String text;\n\n @Field(type = FieldType.Keyword)\n private String routing;\n\n @JoinTypeRelations(\n relations =\n {\n @JoinTypeRelation(parent = \"question\", children = {\"answer\", \"comment\"}), <.>\n @JoinTypeRelation(parent = \"answer\", children = \"vote\") <.>\n }\n )\n private JoinField<String> relation; <.>\n\n private Statement() {\n }\n\n public static StatementBuilder builder() {\n return new StatementBuilder();\n }\n\n public String getId() {\n return id;\n }\n\n public void setId(String id) {\n this.id = id;\n }\n\n public String getRouting() {\n return routing;\n }\n\n public void setRouting(String routing) {\n this.routing = routing;\n }\n\n public String getText() {\n return text;\n }\n\n public void setText(String text) {\n this.text = text;\n }\n\n public JoinField<String> getRelation() {\n return relation;\n }\n\n public void setRelation(JoinField<String> relation) {\n this.relation = relation;\n }\n\n public static final class StatementBuilder {\n private String id;\n private String text;\n private String routing;\n private JoinField<String> relation;\n\n private StatementBuilder() {\n }\n\n public StatementBuilder withId(String id) {\n this.id = id;\n return this;\n }\n\n public StatementBuilder withRouting(String routing) {\n this.routing = routing;\n return this;\n }\n\n public StatementBuilder withText(String text) {\n this.text = text;\n return this;\n }\n\n public StatementBuilder withRelation(JoinField<String> relation) {\n this.relation = relation;\n return this;\n }\n\n public Statement build() {\n Statement statement = new Statement();\n statement.setId(id);\n statement.setRouting(routing);\n statement.setText(text);\n statement.setRelation(relation);\n return statement;\n }\n }\n}\n----\n<.> for routing related info see xref:elasticsearch/routing.adoc[Routing values]\n<.> a question can have answers and comments\n<.> an answer can have votes\n<.> the `JoinField` property is used to combine the name (_question_, _answer_, _comment_ or _vote_) of the relation with the parent id.\nThe generic type must be the same as the `@Id` annotated property.\n====\n\nSpring Data Elasticsearch will build the following mapping for this class:\n\n====\n[source,json]\n----\n{\n \"statements\": {\n \"mappings\": {\n \"properties\": {\n \"_class\": {\n \"type\": \"text\",\n \"fields\": {\n \"keyword\": {\n \"type\": \"keyword\",\n \"ignore_above\": 256\n }\n }\n },\n \"routing\": {\n \"type\": \"keyword\"\n },\n \"relation\": {\n \"type\": \"join\",\n \"eager_global_ordinals\": true,\n \"relations\": {\n \"question\": [\n \"answer\",\n \"comment\"\n ],\n \"answer\": \"vote\"\n }\n },\n \"text\": {\n \"type\": \"text\"\n }\n }\n }\n }\n}\n----\n====\n\n[[elasticsearch.jointype.storing]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/join-types.adoc", "title": "join-types", "heading": "Setting up the data", "heading_level": 2, "file_order": 9, "section_index": 1, "content_hash": "cb5a7a3f354791bc0f679d2b79044fae346d192ab28c677d698664820c31323a", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/join-types.adoc"}}
{"id": "sha256:cb75b462719405d9e6993d1141ec59db45be8cf1d4d947f4cad88a663cf120a9", "content": "Given a repository for this class the following code inserts a question, two answers, a comment and a vote:\n\n====\n[source,java]\n----\nvoid init() {\n repository.deleteAll();\n\n Statement savedWeather = repository.save(\n Statement.builder()\n .withText(\"How is the weather?\")\n .withRelation(new JoinField<>(\"question\")) <1>\n .build());\n\n Statement sunnyAnswer = repository.save(\n Statement.builder()\n .withText(\"sunny\")\n .withRelation(new JoinField<>(\"answer\", savedWeather.getId())) <2>\n .build());\n\n repository.save(\n Statement.builder()\n .withText(\"rainy\")\n .withRelation(new JoinField<>(\"answer\", savedWeather.getId())) <3>\n .build());\n\n repository.save(\n Statement.builder()\n .withText(\"I don't like the rain\")\n .withRelation(new JoinField<>(\"comment\", savedWeather.getId())) <4>\n .build());\n\n repository.save(\n Statement.builder()\n .withText(\"+1 for the sun\")\n .withRouting(savedWeather.getId())\n .withRelation(new JoinField<>(\"vote\", sunnyAnswer.getId())) <5>\n .build());\n}\n----\n<1> create a question statement\n<2> the first answer to the question\n<3> the second answer\n<4> a comment to the question\n<5> a vote for the first answer, this needs to have the routing set to the weather document, see xref:elasticsearch/routing.adoc[Routing values].\n====\n\n[[elasticsearch.jointype.retrieving]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/join-types.adoc", "title": "join-types", "heading": "Storing data", "heading_level": 2, "file_order": 9, "section_index": 2, "content_hash": "cb75b462719405d9e6993d1141ec59db45be8cf1d4d947f4cad88a663cf120a9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/join-types.adoc"}}
{"id": "sha256:431aee0e4afb91a1bce8fdd4b3d6ea7edb0b0b027c75aaedf067bfbe2045d5d8", "content": "Currently native queries must be used to query the data, so there is no support from standard repository methods. xref:repositories/custom-implementations.adoc[] can be used instead.\n\nThe following code shows as an example how to retrieve all entries that have a _vote_ (which must be _answers_, because only answers can have a vote) using an `ElasticsearchOperations` instance:\n\n====\n[source,java]\n----\nSearchHits<Statement> hasVotes() {\n\n\tQuery query = NativeQuery.builder()\n .withQuery(co.elastic.clients.elasticsearch._types.query_dsl.Query.of(qb -> qb\n .hasChild(hc -> hc\n .type(\"answer\")\n .queryName(\"vote\")\n .query(matchAllQueryAsQuery())\n .scoreMode(ChildScoreMode.None)\n )))\n .build();\n\n\treturn operations.search(query, Statement.class);\n}\n----\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/join-types.adoc", "title": "join-types", "heading": "Retrieving data", "heading_level": 2, "file_order": 9, "section_index": 3, "content_hash": "431aee0e4afb91a1bce8fdd4b3d6ea7edb0b0b027c75aaedf067bfbe2045d5d8", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/join-types.adoc"}}
{"id": "sha256:492a786a787f4951ffae4bdbac7fdff738a0d7c1fae099ed071fc7d7e200e6b6", "content": "[[elasticsearch.misc]]\n\nThis chapter covers additional support for Elasticsearch operations that cannot be directly accessed via the repository interface.\nIt is recommended to add those operations as custom implementation as described in xref:repositories/custom-implementations.adoc[] .\n\n[[elasticsearc.misc.index.settings]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "misc", "heading_level": 1, "file_order": 10, "section_index": 0, "content_hash": "492a786a787f4951ffae4bdbac7fdff738a0d7c1fae099ed071fc7d7e200e6b6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:6410ec2ab70ed2db95517251bbb6f548bcb83edc7cc796d8b26c339d78883394", "content": "When creating Elasticsearch indices with Spring Data Elasticsearch different index settings can be defined by using the `@Setting` annotation.\nThe following arguments are available:\n\n* `useServerConfiguration` does not send any settings parameters, so the Elasticsearch server configuration determines them.\n* `settingPath` refers to a JSON file defining the settings that must be resolvable in the classpath, it is possible to use a SpEL expression here\n* `shards` the number of shards to use, defaults to _1_\n* `replicas` the number of replicas, defaults to _1_\n* `refreshIntervall`, defaults to _\"1s\"_\n* `indexStoreType`, defaults to _\"fs\"_\n\nIt is as well possible to define https://www.elastic.co/guide/en/elasticsearch/reference/7.11/index-modules-index-sorting.html[index sorting] (check the linked Elasticsearch documentation for the possible field types and values):\n\n====\n[source,java]\n----\n@Document(indexName = \"entities\")\n@Setting(\n sortFields = { \"secondField\", \"firstField\" }, <.>\n sortModes = { Setting.SortMode.max, Setting.SortMode.min }, <.>\n sortOrders = { Setting.SortOrder.desc, Setting.SortOrder.asc },\n sortMissingValues = { Setting.SortMissing._last, Setting.SortMissing._first })\nclass Entity {\n @Nullable\n @Id private String id;\n\n @Nullable\n @Field(name = \"first_field\", type = FieldType.Keyword)\n private String firstField;\n\n @Nullable @Field(name = \"second_field\", type = FieldType.Keyword)\n private String secondField;\n\n // getter and setter...\n}\n----\n\n<.> when defining sort fields, use the name of the Java property (_firstField_), not the name that might be defined for Elasticsearch (_first_field_)\n<.> `sortModes`, `sortOrders` and `sortMissingValues` are optional, but if they are set, the number of entries must match the number of `sortFields` elements\n====\n\n[[elasticsearch.misc.mappings]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Index settings", "heading_level": 2, "file_order": 10, "section_index": 1, "content_hash": "6410ec2ab70ed2db95517251bbb6f548bcb83edc7cc796d8b26c339d78883394", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:eb7e92a39e42a784638d1c7827d336f265f346eae23245a9abb75b81bb82f639", "content": "When Spring Data Elasticsearch creates the index mapping with the `IndexOperations.createMapping()` methods, it uses the annotations described in xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.annotations[Mapping Annotation Overview], especially the `@Field` annotation.\nIn addition to that it is possible to add the `@Mapping` annotation to a class.\nThis annotation has the following properties:\n\n* `mappingPath` a classpath resource in JSON format; if this is not empty it is used as the mapping, no other mapping processing is done.\n* `enabled` when set to false, this flag is written to the mapping and no further processing is done.\n* `dateDetection` and `numericDetection` set the corresponding properties in the mapping when not set to `DEFAULT`.\n* `dynamicDateFormats` when this String array is not empty, it defines the date formats used for automatic date detection.\n* `runtimeFieldsPath` a classpath resource in JSON format containing the definition of runtime fields which is written to the index mappings, for example:\n\n====\n[source,json]\n----\n{\n \"day_of_week\": {\n \"type\": \"keyword\",\n \"script\": {\n \"source\": \"emit(doc['@timestamp'].value.dayOfWeekEnum.getDisplayName(TextStyle.FULL, Locale.ROOT))\"\n }\n }\n}\n----\n====\n\n[[elasticsearch.misc.filter]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Index Mapping", "heading_level": 2, "file_order": 10, "section_index": 2, "content_hash": "eb7e92a39e42a784638d1c7827d336f265f346eae23245a9abb75b81bb82f639", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:a908c63e4755577b234babef830b94d16658e0c4ca539b515683e82f1f66eecd", "content": "Filter Builder improves query speed.\n\n====\n[source,java]\n----\nprivate ElasticsearchOperations operations;\n\nIndexCoordinates index = IndexCoordinates.of(\"sample-index\");\n\nQuery query = NativeQuery.builder()\n\t.withQuery(q -> q\n .matchAll(ma -> ma))\n\t.withFilter( q -> q\n .bool(b -> b\n .must(m -> m\n .term(t -> t\n .field(\"id\")\n .value(documentId))\n )))\n\t.build();\n\nSearchHits<SampleEntity> sampleEntities = operations.search(query, SampleEntity.class, index);\n----\n====\n\n[[elasticsearch.scroll]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Filter Builder", "heading_level": 2, "file_order": 10, "section_index": 3, "content_hash": "a908c63e4755577b234babef830b94d16658e0c4ca539b515683e82f1f66eecd", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:29448d47df0e5fc480405243700eb22f38aaadd6bdf23c5a1d430a9195db0d91", "content": "Elasticsearch has a scroll API for getting big result set in chunks.\nThis is internally used by Spring Data Elasticsearch to provide the implementations of the `<T> SearchHitsIterator<T> SearchOperations.searchForStream(Query query, Class<T> clazz, IndexCoordinates index)` method.\n\n====\n[source,java]\n----\nIndexCoordinates index = IndexCoordinates.of(\"sample-index\");\n\nQuery searchQuery = NativeQuery.builder()\n .withQuery(q -> q\n .matchAll(ma -> ma))\n .withFields(\"message\")\n .withPageable(PageRequest.of(0, 10))\n .build();\n\nSearchHitsIterator<SampleEntity> stream = elasticsearchOperations.searchForStream(searchQuery, SampleEntity.class,\nindex);\n\nList<SampleEntity> sampleEntities = new ArrayList<>();\nwhile (stream.hasNext()) {\n sampleEntities.add(stream.next());\n}\n\nstream.close();\n----\n====\n\nThere are no methods in the `SearchOperations` API to access the scroll id, if it should be necessary to access this, the following methods of the `AbstractElasticsearchTemplate` can be used (this is the base implementation for the different `ElasticsearchOperations` implementations):\n\n====\n[source,java]\n----\n\n@Autowired ElasticsearchOperations operations;\n\nAbstractElasticsearchTemplate template = (AbstractElasticsearchTemplate)operations;\n\nIndexCoordinates index = IndexCoordinates.of(\"sample-index\");\n\nQuery query = NativeQuery.builder()\n .withQuery(q -> q\n .matchAll(ma -> ma))\n .withFields(\"message\")\n .withPageable(PageRequest.of(0, 10))\n .build();\n\nSearchScrollHits<SampleEntity> scroll = template.searchScrollStart(1000, query, SampleEntity.class, index);\n\nString scrollId = scroll.getScrollId();\nList<SampleEntity> sampleEntities = new ArrayList<>();\nwhile (scroll.hasSearchHits()) {\n sampleEntities.addAll(scroll.getSearchHits());\n scrollId = scroll.getScrollId();\n scroll = template.searchScrollContinue(scrollId, 1000, SampleEntity.class);\n}\ntemplate.searchScrollClear(scrollId);\n----\n====\n\nTo use the Scroll API with repository methods, the return type must defined as `Stream` in the Elasticsearch Repository.\nThe implementation of the method will then use the scroll methods from the ElasticsearchTemplate.\n\n====\n[source,java]\n----\ninterface SampleEntityRepository extends Repository<SampleEntity, String> {\n\n Stream<SampleEntity> findBy();\n\n}\n----\n====\n\n[[elasticsearch.misc.sorts]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Using Scroll For Big Result Set", "heading_level": 2, "file_order": 10, "section_index": 4, "content_hash": "29448d47df0e5fc480405243700eb22f38aaadd6bdf23c5a1d430a9195db0d91", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:9472021fa63e843bf7d4141dd67c6fd7206570c624f5fbec678e9275e09d8beb", "content": "In addition to the default sort options described in xref:repositories/query-methods-details.adoc#repositories.paging-and-sorting[Paging and Sorting], Spring Data Elasticsearch provides the class `org.springframework.data.elasticsearch.core.query.Order` which derives from `org.springframework.data.domain.Sort.Order`.\nIt offers additional parameters that can be sent to Elasticsearch when specifying the sorting of the result (see https://www.elastic.co/guide/en/elasticsearch/reference/7.15/sort-search-results.html).\n\nThere also is the `org.springframework.data.elasticsearch.core.query.GeoDistanceOrder` class which can be used to have the result of a search operation ordered by geographical distance.\n\nIf the class to be retrieved has a `GeoPoint` property named _location_, the following `Sort` would sort the results by distance to the given point:\n\n====\n[source,java]\n----\nSort.by(new GeoDistanceOrder(\"location\", new GeoPoint(48.137154, 11.5761247)))\n----\n====\n\n[[elasticsearch.misc.runtime-fields]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Sort options", "heading_level": 2, "file_order": 10, "section_index": 5, "content_hash": "9472021fa63e843bf7d4141dd67c6fd7206570c624f5fbec678e9275e09d8beb", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:afda660508f89ac1af9e4deb4d9baabfb51e4b51d0a3fc14527376fc77108fda", "content": "From version 7.12 on Elasticsearch has added the feature of runtime fields (https://www.elastic.co/guide/en/elasticsearch/reference/7.12/runtime.html).\nSpring Data Elasticsearch supports this in two ways:\n\n[[elasticsearch.misc.runtime-fields.index-mappings]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Runtime Fields", "heading_level": 2, "file_order": 10, "section_index": 6, "content_hash": "afda660508f89ac1af9e4deb4d9baabfb51e4b51d0a3fc14527376fc77108fda", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:7d8e892d06caefa8b6312b3c992d46f7f990d3a70227b41a175884aae57d4cb8", "content": "The first way to define runtime fields is by adding the definitions to the index mappings (see https://www.elastic.co/guide/en/elasticsearch/reference/7.12/runtime-mapping-fields.html).\nTo use this approach in Spring Data Elasticsearch the user must provide a JSON file that contains the corresponding definition, for example:\n\n.runtime-fields.json\n====\n[source,json]\n----\n{\n \"day_of_week\": {\n \"type\": \"keyword\",\n \"script\": {\n \"source\": \"emit(doc['@timestamp'].value.dayOfWeekEnum.getDisplayName(TextStyle.FULL, Locale.ROOT))\"\n }\n }\n}\n----\n====\n\nThe path to this JSON file, which must be present on the classpath, must then be set in the `@Mapping` annotation of the entity:\n\n====\n[source,java]\n----\n@Document(indexName = \"runtime-fields\")\n@Mapping(runtimeFieldsPath = \"/runtime-fields.json\")\npublic class RuntimeFieldEntity {\n\t// properties, getter, setter,...\n}\n\n----\n====\n\n[[elasticsearch.misc.runtime-fields.query]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Runtime field definitions in the index mappings", "heading_level": 3, "file_order": 10, "section_index": 7, "content_hash": "7d8e892d06caefa8b6312b3c992d46f7f990d3a70227b41a175884aae57d4cb8", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:930db582ac5b7e200be438b6862d824344e0b41bbc81971510e1501f6acd0622", "content": "The second way to define runtime fields is by adding the definitions to a search query (see https://www.elastic.co/guide/en/elasticsearch/reference/7.12/runtime-search-request.html).\nThe following code example shows how to do this with Spring Data Elasticsearch :\n\nThe entity used is a simple object that has a `price` property:\n\n====\n[source,java]\n----\n@Document(indexName = \"some_index_name\")\npublic class SomethingToBuy {\n\n\tprivate @Id @Nullable String id;\n\t@Nullable @Field(type = FieldType.Text) private String description;\n\t@Nullable @Field(type = FieldType.Double) private Double price;\n\n\t// getter and setter\n}\n\n----\n====\n\nThe following query uses a runtime field that calculates a `priceWithTax` value by adding 19% to the price and uses this value in the search query to find all entities where `priceWithTax` is higher or equal than a given value:\n\n====\n[source,java]\n----\nRuntimeField runtimeField = new RuntimeField(\"priceWithTax\", \"double\", \"emit(doc['price'].value * 1.19)\");\nQuery query = new CriteriaQuery(new Criteria(\"priceWithTax\").greaterThanEqual(16.5));\nquery.addRuntimeField(runtimeField);\n\nSearchHits<SomethingToBuy> searchHits = operations.search(query, SomethingToBuy.class);\n----\n====\n\nThis works with every implementation of the `Query` interface.\n\n[[elasticsearch.misc.point-in-time]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Runtime fields definitions set on a Query", "heading_level": 3, "file_order": 10, "section_index": 8, "content_hash": "930db582ac5b7e200be438b6862d824344e0b41bbc81971510e1501f6acd0622", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:088b6e93b84df067425afcdf6c18c6f2d2b4a5f180bda9494825627b00f91f41", "content": "`ElasticsearchOperations` supports the point in time API of Elasticsearch (see https://www.elastic.co/guide/en/elasticsearch/reference/8.3/point-in-time-api.html).\nThe following code snippet shows how to use this feature with a fictional `Person` class:\n\n====\n[source,java]\n----\nElasticsearchOperations operations; // autowired\nDuration tenSeconds = Duration.ofSeconds(10);\n\nString pit = operations.openPointInTime(IndexCoordinates.of(\"person\"), tenSeconds); <.>\n\nQuery query1 = new CriteriaQueryBuilder(Criteria.where(\"lastName\").is(\"Smith\"))\n .withPointInTime(new Query.PointInTime(pit, tenSeconds)) <.>\n .build();\nSearchHits<Person> searchHits1 = operations.search(query1, Person.class);\n\nQuery query2 = new CriteriaQueryBuilder(Criteria.where(\"lastName\").is(\"Miller\"))\n .withPointInTime(\n new Query.PointInTime(searchHits1.getPointInTimeId(), tenSeconds)) <.>\n .build();\nSearchHits<Person> searchHits2 = operations.search(query2, Person.class);\n\noperations.closePointInTime(searchHits2.getPointInTimeId()); <.>\n\n----\n\n<.> create a point in time for an index (can be multiple names) and a keep-alive duration and retrieve its id\n<.> pass that id into the query to search together with the next keep-alive value\n<.> for the next query, use the id returned from the previous search\n<.> when done, close the point in time using the last returned id\n====\n\n[[elasticsearch.misc.searchtemplates]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Point In Time (PIT) API", "heading_level": 2, "file_order": 10, "section_index": 9, "content_hash": "088b6e93b84df067425afcdf6c18c6f2d2b4a5f180bda9494825627b00f91f41", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:34da05baded7db62f84761c055e53e2b66175fb636baaca8ed16103ca782e6fe", "content": "Use of the search template API is supported.\nTo use this, it first is necessary to create a stored script.\nThe `ElasticsearchOperations` interface extends `ScriptOperations` which provides the necessary functions.\nThe example used here assumes that we have `Person` entity with a property named `firstName`.\nA search template script can be saved like this:\n\n====\n[source,java]\n----\nimport org.springframework.data.elasticsearch.core.ElasticsearchOperations;\nimport org.springframework.data.elasticsearch.core.script.Script;\n\noperations.putScript( <.>\n Script.builder()\n .withId(\"person-firstname\") <.>\n .withLanguage(\"mustache\") <.>\n .withSource(\"\"\" <.>\n {\n \"query\": {\n \"bool\": {\n \"must\": [\n {\n \"match\": {\n \"firstName\": \"{{firstName}}\" <.>\n }\n }\n ]\n }\n },\n \"from\": \"{{from}}\", <.>\n \"size\": \"{{size}}\" <.>\n }\n \"\"\")\n .build()\n);\n----\n\n<.> Use the `putScript()` method to store a search template script\n<.> The name / id of the script\n<.> Scripts that are used in search templates must be in the _mustache_ language.\n<.> The script source\n<.> The search parameter in the script\n<.> Paging request offset\n<.> Paging request size\n====\n\nTo use a search template in a search query, Spring Data Elasticsearch provides the `SearchTemplateQuery`, an implementation of the `org.springframework.data.elasticsearch.core.query.Query` interface.\n\nNOTE: Although `SearchTemplateQuery` is an implementation of the `Query` interface, not all of the functionality provided by the base class is available for a `SearchTemplateQuery` like setting a `Pageable` or a `Sort`. Values for this functionality must be added to the stored script like shown in the following example for paging parameters. If these values are set on the `Query` object, they will be ignored.\n\nIn the following code, we will add a call using a search template query to a custom repository implementation (see\nxref:repositories/custom-implementations.adoc[]) as an example how this can be integrated into a repository call.\n\nWe first define the custom repository fragment interface:\n\n====\n[source,java]\n----\ninterface PersonCustomRepository {\n\tSearchPage<Person> findByFirstNameWithSearchTemplate(String firstName, Pageable pageable);\n}\n----\n====\n\nThe implementation of this repository fragment looks like this:\n\n====\n[source,java]\n----\npublic class PersonCustomRepositoryImpl implements PersonCustomRepository {\n\n private final ElasticsearchOperations operations;\n\n public PersonCustomRepositoryImpl(ElasticsearchOperations operations) {\n this.operations = operations;\n }\n\n @Override\n public SearchPage<Person> findByFirstNameWithSearchTemplate(String firstName, Pageable pageable) {\n\n var query = SearchTemplateQuery.builder() <.>\n .withId(\"person-firstname\") <.>\n .withParams(\n Map.of( <.>\n \"firstName\", firstName,\n \"from\", pageable.getOffset(),\n \"size\", pageable.getPageSize()\n )\n )\n .build();\n\n SearchHits<Person> searchHits = operations.search(query, Person.class); <.>\n\n return SearchHitSupport.searchPageFor(searchHits, pageable);\n }\n}\n----\n\n<.> Create a `SearchTemplateQuery`\n<.> Provide the id of the search template\n<.> The parameters are passed in a `Map<String,Object>`\n<.> Do the search in the same way as with the other query types.\n====\n\n[[elasticsearch.misc.nested-sort]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Search Template support", "heading_level": 2, "file_order": 10, "section_index": 10, "content_hash": "34da05baded7db62f84761c055e53e2b66175fb636baaca8ed16103ca782e6fe", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:ec55dc00b897d2d34215b7d7763859d45653102c0bd8c943ab0bc6c00f12ff75", "content": "Spring Data Elasticsearch supports sorting within nested objects (https://www.elastic.co/guide/en/elasticsearch/reference/8.9/sort-search-results.html#nested-sorting)\n\nThe following example, taken from the `org.springframework.data.elasticsearch.core.query.sort.NestedSortIntegrationTests` class, shows how to define the nested sort.\n\n====\n[source,java]\n----\nvar filter = StringQuery.builder(\"\"\"\n\t{ \"term\": {\"movies.actors.sex\": \"m\"} }\n\t\"\"\").build();\nvar order = new org.springframework.data.elasticsearch.core.query.Order(Sort.Direction.DESC,\n\t\"movies.actors.yearOfBirth\")\n\t.withNested(\n Nested.builder(\"movies\")\n .withNested(\n Nested.builder(\"movies.actors\")\n .withFilter(filter)\n .build())\n .build());\n\nvar query = Query.findAll().addSort(Sort.by(order));\n\n----\n====\n\nAbout the filter query: It is not possible to use a `CriteriaQuery` here, as this query would be converted into a Elasticsearch nested query which does not work in the filter context. So only `StringQuery` or `NativeQuery` can be used here. When using one of these, like the term query above, the Elasticsearch field names must be used, so take care, when these are redefined with the `@Field(name=\"...\")` definition.\n\nFor the definition of the order path and the nested paths, the Java entity property names should be used.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/misc.adoc", "title": "misc", "heading": "Nested sort", "heading_level": 2, "file_order": 10, "section_index": 11, "content_hash": "ec55dc00b897d2d34215b7d7763859d45653102c0bd8c943ab0bc6c00f12ff75", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/misc.adoc"}}
{"id": "sha256:e7635c7f55c070a19c7439c11d4f647f6647aed9e041905d1743405a317952cf", "content": "[[elasticsearch.mapping]]\n\nSpring Data Elasticsearch Object Mapping is the process that maps a Java object - the domain entity - into the JSON representation that is stored in Elasticsearch and back.\nThe class that is internally used for this mapping is the\n`MappingElasticsearchConverter`.\n\n[[elasticsearch.mapping.meta-model]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "object-mapping", "heading_level": 1, "file_order": 11, "section_index": 0, "content_hash": "e7635c7f55c070a19c7439c11d4f647f6647aed9e041905d1743405a317952cf", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:45db6e53eda10cd92d32735d098d99681027270ea7c6f04b35c4d9d917f1fec2", "content": "The Metamodel based approach uses domain type information for reading/writing from/to Elasticsearch.\nThis allows to register `Converter` instances for specific domain type mapping.\n\n[[elasticsearch.mapping.meta-model.annotations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Meta Model Object Mapping", "heading_level": 2, "file_order": 11, "section_index": 1, "content_hash": "45db6e53eda10cd92d32735d098d99681027270ea7c6f04b35c4d9d917f1fec2", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:636f7865ce20bf094ccb21ec4a9a0328e766e53f2e832782d6661edf983f1227", "content": "The `MappingElasticsearchConverter` uses metadata to drive the mapping of objects to documents.\nThe metadata is taken from the entity's properties which can be annotated.\n\nThe following annotations are available:\n\n* `@Document`: Applied at the class level to indicate this class is a candidate for mapping to the database.\nThe most important attributes are (check the API documentation for the complete list of attributes):\n** `indexName`: the name of the index to store this entity in.\nThis can contain a SpEL template expression like `\"log-#{T(java.time.LocalDate).now().toString()}\"`\n** `createIndex`: flag whether to create an index on repository bootstrapping.\nDefault value is _true_.\nSee xref:elasticsearch/repositories/elasticsearch-repositories.adoc#elasticsearch.repositories.autocreation[Automatic creation of indices with the corresponding mapping]\n\n* `@Id`: Applied at the field level to mark the field used for identity purpose.\n* `@Transient`, `@ReadOnlyProperty`, `@WriteOnlyProperty`: see the following section xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.annotations.read-write[Controlling which properties are written to and read from Elasticsearch] for detailed information.\n* `@PersistenceConstructor`: Marks a given constructor - even a package protected one - to use when instantiating the object from the database.\nConstructor arguments are mapped by name to the key values in the retrieved Document.\n* `@Field`: Applied at the field level and defines properties of the field, most of the attributes map to the respective https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping.html[Elasticsearch Mapping] definitions (the following list is not complete, check the annotation Javadoc for a complete reference):\n** `name`: The name of the field as it will be represented in the Elasticsearch document, if not set, the Java field name is used.\n** `type`: The field type, can be one of _Text, Keyword, Long, Integer, Short, Byte, Double, Float, Half_Float, Scaled_Float, Date, Date_Nanos, Boolean, Binary, Integer_Range, Float_Range, Long_Range, Double_Range, Date_Range, Ip_Range, Object, Nested, Ip, TokenCount, Percolator, Flattened, Search_As_You_Type_.\nSee https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-types.html[Elasticsearch Mapping Types].\nIf the field type is not specified, it defaults to `FieldType.Auto`.\nThis means, that no mapping entry is written for the property and that Elasticsearch will add a mapping entry dynamically when the first data for this property is stored (check the Elasticsearch documentation for dynamic mapping rules).\n** `format`: One or more built-in date formats, see the next section xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.annotations.date-formats[Date format mapping].\n** `pattern`: One or more custom date formats, see the next section xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.annotations.date-formats[Date format mapping].\n** `store`: Flag whether the original field value should be store in Elasticsearch, default value is _false_.\n** `analyzer`, `searchAnalyzer`, `normalizer` for specifying custom analyzers and normalizer.\n* `@GeoPoint`: Marks a field as _geo_point_ datatype.\nCan be omitted if the field is an instance of the `GeoPoint` class.\n* `@ValueConverter` defines a class to be used to convert the given property.\nIn difference to a registered Spring `Converter` this only converts the annotated property and not every property of the given type.\n\nThe mapping metadata infrastructure is defined in a separate spring-data-commons project that is technology agnostic.\n\n[[elasticsearch.mapping.meta-model.annotations.read-write]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Mapping Annotation Overview", "heading_level": 3, "file_order": 11, "section_index": 2, "content_hash": "636f7865ce20bf094ccb21ec4a9a0328e766e53f2e832782d6661edf983f1227", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:767c29b74137e415c914640b643af41b50c848a1f84706d57cb603404560e7c3", "content": "This section details the annotations that define if the value of a property is written to or read from Elasticsearch.\n\n`@Transient`: A property annotated with this annotation will not be written to the mapping, it's value will not be sent to Elasticsearch and when documents are returned from Elasticsearch, this property will not be set in the resulting entity.\n\n`@ReadOnlyProperty`: A property with this annotation will not have its value written to Elasticsearch, but when returning data, the property will be filled with the value returned in the document from Elasticsearch.\nOne use case for this are runtime fields defined in the index mapping.\n\n`@WriteOnlyProperty`: A property with this annotation will have its value stored in Elasticsearch but will not be set with any value when reading document.\nThis can be used for example for synthesized fields which should go into the Elasticsearch index but are not used elsewhere.\n\n[[elasticsearch.mapping.meta-model.annotations.date-formats]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Controlling which properties are written to and read from Elasticsearch", "heading_level": 4, "file_order": 11, "section_index": 3, "content_hash": "767c29b74137e415c914640b643af41b50c848a1f84706d57cb603404560e7c3", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:0d2ff7b72010dd504442abd480083efe7224dc9f80510211daba6eab72b5c6f1", "content": "Properties that derive from `TemporalAccessor` or are of type `java.util.Date` must either have a `@Field` annotation of type `FieldType.Date` or a custom converter must be registered for this type.\nThis paragraph describes the use of\n`FieldType.Date`.\n\nThere are two attributes of the `@Field` annotation that define which date format information is written to the mapping (also see https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-date-format.html#built-in-date-formats[Elasticsearch Built In Formats] and https://www.elastic.co/guide/en/elasticsearch/reference/current/mapping-date-format.html#custom-date-formats[Elasticsearch Custom Date Formats])\n\nThe `format` attribute is used to define at least one of the predefined formats.\nIf it is not defined, then a default value of __date_optional_time_ and _epoch_millis_ is used.\n\nThe `pattern` attribute can be used to add additional custom format strings.\nIf you want to use only custom date formats, you must set the `format` property to empty `{}`.\n\nThe following table shows the different attributes and the mapping created from their values:\n\n[cols=2*,options=header]\n|===\n| annotation\n| format string in Elasticsearch mapping\n\n| @Field(type=FieldType.Date)\n| \"date_optional_time\\|\\|epoch_millis\",\n\n| @Field(type=FieldType.Date, format=DateFormat.basic_date)\n| \"basic_date\"\n\n| @Field(type=FieldType.Date, format={DateFormat.basic_date, DateFormat.basic_time})\n| \"basic_date\\|\\|basic_time\"\n\n| @Field(type=FieldType.Date, pattern=\"dd.MM.uuuu\")\n| \"date_optional_time\\|\\|epoch_millis\\|\\|dd.MM.uuuu\",\n\n| @Field(type=FieldType.Date, format={}, pattern=\"dd.MM.uuuu\")\n| \"dd.MM.uuuu\"\n\n|===\n\nNOTE: If you are using a custom date format, you need to use _uuuu_ for the year instead of _yyyy_.\nThis is due to a https://www.elastic.co/guide/en/elasticsearch/reference/current/migrate-to-java-time.html#java-time-migration-incompatible-date-formats[change in Elasticsearch 7].\n\nCheck the code of the `org.springframework.data.elasticsearch.annotations.DateFormat` enum for a complete list of predefined values and their patterns.\n\n[[elasticsearch.mapping.meta-model.annotations.range]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Date format mapping", "heading_level": 4, "file_order": 11, "section_index": 4, "content_hash": "0d2ff7b72010dd504442abd480083efe7224dc9f80510211daba6eab72b5c6f1", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:cd4f2565d8aca3b9c7ba4f344f6ae1924a5327b9cd9ff807fa9de8db299d093d", "content": "When a field is annotated with a type of one of _Integer_Range, Float_Range, Long_Range, Double_Range, Date_Range,_ or _Ip_Range_ the field must be an instance of a class that will be mapped to an Elasticsearch range, for example:\n\n====\n[source,java]\n----\nclass SomePersonData {\n\n @Field(type = FieldType.Integer_Range)\n private ValidAge validAge;\n\n // getter and setter\n}\n\nclass ValidAge {\n @Field(name=\"gte\")\n private Integer from;\n\n @Field(name=\"lte\")\n private Integer to;\n\n // getter and setter\n}\n----\n====\n\nAs an alternative Spring Data Elasticsearch provides a `Range<T>` class so that the previous example can be written as:\n\n====\n[source,java]\n----\nclass SomePersonData {\n\n @Field(type = FieldType.Integer_Range)\n private Range<Integer> validAge;\n\n // getter and setter\n}\n----\n====\n\nSupported classes for the type `<T>` are `Integer`, `Long`, `Float`, `Double`, `Date` and classes that implement the\n`TemporalAccessor` interface.\n\n[[elasticsearch.mapping.meta-model.annotations.mapped-names]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Range types", "heading_level": 4, "file_order": 11, "section_index": 5, "content_hash": "cd4f2565d8aca3b9c7ba4f344f6ae1924a5327b9cd9ff807fa9de8db299d093d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:e675c57f24f6b2fe18481d1eaf78b31ded7b5a0069fb17a824a3dd205627ab80", "content": "Without further configuration, Spring Data Elasticsearch will use the property name of an object as field name in Elasticsearch.\nThis can be changed for individual field by using the `@Field` annotation on that property.\n\nIt is also possible to define a `FieldNamingStrategy` in the configuration of the client (xref:elasticsearch/clients.adoc[Elasticsearch Clients]).\nIf for example a `SnakeCaseFieldNamingStrategy` is configured, the property _sampleProperty_ of the object would be mapped to _sample_property_ in Elasticsearch.\nA `FieldNamingStrategy` applies to all entities; it can be overwritten by setting a specific name with `@Field` on a property.\n\n[[elasticsearch.mapping.meta-model.annotations.non-field-backed-properties]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Mapped field names", "heading_level": 4, "file_order": 11, "section_index": 6, "content_hash": "e675c57f24f6b2fe18481d1eaf78b31ded7b5a0069fb17a824a3dd205627ab80", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:6c18e509815efa828498ef9751094d84e862065fc07b4c954847ff4e611587ab", "content": "Normally the properties used in an entity are fields of the entity class.\nThere might be cases, when a property value is calculated in the entity and should be stored in Elasticsearch.\nIn this case, the getter method (`getProperty()`) can be annotated with the `@Field` annotation, in addition to that the method must be annotated with `@AccessType(AccessType.Type\n.PROPERTY)`.\nThe third annotation that is needed in such a case is `@WriteOnlyProperty`, as such a value is only written to Elasticsearch.\nA full example:\n\n====\n[source,java]\n----\n@Field(type = Keyword)\n@WriteOnlyProperty\n@AccessType(AccessType.Type.PROPERTY)\npublic String getProperty() {\n\treturn \"some value that is calculated here\";\n}\n----\n====\n\n[[elasticsearch.mapping.meta-model.annotations.misc]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Non-field-backed properties", "heading_level": 4, "file_order": 11, "section_index": 7, "content_hash": "6c18e509815efa828498ef9751094d84e862065fc07b4c954847ff4e611587ab", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:078c929c88f0c33fe50da54ed997d3246e0ccd6b9f34cb7b5432e94eb10a4db6", "content": "[[indexedindexname]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Other property annotations", "heading_level": 4, "file_order": 11, "section_index": 8, "content_hash": "078c929c88f0c33fe50da54ed997d3246e0ccd6b9f34cb7b5432e94eb10a4db6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:5f280021f22464e6b26f4d3698440888afdfbb7b29ac5659c3c5ec61ffbe6fb7", "content": "This annotation can be set on a String property of an entity.\nThis property will not be written to the mapping, it will not be stored in Elasticsearch and its value will not be read from an Elasticsearch document.\nAfter an entity is persisted, for example with a call to `ElasticsearchOperations.save(T entity)`, the entity returned from that call will contain the name of the index that an entity was saved to in that property.\nThis is useful when the index name is dynamically set by a bean, or when writing to a write alias.\n\nPutting some value into such a property does not set the index into which an entity is stored!\n\n[[elasticsearch.mapping.meta-model.rules]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "@IndexedIndexName", "heading_level": 5, "file_order": 11, "section_index": 9, "content_hash": "5f280021f22464e6b26f4d3698440888afdfbb7b29ac5659c3c5ec61ffbe6fb7", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:92c4d34676dbb731441e3ad1c68b7455aa08edbc61acac26dec2c34909197960", "content": "[[elasticsearch.mapping.meta-model.rules.typehints]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Mapping Rules", "heading_level": 3, "file_order": 11, "section_index": 10, "content_hash": "92c4d34676dbb731441e3ad1c68b7455aa08edbc61acac26dec2c34909197960", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:13f116943551d2f69f42b98e8de0d2ddfbd2953a3c12d705823b4dc298eb6fad", "content": "Mapping uses _type hints_ embedded in the document sent to the server to allow generic type mapping.\nThose type hints are represented as `_class` attributes within the document and are written for each aggregate root.\n\n.Type Hints\n====\n[source,java]\n----\npublic class Person { <1>\n @Id String id;\n String firstname;\n String lastname;\n}\n----\n\n[source,json]\n----\n{\n \"_class\" : \"com.example.Person\", <1>\n \"id\" : \"cb7bef\",\n \"firstname\" : \"Sarah\",\n \"lastname\" : \"Connor\"\n}\n----\n\n<1> By default the domain types class name is used for the type hint.\n====\n\nType hints can be configured to hold custom information.\nUse the `@TypeAlias` annotation to do so.\n\nNOTE: Make sure to add types with `@TypeAlias` to the initial entity set (`AbstractElasticsearchConfiguration#getInitialEntitySet`) to already have entity information available when first reading data from the store.\n\n.Type Hints with Alias\n====\n[source,java]\n----\n@TypeAlias(\"human\") <1>\npublic class Person {\n\n @Id String id;\n // ...\n}\n----\n\n[source,json]\n----\n{\n \"_class\" : \"human\", <1>\n \"id\" : ...\n}\n----\n\n<1> The configured alias is used when writing the entity.\n====\n\nNOTE: Type hints will not be written for nested Objects unless the properties type is `Object`, an interface or the actual value type does not match the properties declaration.\n\n[[disabling-type-hints]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Type Hints", "heading_level": 4, "file_order": 11, "section_index": 11, "content_hash": "13f116943551d2f69f42b98e8de0d2ddfbd2953a3c12d705823b4dc298eb6fad", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:7744e039e12d86af7b8bebe6cff8b9c313e01d609a6d50b3b8c6cfae9702c47f", "content": "It may be necessary to disable writing of type hints when the index that should be used already exists without having the type hints defined in its mapping and with the mapping mode set to strict.\nIn this case, writing the type hint will produce an error, as the field cannot be added automatically.\n\nType hints can be disabled for the whole application by overriding the method `writeTypeHints()` in a configuration class derived from `AbstractElasticsearchConfiguration` (see xref:elasticsearch/clients.adoc[Elasticsearch Clients]).\n\nAs an alternative they can be disabled for a single index with the `@Document` annotation:\n\n====\n[source,java]\n----\n@Document(indexName = \"index\", writeTypeHint = WriteTypeHint.FALSE)\n----\n====\n\nWARNING: We strongly advise against disabling Type Hints.\nOnly do this if you are forced to.\nDisabling type hints can lead to documents not being retrieved correctly from Elasticsearch in case of polymorphic data or document retrieval may fail completely.\n\n[[elasticsearch.mapping.meta-model.rules.geospatial]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Disabling Type Hints", "heading_level": 5, "file_order": 11, "section_index": 12, "content_hash": "7744e039e12d86af7b8bebe6cff8b9c313e01d609a6d50b3b8c6cfae9702c47f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:7cb0eec05a42585d63578872dacbaf642a38ca5baab28935ddfc47c81d0faa36", "content": "Geospatial types like `Point` & `GeoPoint` are converted into _lat/lon_ pairs.\n\n.Geospatial types\n====\n[source,java]\n----\npublic class Address {\n String city, street;\n Point location;\n}\n----\n\n[source,json]\n----\n{\n \"city\" : \"Los Angeles\",\n \"street\" : \"2800 East Observatory Road\",\n \"location\" : { \"lat\" : 34.118347, \"lon\" : -118.3026284 }\n}\n----\n====\n\n[[elasticsearch.mapping.meta-model.rules.geojson]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Geospatial Types", "heading_level": 4, "file_order": 11, "section_index": 13, "content_hash": "7cb0eec05a42585d63578872dacbaf642a38ca5baab28935ddfc47c81d0faa36", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:4bea15d36b21ffe0c45a25e3436151f7c8eb8eca75455e0dca225c9ab8a04b45", "content": "Spring Data Elasticsearch supports the GeoJson types by providing an interface `GeoJson` and implementations for the different geometries.\nThey are mapped to Elasticsearch documents according to the GeoJson specification.\nThe corresponding properties of the entity are specified in the index mappings as `geo_shape` when the index mappings is written. (check the https://www.elastic.co/guide/en/elasticsearch/reference/current/geo-shape.html[Elasticsearch documentation] as well)\n\n.GeoJson types\n====\n[source,java]\n----\npublic class Address {\n\n String city, street;\n GeoJsonPoint location;\n}\n----\n\n[source,json]\n----\n{\n \"city\": \"Los Angeles\",\n \"street\": \"2800 East Observatory Road\",\n \"location\": {\n \"type\": \"Point\",\n \"coordinates\": [-118.3026284, 34.118347]\n }\n}\n----\n====\n\nThe following GeoJson types are implemented:\n\n* `GeoJsonPoint`\n* `GeoJsonMultiPoint`\n* `GeoJsonLineString`\n* `GeoJsonMultiLineString`\n* `GeoJsonPolygon`\n* `GeoJsonMultiPolygon`\n* `GeoJsonGeometryCollection`\n\n[[elasticsearch.mapping.meta-model.rules.collections]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "GeoJson Types", "heading_level": 4, "file_order": 11, "section_index": 14, "content_hash": "4bea15d36b21ffe0c45a25e3436151f7c8eb8eca75455e0dca225c9ab8a04b45", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:1ec6de657c6aa306d0863527c3957c7fc37680b87584c82eef3c5ade4fed4598", "content": "For values inside Collections apply the same mapping rules as for aggregate roots when it comes to _type hints_ and xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.conversions[Custom Conversions].\n\n.Collections\n====\n[source,java]\n----\npublic class Person {\n\n // ...\n\n List<Person> friends;\n\n}\n----\n\n[source,json]\n----\n{\n // ...\n\n \"friends\" : [ { \"firstname\" : \"Kyle\", \"lastname\" : \"Reese\" } ]\n}\n----\n====\n\n[[elasticsearch.mapping.meta-model.rules.maps]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Collections", "heading_level": 4, "file_order": 11, "section_index": 15, "content_hash": "1ec6de657c6aa306d0863527c3957c7fc37680b87584c82eef3c5ade4fed4598", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:93accdedea3fa5552f43165bed22227be4a65477ec330eb117f3823653234db6", "content": "For values inside Maps apply the same mapping rules as for aggregate roots when it comes to _type hints_ and xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.conversions[Custom Conversions].\nHowever the Map key needs to a String to be processed by Elasticsearch.\n\n.Collections\n====\n[source,java]\n----\npublic class Person {\n\n // ...\n\n Map<String, Address> knownLocations;\n\n}\n----\n\n[source,json]\n----\n{\n // ...\n\n \"knownLocations\" : {\n \"arrivedAt\" : {\n \"city\" : \"Los Angeles\",\n \"street\" : \"2800 East Observatory Road\",\n \"location\" : { \"lat\" : 34.118347, \"lon\" : -118.3026284 }\n }\n }\n}\n----\n====\n\n[[elasticsearch.mapping.meta-model.conversions]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Maps", "heading_level": 4, "file_order": 11, "section_index": 16, "content_hash": "93accdedea3fa5552f43165bed22227be4a65477ec330eb117f3823653234db6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:79a98d4a066fd165b4c398db912df9630701f5605f81f4b252df1a8ecb55b4a7", "content": "Looking at the `Configuration` from the xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model[previous section] `ElasticsearchCustomConversions` allows registering specific rules for mapping domain and simple types.\n\n.Meta Model Object Mapping Configuration\n====\n[source,java]\n----\n@Configuration\npublic class Config extends ElasticsearchConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() //\n .connectedTo(\"localhost:9200\") //\n .build();\n\t}\n\n @Bean\n @Override\n public ElasticsearchCustomConversions elasticsearchCustomConversions() {\n return new ElasticsearchCustomConversions(\n Arrays.asList(new AddressToMap(), new MapToAddress())); <1>\n }\n\n @WritingConverter <2>\n static class AddressToMap implements Converter<Address, Map<String, Object>> {\n\n @Override\n public Map<String, Object> convert(Address source) {\n\n LinkedHashMap<String, Object> target = new LinkedHashMap<>();\n target.put(\"ciudad\", source.getCity());\n // ...\n\n return target;\n }\n }\n\n @ReadingConverter <3>\n static class MapToAddress implements Converter<Map<String, Object>, Address> {\n\n @Override\n public Address convert(Map<String, Object> source) {\n\n // ...\n return address;\n }\n }\n}\n----\n\n[source,json]\n----\n{\n \"ciudad\" : \"Los Angeles\",\n \"calle\" : \"2800 East Observatory Road\",\n \"localidad\" : { \"lat\" : 34.118347, \"lon\" : -118.3026284 }\n}\n----\n\n<1> Add `Converter` implementations.\n<2> Set up the `Converter` used for writing `DomainType` to Elasticsearch.\n<3> Set up the `Converter` used for reading `DomainType` from search result.\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc", "title": "object-mapping", "heading": "Custom Conversions", "heading_level": 3, "file_order": 11, "section_index": 17, "content_hash": "79a98d4a066fd165b4c398db912df9630701f5605f81f4b252df1a8ecb55b4a7", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/object-mapping.adoc"}}
{"id": "sha256:94ebec60b29ae342e054cd51cadf27f86e6316eb87a5dcaf50a0ce9edf9514dc", "content": "[[elasticsearch.reactive.operations]]\n\n`ReactiveElasticsearchOperations` is the gateway to executing high level commands against an Elasticsearch cluster using the `ReactiveElasticsearchClient`.\n\nThe `ReactiveElasticsearchTemplate` is the default implementation of `ReactiveElasticsearchOperations`.\n\nTo get started the `ReactiveElasticsearchOperations` needs to know about the actual client to work with.\nPlease see xref:elasticsearch/clients.adoc#elasticsearch.clients.reactiverestclient[Reactive Rest Client] for details on the client and how to configure it.\n\n[[elasticsearch.reactive.operations.usage]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/reactive-template.adoc", "title": "reactive-template", "heading": "reactive-template", "heading_level": 1, "file_order": 12, "section_index": 0, "content_hash": "94ebec60b29ae342e054cd51cadf27f86e6316eb87a5dcaf50a0ce9edf9514dc", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/reactive-template.adoc"}}
{"id": "sha256:756127a3bcf868a58ce241391ee786ab5ea2b3c050e07294af02aa39a3531ebb", "content": "`ReactiveElasticsearchOperations` lets you save, find and delete your domain objects and map those objects to documents stored in Elasticsearch.\n\nConsider the following:\n\n.Use the ReactiveElasticsearchOperations\n====\n[source,java]\n----\n@Document(indexName = \"marvel\")\npublic class Person {\n\n private @Id String id;\n private String name;\n private int age;\n // Getter/Setter omitted...\n}\n----\n\n[source,java]\n----\n\nReactiveElasticsearchOperations operations;\n\noperations.save(new Person(\"Bruce Banner\", 42)) <.>\n .doOnNext(System.out::println)\n .flatMap(person -> operations.get(person.id, Person.class)) <.>\n .doOnNext(System.out::println)\n .flatMap(person -> operations.delete(person)) <.>\n .doOnNext(System.out::println)\n .flatMap(id -> operations.count(Person.class)) <.>\n .doOnNext(System.out::println)\n .subscribe(); <.>\n----\n\nThe above outputs the following sequence on the console.\n\n[source,text]\n----\n> Person(id=QjWCWWcBXiLAnp77ksfR, name=Bruce Banner, age=42)\n> Person(id=QjWCWWcBXiLAnp77ksfR, name=Bruce Banner, age=42)\n> QjWCWWcBXiLAnp77ksfR\n> 0\n----\n\n<.> Insert a new `Person` document into the _marvel_ index . The `id` is generated on server side and set into the instance returned.\n<.> Lookup the `Person` with matching `id` in the _marvel_ index.\n<.> Delete the `Person` with matching `id`, extracted from the given instance, in the _marvel_ index.\n<.> Count the total number of documents in the _marvel_ index.\n<.> Don't forget to _subscribe()_.\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/reactive-template.adoc", "title": "reactive-template", "heading": "Reactive Operations Usage", "heading_level": 2, "file_order": 12, "section_index": 1, "content_hash": "756127a3bcf868a58ce241391ee786ab5ea2b3c050e07294af02aa39a3531ebb", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/reactive-template.adoc"}}
{"id": "sha256:2f0c3798a641616f11f0e52ee61205c4ea17ccf3082afa9c3a39b023d1d2a212", "content": "[[elasticsearch.routing]]\n\nWhen Elasticsearch stores a document in an index that has multiple shards, it determines the shard to you use based on the _id_ of the document.\nSometimes it is necessary to predefine that multiple documents should be indexed on the same shard (join-types, faster search for related data).\nFor this Elasticsearch offers the possibility to define a routing, which is the value that should be used to calculate the shard from instead of the _id_.\n\nSpring Data Elasticsearch supports routing definitions on storing and retrieving data in the following ways:\n\n[[elasticsearch.routing.join-types]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/routing.adoc", "title": "routing", "heading": "routing", "heading_level": 1, "file_order": 13, "section_index": 0, "content_hash": "2f0c3798a641616f11f0e52ee61205c4ea17ccf3082afa9c3a39b023d1d2a212", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/routing.adoc"}}
{"id": "sha256:ebefaa2750dc56d5d82f5ab838414eb79e62e83d2581365f59ba0eb942a27a15", "content": "When using join-types (see xref:elasticsearch/join-types.adoc[Join-Type implementation]), Spring Data Elasticsearch will automatically use the `parent` property of the entity's `JoinField` property as the value for the routing.\n\nThis is correct for all the use-cases where the parent-child relationship has just one level.\nIf it is deeper, like a child-parent-grandparent relationship - like in the above example from _vote_ -> _answer_ -> _question_ - then the routing needs to explicitly specified by using the techniques described in the next section (the _vote_ needs the _question.id_ as routing value).\n\n[[elasticsearch.routing.custom]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/routing.adoc", "title": "routing", "heading": "Routing on join-types", "heading_level": 2, "file_order": 13, "section_index": 1, "content_hash": "ebefaa2750dc56d5d82f5ab838414eb79e62e83d2581365f59ba0eb942a27a15", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/routing.adoc"}}
{"id": "sha256:c1b9a6c938423413998c78a13c39beaa6b9685043155c461c8ede9379392ff21", "content": "To define a custom routing for an entity, Spring Data Elasticsearch provides a `@Routing` annotation (reusing the `Statement` class from above):\n\n====\n[source,java]\n----\n@Document(indexName = \"statements\")\n@Routing(\"routing\") <.>\npublic class Statement {\n @Id\n private String id;\n\n @Field(type = FieldType.Text)\n private String text;\n\n @JoinTypeRelations(\n relations =\n {\n @JoinTypeRelation(parent = \"question\", children = {\"answer\", \"comment\"}),\n @JoinTypeRelation(parent = \"answer\", children = \"vote\")\n }\n )\n private JoinField<String> relation;\n\n @Nullable\n @Field(type = FieldType.Keyword)\n private String routing; <.>\n\n // getter/setter...\n}\n----\n<.> This defines _\"routing\"_ as routing specification\n<.> a property with the name _routing_\n====\n\nIf the `routing` specification of the annotation is a plain string and not a SpEL expression, it is interpreted as the name of a property of the entity, in the example it's the _routing_ property.\nThe value of this property will then be used as the routing value for all requests that use the entity.\n\nIt is also possible to us a SpEL expression in the `@Document` annotation like this:\n\n====\n[source,java]\n----\n@Document(indexName = \"statements\")\n@Routing(\"@myBean.getRouting(#entity)\")\npublic class Statement{\n // all the needed stuff\n}\n----\n====\n\nIn this case the user needs to provide a bean with the name _myBean_ that has a method `String getRouting(Object)`. To reference the entity _\"#entity\"_ must be used in the SpEL expression, and the return value must be `null` or the routing value as a String.\n\nIf plain property's names and SpEL expressions are not enough to customize the routing definitions, it is possible to define provide an implementation of the `RoutingResolver` interface. This can then be set on the `ElasticOperations` instance:\n\n====\n[source,java]\n----\nRoutingResolver resolver = ...;\n\nElasticsearchOperations customOperations= operations.withRouting(resolver);\n\n----\n====\n\nThe `withRouting()` functions return a copy of the original `ElasticsearchOperations` instance with the customized routing set.\n\nWhen a routing has been defined on an entity when it is stored in Elasticsearch, the same value must be provided when doing a _get_ or _delete_ operation. For methods that do not use an entity - like `get(ID)` or `delete(ID)` - the `ElasticsearchOperations.withRouting(RoutingResolver)` method can be used like this:\n\n====\n[source,java]\n----\nString id = \"someId\";\nString routing = \"theRoutingValue\";\n\nStatement s = operations\n .withRouting(RoutingResolver.just(routing)) <.>\n .get(id, Statement.class);\n\noperations.withRouting(RoutingResolver.just(routing)).delete(id);\n\n----\n<.> `RoutingResolver.just(s)` returns a resolver that will just return the given String.\n====", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/routing.adoc", "title": "routing", "heading": "Custom routing values", "heading_level": 2, "file_order": 13, "section_index": 2, "content_hash": "c1b9a6c938423413998c78a13c39beaa6b9685043155c461c8ede9379392ff21", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/routing.adoc"}}
{"id": "sha256:59594de4718452a162995eb9ba05cabd75e149a8287b8cdf35ca1bf99025b3e6", "content": "[[elasticsearch.misc.scripted-and-runtime-fields]]\n\nSpring Data Elasticsearch supports scripted fields and runtime fields.\nPlease refer to the Elasticsearch documentation about scripting (https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting.html) and runtime fields (https://www.elastic.co/guide/en/elasticsearch/reference/8.9/runtime.html) for detailed information about this.\nIn the context of Spring Data Elasticsearch you can use\n\n* scripted fields that are used to return fields that are calculated on the result documents and added to the returned document.\n* runtime fields that are calculated on the stored documents and can be used in a query and/or be returned in the search result.\n\nThe following code snippets will show what you can do (these show imperative code, but the reactive implementation works similar).\n\n[[the-person-entity]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc", "title": "scripted-and-runtime-fields", "heading": "scripted-and-runtime-fields", "heading_level": 1, "file_order": 14, "section_index": 0, "content_hash": "59594de4718452a162995eb9ba05cabd75e149a8287b8cdf35ca1bf99025b3e6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc"}}
{"id": "sha256:bbdde09680316ea0daf0d45f78be122f666c817b7571a3386cb3bcab78d3c0c2", "content": "The enity that is used in these examples is a `Person` entity.\nThis entity has a `birthDate` and an `age` property.\nWhereas the birthdate is fix, the age depends on the time when a query is issued and needs to be calculated dynamically.\n\n====\n[source,java]\n----\nimport org.jspecify.annotations.Nullable;\nimport org.springframework.data.annotation.Id;\nimport org.springframework.data.elasticsearch.annotations.DateFormat;\nimport org.springframework.data.elasticsearch.annotations.Document;\nimport org.springframework.data.elasticsearch.annotations.Field;\nimport org.springframework.data.elasticsearch.annotations.ScriptedField;\n\nimport java.time.LocalDate;\nimport java.time.format.DateTimeFormatter;\n\nimport static org.springframework.data.elasticsearch.annotations.FieldType.*;\n\nimport java.lang.Integer;\n\n@Document(indexName = \"persons\")\npublic record Person(\n @Id\n @Nullable\n String id,\n @Field(type = Text)\n String lastName,\n @Field(type = Text)\n String firstName,\n @Field(type = Keyword)\n String gender,\n @Field(type = Date, format = DateFormat.basic_date)\n LocalDate birthDate,\n @Nullable\n @ScriptedField Integer age <.>\n) {\n public Person(String id,String lastName, String firstName, String gender, String birthDate) {\n this(id, <.>\n lastName,\n firstName,\n LocalDate.parse(birthDate, DateTimeFormatter.ISO_LOCAL_DATE),\n gender,\n null);\n }\n}\n\n----\n\n<.> the `age` property will be calculated and filled in search results.\n<.> a convenience constructor to set up the test data.\n====\n\nNote that the `age` property is annotated with `@ScriptedField`.\nThis inhibits the writing of a corresponding entry in the index mapping and marks the property as a target to put a calculated field from a search response.\n\n[[the-repository-interface]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc", "title": "scripted-and-runtime-fields", "heading": "The person entity", "heading_level": 2, "file_order": 14, "section_index": 1, "content_hash": "bbdde09680316ea0daf0d45f78be122f666c817b7571a3386cb3bcab78d3c0c2", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc"}}
{"id": "sha256:4841c4f384e11113f3c80c4ab3912cca5f2b98dd4700ed9be363305c3e4eaf41", "content": "The repository used in this example:\n\n====\n[source,java]\n----\npublic interface PersonRepository extends ElasticsearchRepository<Person, String> {\n\n SearchHits<Person> findAllBy(ScriptedField scriptedField);\n\n SearchHits<Person> findByGenderAndAgeLessThanEqual(String gender, Integer age, RuntimeField runtimeField);\n}\n\n----\n====\n\n[[the-service-class]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc", "title": "scripted-and-runtime-fields", "heading": "The repository interface", "heading_level": 2, "file_order": 14, "section_index": 2, "content_hash": "4841c4f384e11113f3c80c4ab3912cca5f2b98dd4700ed9be363305c3e4eaf41", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc"}}
{"id": "sha256:4a490901a370e0b4d9c6e1a1e8e3edd0fd7fd01694e4bfb1a0bca2febeb3df9e", "content": "The service class has a repository injected and an `ElasticsearchOperations` instance to show several ways of populating and using the `age` property.\nWe show the code split up in different pieces to put the explanations in\n\n====\n[source,java]\n----\nimport org.springframework.data.elasticsearch.core.ElasticsearchOperations;\nimport org.springframework.data.elasticsearch.core.SearchHits;\nimport org.springframework.data.elasticsearch.core.query.Criteria;\nimport org.springframework.data.elasticsearch.core.query.CriteriaQuery;\nimport org.springframework.data.elasticsearch.core.query.FetchSourceFilter;\nimport org.springframework.data.elasticsearch.core.query.RuntimeField;\nimport org.springframework.data.elasticsearch.core.query.ScriptData;\nimport org.springframework.data.elasticsearch.core.query.ScriptType;\nimport org.springframework.data.elasticsearch.core.query.ScriptedField;\nimport org.springframework.data.elasticsearch.core.query.StringQuery;\nimport org.springframework.stereotype.Service;\n\nimport java.util.List;\n\n@Service\npublic class PersonService {\n private final ElasticsearchOperations operations;\n private final PersonRepository repository;\n\n public PersonService(ElasticsearchOperations operations, SaRPersonRepository repository) {\n this.operations = operations;\n this.repository = repository;\n }\n\n public void save() { <.>\n List<Person> persons = List.of(\n new Person(\"1\", \"Smith\", \"Mary\", \"f\", \"1987-05-03\"),\n new Person(\"2\", \"Smith\", \"Joshua\", \"m\", \"1982-11-17\"),\n new Person(\"3\", \"Smith\", \"Joanna\", \"f\", \"2018-03-27\"),\n new Person(\"4\", \"Smith\", \"Alex\", \"m\", \"2020-08-01\"),\n new Person(\"5\", \"McNeill\", \"Fiona\", \"f\", \"1989-04-07\"),\n new Person(\"6\", \"McNeill\", \"Michael\", \"m\", \"1984-10-20\"),\n new Person(\"7\", \"McNeill\", \"Geraldine\", \"f\", \"2020-03-02\"),\n new Person(\"8\", \"McNeill\", \"Patrick\", \"m\", \"2022-07-04\"));\n\n repository.saveAll(persons);\n }\n----\n\n<.> a utility method to store some data in Elasticsearch.\n====\n\n[[scripted-fields]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc", "title": "scripted-and-runtime-fields", "heading": "The service class", "heading_level": 2, "file_order": 14, "section_index": 3, "content_hash": "4a490901a370e0b4d9c6e1a1e8e3edd0fd7fd01694e4bfb1a0bca2febeb3df9e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc"}}
{"id": "sha256:343227d3d57af08d74c1f1013541a3c467fb33a03ffc8e7ad78b1ce251bd9086", "content": "The next piece shows how to use a scripted field to calculate and return the age of the persons.\nScripted fields can only add something to the returned data, the age cannot be used in the query (see runtime fields for that).\n\n====\n[source,java]\n----\n public SearchHits<Person> findAllWithAge() {\n\n var scriptedField = ScriptedField.of(\"age\", <.>\n ScriptData.of(b -> b\n .withType(ScriptType.INLINE)\n .withScript(\"\"\"\n Instant currentDate = Instant.ofEpochMilli(new Date().getTime());\n Instant startDate = doc['birth-date'].value.toInstant();\n return (ChronoUnit.DAYS.between(startDate, currentDate) / 365);\n \"\"\")));\n\n // version 1: use a direct query\n var query = new StringQuery(\"\"\"\n { \"match_all\": {} }\n \"\"\");\n query.addScriptedField(scriptedField); <.>\n query.addSourceFilter(FetchSourceFilter.of(b -> b.withIncludes(\"*\"))); <.>\n\n var result1 = operations.search(query, Person.class); <.>\n\n // version 2: use the repository\n var result2 = repository.findAllBy(scriptedField); <.>\n\n return result1;\n }\n----\n\n<.> define the `ScriptedField` that calculates the age of a person.\n<.> when using a `Query`, add the scripted field to the query.\n<.> when adding a scripted field to a `Query`, an additional source filter is needed to also retrieve the _normal_ fields from the document source.\n<.> get the data where the `Person` entities now have the values set in their `age` property.\n<.> when using the repository, all that needs to be done is adding the scripted field as method parameter.\n====\n\n[[runtime-fields]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc", "title": "scripted-and-runtime-fields", "heading": "Scripted fields", "heading_level": 3, "file_order": 14, "section_index": 4, "content_hash": "343227d3d57af08d74c1f1013541a3c467fb33a03ffc8e7ad78b1ce251bd9086", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc"}}
{"id": "sha256:47e2fec0fe0c2af312c8bc4b5d7bd3d9e398ab34e27a2f2d0b1ef5c775ef7193", "content": "When using runtime fields, the calculated value can be used in the query itself.\nIn the following code this is used to run a query for a given gender and maximum age of persons:\n\n====\n[source,java]\n----\n public SearchHits<Person> findWithGenderAndMaxAge(String gender, Integer maxAge) {\n\n var runtimeField = new RuntimeField(\"age\", \"long\", \"\"\" <.>\n Instant currentDate = Instant.ofEpochMilli(new Date().getTime());\n Instant startDate = doc['birthDate'].value.toInstant();\n emit (ChronoUnit.DAYS.between(startDate, currentDate) / 365);\n \"\"\");\n\n // variant 1 : use a direct query\n var query = CriteriaQuery.builder(Criteria\n .where(\"gender\").is(gender)\n .and(\"age\").lessThanEqual(maxAge))\n .withRuntimeFields(List.of(runtimeField)) <.>\n .withFields(\"age\") <.>\n .withSourceFilter(FetchSourceFilter.of(b -> b.withIncludes(\"*\"))) <.>\n .build();\n\n var result1 = operations.search(query, Person.class); <.>\n\n // variant 2: use the repository <.>\n var result2 = repository.findByGenderAndAgeLessThanEqual(gender, maxAge, runtimeField);\n\n return result1;\n }\n}\n----\n\n<.> define the runtime field that calculates the age of a person. // see https://asciidoctor.org/docs/user-manual/#builtin-attributes for builtin attributes.\n<.> when using `Query`, add the runtime field.\n<.> when adding a scripted field to a `Query`, an additional field parameter is needed to have the calculated value returned.\n<.> when adding a scripted field to a `Query`, an additional source filter is needed to also retrieve the _normal_ fields from the document source.\n<.> get the data filtered with the query and where the returned entites have the age property set.\n<.> when using the repository, all that needs to be done is adding the runtime field as method parameter.\n====\n\nIn addition to define a runtime fields on a query, they can also be defined in the index by setting the `runtimeFieldsPath` property of the `@Mapping` annotation to point to a JSON file that contains the runtime field definitions.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc", "title": "scripted-and-runtime-fields", "heading": "Runtime fields", "heading_level": 3, "file_order": 14, "section_index": 5, "content_hash": "47e2fec0fe0c2af312c8bc4b5d7bd3d9e398ab34e27a2f2d0b1ef5c775ef7193", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/scripted-and-runtime-fields.adoc"}}
{"id": "sha256:a1cb82182856ce465fd64b7d8e395133db39d08a427d4515f26d5a62257cdd98", "content": "[[elasticsearch.operations]]\n\nSpring Data Elasticsearch uses several interfaces to define the operations that can be called against an Elasticsearch index (for a description of the reactive interfaces see xref:elasticsearch/reactive-template.adoc[]).\n\n* javadoc:org.springframework.data.elasticsearch.core.IndexOperations[] defines actions on index level like creating or deleting an index.\n* javadoc:org.springframework.data.elasticsearch.core.DocumentOperations[] defines actions to store, update and retrieve entities based on their id.\n* javadoc:org.springframework.data.elasticsearch.core.SearchOperations[] define the actions to search for multiple entities using queries\n* javadoc:org.springframework.data.elasticsearch.core.ElasticsearchOperations[] combines the `DocumentOperations` and `SearchOperations` interfaces.\n\nThese interfaces correspond to the structuring of the https://www.elastic.co/guide/en/elasticsearch/reference/current/rest-apis.html[Elasticsearch API].\n\nThe default implementations of the interfaces offer:\n\n* index management functionality.\n* Read/Write mapping support for domain types.\n* A rich query and criteria api.\n* Resource management and Exception translation.\n\n[NOTE]\n====\n.Index management and automatic creation of indices and mappings.\nThe `IndexOperations` interface and the provided implementation which can be obtained from an `ElasticsearchOperations` instance - for example with a call to `operations.indexOps(clazz)`- give the user the ability to create indices, put mappings or store template and alias information in the Elasticsearch cluster.\nDetails of the index that will be created can be set by using the `@Setting` annotation, refer to xref:elasticsearch/misc.adoc#elasticsearc.misc.index.settings[Index settings] for further information.\n\n**None of these operations are done automatically** by the implementations of `IndexOperations` or `ElasticsearchOperations`.\nIt is the user's responsibility to call the methods.\n\nThere is support for automatic creation of indices and writing the mappings when using Spring Data Elasticsearch repositories, see xref:elasticsearch/repositories/elasticsearch-repositories.adoc#elasticsearch.repositories.autocreation[Automatic creation of indices with the corresponding mapping]\n\n====\n\n[[elasticsearch.operations.usage]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "template", "heading_level": 1, "file_order": 15, "section_index": 0, "content_hash": "a1cb82182856ce465fd64b7d8e395133db39d08a427d4515f26d5a62257cdd98", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:4ec74a37566bc91aeb9eeb20fcb4cdd71aac51a88e8b30feeef50270f0622053", "content": "The example shows how to use an injected `ElasticsearchOperations` instance in a Spring REST controller.\nThe example assumes that `Person` is a class that is annotated with `@Document`, `@Id` etc (see xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.annotations[Mapping Annotation Overview]).\n\n.ElasticsearchOperations usage\n====\n[source,java]\n----\n@RestController\n@RequestMapping(\"/\")\npublic class TestController {\n\n private ElasticsearchOperations elasticsearchOperations;\n\n public TestController(ElasticsearchOperations elasticsearchOperations) { <.>\n this.elasticsearchOperations = elasticsearchOperations;\n }\n\n @PostMapping(\"/person\")\n public String save(@RequestBody Person person) { <.>\n Person savedEntity = elasticsearchOperations.save(person);\n return savedEntity.getId();\n }\n\n @GetMapping(\"/person/{id}\")\n public Person findById(@PathVariable(\"id\") Long id) { <.>\n Person person = elasticsearchOperations.get(id.toString(), Person.class);\n return person;\n }\n}\n\n----\n\n<.> Let Spring inject the provided `ElasticsearchOperations` bean in the constructor.\n<.> Store some entity in the Elasticsearch cluster.\nThe id is read from the returned entity, as it might have been null in the `person` object and been created by Elasticsearch.\n<.> Retrieve the entity with a get by id.\n====\n\nTo see the full possibilities of `ElasticsearchOperations` please refer to the API documentation.\n\n[[elasticsearch.operations.searchresulttypes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "Usage examples", "heading_level": 2, "file_order": 15, "section_index": 1, "content_hash": "4ec74a37566bc91aeb9eeb20fcb4cdd71aac51a88e8b30feeef50270f0622053", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:9229d132c0c0625d19633fb282e47ed0a9cabea3be77766a60cc7aadb4a6d491", "content": "When a document is retrieved with the methods of the `DocumentOperations` interface, just the found entity will be returned.\nWhen searching with the methods of the `SearchOperations` interface, additional information is available for each entity, for example the _score_ or the _sortValues_ of the found entity.\n\nIn order to return this information, each entity is wrapped in a `SearchHit` object that contains this entity-specific additional information.\nThese `SearchHit` objects themselves are returned within a `SearchHits` object which additionally contains informations about the whole search like the _maxScore_ or requested aggregations or the execution duration it took to complete the request.\nThe following classes and interfaces are now available:\n\n.SearchHit<T>\nContains the following information:\n\n* Id\n* Score\n* Sort Values\n* Highlight fields\n* Inner hits (this is an embedded `SearchHits` object containing eventually returned inner hits)\n* The retrieved entity of type <T>\n\n.SearchHits<T>\nContains the following information:\n\n* Number of total hits\n* Total hits relation\n* Maximum score\n* A list of `SearchHit<T>` objects\n* Returned aggregations\n* Returned suggest results\n\n.SearchPage<T>\nDefines a Spring Data `Page` that contains a `SearchHits<T>` element and can be used for paging access using repository methods.\n\n.SearchScrollHits<T>\nReturned by the low level scroll API functions in `ElasticsearchRestTemplate`, it enriches a `SearchHits<T>` with the Elasticsearch scroll id.\n\n.SearchHitsIterator<T>\nAn Iterator returned by the streaming functions of the `SearchOperations` interface.\n\n.ReactiveSearchHits\n`ReactiveSearchOperations` has methods returning a `Mono<ReactiveSearchHits<T>>`, this contains the same information as a `SearchHits<T>` object, but will provide the contained `SearchHit<T>` objects as a `Flux<SearchHit<T>>` and not as a list.\n\n[[elasticsearch.operations.queries]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "Search Result Types", "heading_level": 2, "file_order": 15, "section_index": 2, "content_hash": "9229d132c0c0625d19633fb282e47ed0a9cabea3be77766a60cc7aadb4a6d491", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:ff27a954cce8f8c5968d1a2322c72956c50705422bcd787942c86c69817056f9", "content": "Almost all of the methods defined in the `SearchOperations` and `ReactiveSearchOperations` interface take a `Query` parameter that defines the query to execute for searching. `Query` is an interface and Spring Data Elasticsearch provides three implementations: `CriteriaQuery`, `StringQuery` and `NativeQuery`.\n\n[[elasticsearch.operations.criteriaquery]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "Queries", "heading_level": 2, "file_order": 15, "section_index": 3, "content_hash": "ff27a954cce8f8c5968d1a2322c72956c50705422bcd787942c86c69817056f9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:86383eebc928a07b06aa60b2f591e798d929ad2867f0e10416ed6e987d3c9800", "content": "`CriteriaQuery` based queries allow the creation of queries to search for data without knowing the syntax or basics of Elasticsearch queries.\nThey allow the user to build queries by simply chaining and combining `Criteria` objects that specify the criteria the searched documents must fulfill.\n\nNOTE: when talking about AND or OR when combining criteria keep in mind, that in Elasticsearch AND are converted to a **must** condition and OR to a **should**\n\n`Criteria` and their usage are best explained by example (let's assume we have a `Book` entity with a `price` property):\n\n.Get books with a given price\n====\n[source,java]\n----\nCriteria criteria = new Criteria(\"price\").is(42.0);\nQuery query = new CriteriaQuery(criteria);\n----\n====\n\nConditions for the same field can be chained, they will be combined with a logical AND:\n\n.Get books with a given price\n====\n[source,java]\n----\nCriteria criteria = new Criteria(\"price\").greaterThan(42.0).lessThan(34.0);\nQuery query = new CriteriaQuery(criteria);\n----\n====\n\nWhen chaining `Criteria`, by default a AND logic is used:\n\n.Get all persons with first name _James_ and last name _Miller_:\n====\n[source,java]\n----\nCriteria criteria = new Criteria(\"lastname\").is(\"Miller\") <1>\n .and(\"firstname\").is(\"James\") <2>\nQuery query = new CriteriaQuery(criteria);\n----\n\n<1> the first `Criteria`\n<2> the and() creates a new `Criteria` and chaines it to the first one.\n====\n\nIf you want to create nested queries, you need to use subqueries for this.\nLet's assume we want to find all persons with a last name of _Miller_ and a first name of either _Jack_ or _John_:\n\n.Nested subqueries\n====\n[source,java]\n----\nCriteria miller = new Criteria(\"lastName\").is(\"Miller\") <.>\n .subCriteria( <.>\n new Criteria().or(\"firstName\").is(\"John\") <.>\n .or(\"firstName\").is(\"Jack\") <.>\n );\nQuery query = new CriteriaQuery(criteria);\n----\n\n<.> create a first `Criteria` for the last name\n<.> this is combined with AND to a subCriteria\n<.> This sub Criteria is an OR combination for the first name _John_\n<.> and the first name Jack\n====\n\nPlease refer to the API documentation of the `Criteria` class for a complete overview of the different available operations.\n\n[[elasticsearch.operations.stringquery]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "CriteriaQuery", "heading_level": 3, "file_order": 15, "section_index": 4, "content_hash": "86383eebc928a07b06aa60b2f591e798d929ad2867f0e10416ed6e987d3c9800", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:aaed04523a1d01ec6d4fc724b9df0fadb1549d26070386e9f41c53f5da5f7ee7", "content": "This class takes an Elasticsearch query as JSON String.\nThe following code shows a query that searches for persons having the first name \"Jack\":\n\n====\n[source,java]\n----\n\nQuery query = new StringQuery(\"{ \\\"match\\\": { \\\"firstname\\\": { \\\"query\\\": \\\"Jack\\\" } } } \");\nSearchHits<Person> searchHits = operations.search(query, Person.class);\n\n----\n====\n\nUsing `StringQuery` may be appropriate if you already have an Elasticsearch query to use.\n\n[[elasticsearch.operations.nativequery]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "StringQuery", "heading_level": 3, "file_order": 15, "section_index": 5, "content_hash": "aaed04523a1d01ec6d4fc724b9df0fadb1549d26070386e9f41c53f5da5f7ee7", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:2986bec803096134acd4c5a4709ed6df1b239c5be13e2737be97f9eafc41d2db", "content": "`NativeQuery` is the class to use when you have a complex query, or a query that cannot be expressed by using the `Criteria` API, for example when building queries and using aggregates.\nIt allows to use all the different `co.elastic.clients.elasticsearch._types.query_dsl.Query` implementations from the Elasticsearch library therefore named \"native\".\n\nThe following code shows how to search for persons with a given `firstName` and for the found documents have a terms aggregation that counts the number of occurrences of the `lastName` for these persons:\n\n====\n[source,java]\n----\nQuery query = NativeQuery.builder()\n\t.withAggregation(\"lastNames\", Aggregation.of(a -> a\n .terms(ta -> ta.field(\"lastName\").size(10))))\n\t.withQuery(q -> q\n .match(m -> m\n .field(\"firstName\")\n .query(firstName)\n )\n\t)\n\t.withPageable(pageable)\n\t.build();\n\nSearchHits<Person> searchHits = operations.search(query, Person.class);\n----\n====\n\n[[elasticsearch.operations.searchtemplatequery]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "NativeQuery", "heading_level": 3, "file_order": 15, "section_index": 6, "content_hash": "2986bec803096134acd4c5a4709ed6df1b239c5be13e2737be97f9eafc41d2db", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:f3111a55cdc8c454b601d2db7987e8135dfd7268d9dedbf141cefb0c84765b4e", "content": "This is a special implementation of the `Query` interface to be used in combination with a stored search template.\nSee xref:elasticsearch/misc.adoc#elasticsearch.misc.searchtemplates[Search Template support] for further information.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/template.adoc", "title": "template", "heading": "SearchTemplateQuery", "heading_level": 3, "file_order": 15, "section_index": 7, "content_hash": "f3111a55cdc8c454b601d2db7987e8135dfd7268d9dedbf141cefb0c84765b4e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/template.adoc"}}
{"id": "sha256:cbc3063a60fa75fab356d5d365461cfc254df8bce3cface502b40ef2888e296b", "content": "[[preface.versions]]\n\nThe following table shows the Elasticsearch and Spring versions that are used by Spring Data release trains and the version of Spring Data Elasticsearch included in that.\n\n[cols=\"^,^,^,^\",options=\"header\"]\n|===\n| Spring Data Release Train | Spring Data Elasticsearch | Elasticsearch | Spring Framework\n| 2026.0 | 6.1.x | 9.2.5 | 7.0.x\n| 2025.1 | 6.0.x | 9.2.2 | 7.0.x\n| 2025.0 | 5.5.x | 8.18.1 | 6.2.x\n| 2024.1 | 5.4.xfootnote:oom[Out of maintenance] | 8.15.5 | 6.1.x\n| 2024.0 | 5.3.xfootnote:oom[] | 8.13.4 | 6.1.x\n| 2023.1 (Vaughan) | 5.2.xfootnote:oom[] | 8.11.1 | 6.1.x\n| 2023.0 (Ullmann) | 5.1.xfootnote:oom[] | 8.7.1 | 6.0.x\n| 2022.0 (Turing) | 5.0.xfootnote:oom[] | 8.5.3 | 6.0.x\n| 2021.2 (Raj) | 4.4.xfootnote:oom[] | 7.17.3 | 5.3.x\n| 2021.1 (Q) | 4.3.xfootnote:oom[] | 7.15.2 | 5.3.x\n| 2021.0 (Pascal) | 4.2.xfootnote:oom[] | 7.12.0 | 5.3.x\n| 2020.0 (Ockham) | 4.1.xfootnote:oom[] | 7.9.3 | 5.3.2\n| Neumann | 4.0.xfootnote:oom[] | 7.6.2 | 5.2.12\n| Moore | 3.2.xfootnote:oom[] |6.8.12 | 5.2.12\n| Lovelace | 3.1.xfootnote:oom[] | 6.2.2 | 5.1.19\n| Kay | 3.0.xfootnote:oom[] | 5.5.0 | 5.0.13\n| Ingalls | 2.1.xfootnote:oom[] | 2.4.0 | 4.3.25\n|===\n\nSupport for upcoming versions of Elasticsearch is being tracked and general compatibility should be given assuming the usage of the xref:elasticsearch/template.adoc[ElasticsearchOperations interface].", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch/versions.adoc", "title": "versions", "heading": "versions", "heading_level": 1, "file_order": 16, "section_index": 0, "content_hash": "cbc3063a60fa75fab356d5d365461cfc254df8bce3cface502b40ef2888e296b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch/versions.adoc"}}
{"id": "sha256:fe52c1296a0546893af8cc05c6a8e75d38820b2828550bc749cd2c58baa91bde", "content": "[[elasticsearch-migration-guide-3.2-4.0]]\n\nThis section describes breaking changes from version 3.2.x to 4.0.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-3.2-4.0.jackson-removal]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "migration-guide-3.2-4.0", "heading_level": 1, "file_order": 17, "section_index": 0, "content_hash": "fe52c1296a0546893af8cc05c6a8e75d38820b2828550bc749cd2c58baa91bde", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:91b7ce4e3b5b986d454b2e37caaa7b116701cf00a4dd510adeb5636efd211385", "content": "One of the changes in version 4.0.x is that Spring Data Elasticsearch does not use the Jackson Mapper anymore to map an entity to the JSON representation needed for Elasticsearch (see xref:elasticsearch/object-mapping.adoc[Elasticsearch Object Mapping]).\nIn version 3.2.x the Jackson Mapper was the default that was used.\nIt was possible to switch to the meta-model based converter (named `ElasticsearchEntityMapper`) by explicitly configuring it (xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model[Meta Model Object Mapping]).\n\nIn version 4.0.x the meta-model based converter is the only one that is available and does not need to be configured explicitly.\nIf you had a custom configuration to enable the meta-model converter by providing a bean like this:\n\n[source,java]\n----\n@Bean\n@Override\npublic EntityMapper entityMapper() {\n\n ElasticsearchEntityMapper entityMapper = new ElasticsearchEntityMapper(\n elasticsearchMappingContext(), new DefaultConversionService()\n );\n entityMapper.setConversions(elasticsearchCustomConversions());\n\n return entityMapper;\n}\n----\n\nYou now have to remove this bean, the `ElasticsearchEntityMapper` interface has been removed.\n\n.Entity configuration\nSome users had custom Jackson annotations on the entity class, for example in order to define a custom name for the mapped document in Elasticsearch or to configure date conversions.\nThese are not taken into account anymore.\nThe needed functionality is now provided with Spring Data Elasticsearch's `@Field` annotation.\nPlease see xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.annotations[Mapping Annotation Overview] for detailed information.\n\n[[elasticsearch-migration-guide-3.2-4.0.implicit-index-name]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "Removal of the used Jackson Mapper", "heading_level": 2, "file_order": 17, "section_index": 1, "content_hash": "91b7ce4e3b5b986d454b2e37caaa7b116701cf00a4dd510adeb5636efd211385", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:f1895786aae9f010a3f51de4248774514b0398f6005071c7e16d36984065a8f2", "content": "In 3.2.x the different query classes like `IndexQuery` or `SearchQuery` had properties that were taking the index name or index names that they were operating upon.If these were not set, the passed in entity was inspected to retrieve the index name that was set in the `@Document` annotation. +\nIn 4.0.x the index name(s) must now be provided in an additional parameter of type `IndexCoordinates`.By separating this, it now is possible to use one query object against different indices.\n\nSo for example the following code:\n\n[source,java]\n----\nIndexQuery indexQuery = new IndexQueryBuilder()\n .withId(person.getId().toString())\n .withObject(person)\n .build();\n\nString documentId = elasticsearchOperations.index(indexQuery);\n----\n\nmust be changed to:\n\n[source,java]\n----\nIndexCoordinates indexCoordinates = elasticsearchOperations.getIndexCoordinatesFor(person.getClass());\n\nIndexQuery indexQuery = new IndexQueryBuilder()\n .withId(person.getId().toString())\n .withObject(person)\n .build();\n\nString documentId = elasticsearchOperations.index(indexQuery, indexCoordinates);\n----\n\nTo make it easier to work with entities and use the index name that is contained in the entitie's `@Document` annotation, new methods have been added like `DocumentOperations.save(T entity)`;\n\n[[elasticsearch-migration-guide-3.2-4.0.new-operations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "Removal of implicit index name from query objects", "heading_level": 2, "file_order": 17, "section_index": 2, "content_hash": "f1895786aae9f010a3f51de4248774514b0398f6005071c7e16d36984065a8f2", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:3d60e83a181f51d427605c921a2e41e31ba25ddc1aecd4fadac80e5ecac04e58", "content": "In version 3.2 there was the `ElasticsearchOperations` interface that defined all the methods for the `ElasticsearchTemplate` class. In version 4 the functions have been split into different interfaces, aligning these interfaces with the Elasticsearch API:\n\n* `DocumentOperations` are the functions related documents like saving, or deleting\n* `SearchOperations` contains the functions to search in Elasticsearch\n* `IndexOperations` define the functions to operate on indexes, like index creation or mappings creation.\n\n`ElasticsearchOperations` now extends `DocumentOperations` and `SearchOperations` and has methods get access to an `IndexOperations` instance.\n\nNOTE: All the functions from the `ElasticsearchOperations` interface in version 3.2 that are now moved to the `IndexOperations` interface are still available, they are marked as deprecated and have default implementations that delegate to the new implementation:\n\n[source,java]\n----\n/**\n * Create an index for given indexName.\n *\n * @param indexName the name of the index\n * @return {@literal true} if the index was created\n * @deprecated since 4.0, use {@link IndexOperations#create()}\n */\n@Deprecated\ndefault boolean createIndex(String indexName) {\n\treturn indexOps(IndexCoordinates.of(indexName)).create();\n}\n----\n\n[[elasticsearch-migration-guide-3.2-4.0.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "The new Operations interfaces", "heading_level": 2, "file_order": 17, "section_index": 3, "content_hash": "3d60e83a181f51d427605c921a2e41e31ba25ddc1aecd4fadac80e5ecac04e58", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:3cb18187d6dceb3f4442eccb1144ee9fec04420e79e54a18205d73623eeaed54", "content": "[[elasticsearch-migration-guide-3.2-4.0.deprecations.methods-classes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "Deprecations", "heading_level": 2, "file_order": 17, "section_index": 4, "content_hash": "3cb18187d6dceb3f4442eccb1144ee9fec04420e79e54a18205d73623eeaed54", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:4c7cef590a00db5b72b44fb20cd34edc2c13c302ec78518de56b4cb065830745", "content": "Many functions and classes have been deprecated. These functions still work, but the Javadocs show with what they should be replaced.\n\n.Example from ElasticsearchOperations\n[source,java]\n----\n/*\n * Retrieves an object from an index.\n *\n * @param query the query defining the id of the object to get\n * @param clazz the type of the object to be returned\n * @return the found object\n * @deprecated since 4.0, use {@link #get(String, Class, IndexCoordinates)}\n */\n@Deprecated\n@Nullable\n<T> T queryForObject(GetQuery query, Class<T> clazz);\n----\n\n[[elasticsearch-migration-guide-3.2-4.0.deprecations.elasticsearch]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "Methods and classes", "heading_level": 3, "file_order": 17, "section_index": 5, "content_hash": "4c7cef590a00db5b72b44fb20cd34edc2c13c302ec78518de56b4cb065830745", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:f6107667bfbda8b37a6b257f582dfca16edf8c366196538239a6b88788f7ac92", "content": "Since version 7 the Elasticsearch `TransportClient` is deprecated, it will be removed with Elasticsearch version 8. Spring Data Elasticsearch deprecates the `ElasticsearchTemplate` class which uses the `TransportClient` in version 4.0.\n\nMapping types were removed from Elasticsearch 7, they still exist as deprecated values in the Spring Data `@Document` annotation and the `IndexCoordinates` class but they are not used anymore internally.\n\n[[elasticsearch-migration-guide-3.2-4.0.removal]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "Elasticsearch deprecations", "heading_level": 3, "file_order": 17, "section_index": 6, "content_hash": "f6107667bfbda8b37a6b257f582dfca16edf8c366196538239a6b88788f7ac92", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:b0371c6ff5f224cbcb42aa7ee8bc4924ba91b692dbf6f3e18903360db94c713c", "content": "* As already described, the `ElasticsearchEntityMapper` interface has been removed.\n\n* The `SearchQuery` interface has been merged into it's base interface `Query`, so it's occurrences can just be replaced with `Query`.\n\n* The method `org.springframework.data.elasticsearch.core.ElasticsearchOperations.query(SearchQuery query, ResultsExtractor<T> resultsExtractor);` and the `org.springframework.data.elasticsearch.core.ResultsExtractor` interface have been removed.\nThese could be used to parse the result from Elasticsearch for cases in which the response mapping done with the Jackson based mapper was not enough.\nSince version 4.0, there are the new xref:elasticsearch/template.adoc#elasticsearch.operations.searchresulttypes[Search Result Types] to return the information from an Elasticsearch response, so there is no need to expose this low level functionality.\n\n* The low level methods `startScroll`, `continueScroll` and `clearScroll` have been removed from the `ElasticsearchOperations` interface.\nFor low level scroll API access, there now are `searchScrollStart`, `searchScrollContinue` and `searchScrollClear` methods on the `ElasticsearchRestTemplate` class.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc", "title": "migration-guide-3.2-4.0", "heading": "Removals", "heading_level": 2, "file_order": 17, "section_index": 7, "content_hash": "b0371c6ff5f224cbcb42aa7ee8bc4924ba91b692dbf6f3e18903360db94c713c", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-3.2-4.0.adoc"}}
{"id": "sha256:9288e109c953ea25a6e109e17c6cfa6620b7e2ed64e13aabf2f238933e75b59a", "content": "[[elasticsearch-migration-guide-4.0-4.1]]\n\nThis section describes breaking changes from version 4.0.x to 4.1.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-4.0-4.1.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc", "title": "migration-guide-4.0-4.1", "heading": "migration-guide-4.0-4.1", "heading_level": 1, "file_order": 18, "section_index": 0, "content_hash": "9288e109c953ea25a6e109e17c6cfa6620b7e2ed64e13aabf2f238933e75b59a", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc"}}
{"id": "sha256:653f553887c170a6852b89e3f125b13111dd77597f0a34351c8487fd6c92a92a", "content": ".Definition of the id property\nIt is possible to define a property of en entity as the id property by naming it either `id` or `document`.\nThis behaviour is now deprecated and will produce a warning.\nPlease use the `@Id` annotation to mark a property as being the id property.\n\n.Index mappings\nIn the `ReactiveElasticsearchClient.Indices` interface the `updateMapping` methods are deprecated in favour of the `putMapping` methods.\nThey do the same, but `putMapping` is consistent with the naming in the Elasticsearch API:\n\n.Alias handling\nIn the `IndexOperations` interface the methods `addAlias(AliasQuery)`, `removeAlias(AliasQuery)` and `queryForAlias()` have been deprecated.\nThe new methods `alias(AliasAction)`, `getAliases(String...)` and `getAliasesForIndex(String...)` offer more functionality and a cleaner API.\n\n.Parent-ID\nUsage of a parent-id has been removed from Elasticsearch since version 6. We now deprecate the corresponding fields and methods.\n\n[[elasticsearch-migration-guide-4.0-4.1.removal]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc", "title": "migration-guide-4.0-4.1", "heading": "Deprecations", "heading_level": 2, "file_order": 18, "section_index": 1, "content_hash": "653f553887c170a6852b89e3f125b13111dd77597f0a34351c8487fd6c92a92a", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc"}}
{"id": "sha256:7d3406cd31f8537b29c4a248522873a75e3e7917f4a364c8960cd3994f5491cd", "content": ".Type mappings\nThe _type mappings_ parameters of the `@Document` annotation and the `IndexCoordinates` object were removed.\nThey had been deprecated in Spring Data Elasticsearch 4.0 and their values weren't used anymore.\n\n[[elasticsearch-migration-guide-4.0-4.1.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc", "title": "migration-guide-4.0-4.1", "heading": "Removals", "heading_level": 2, "file_order": 18, "section_index": 2, "content_hash": "7d3406cd31f8537b29c4a248522873a75e3e7917f4a364c8960cd3994f5491cd", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc"}}
{"id": "sha256:a9ac6a3458073eab2fd53e94e03fbc77dd33aefc5c3c920dbec4b13a33265ee9", "content": "[[elasticsearch-migration-guide-4.0-4.1.breaking-changes.returntypes-1]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc", "title": "migration-guide-4.0-4.1", "heading": "Breaking Changes", "heading_level": 2, "file_order": 18, "section_index": 3, "content_hash": "a9ac6a3458073eab2fd53e94e03fbc77dd33aefc5c3c920dbec4b13a33265ee9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc"}}
{"id": "sha256:60580d31767bfceb3023258457119d5b180e7f2e2cc12ea75b8a1439b7ec6442", "content": "The methods in the `ReactiveElasticsearchClient.Indices` were not used up to now.\nWith the introduction of the `ReactiveIndexOperations` it became necessary to change some of the return types:\n\n* the `createIndex` variants now return a `Mono<Boolean>` instead of a `Mono<Void>` to signal successful index creation.\n* the `updateMapping` variants now return a `Mono<Boolean>` instead of a `Mono<Void>` to signal successful mappings storage.\n\n[[elasticsearch-migration-guide-4.0-4.1.breaking-changes.returntypes-2]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc", "title": "migration-guide-4.0-4.1", "heading": "Return types of ReactiveElasticsearchClient.Indices methods", "heading_level": 3, "file_order": 18, "section_index": 4, "content_hash": "60580d31767bfceb3023258457119d5b180e7f2e2cc12ea75b8a1439b7ec6442", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc"}}
{"id": "sha256:d3ce2a266fd3a0d371cca5de7d634958491bc2ebaf4b60858083d9c9c6b143f4", "content": "These methods were returning a `List<String>` containing the ids of the new indexed records.\nNow they return a `List<IndexedObjectInformation>`; these objects contain the id and information about optimistic locking (seq_no and primary_term)", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc", "title": "migration-guide-4.0-4.1", "heading": "Return types of DocumentOperations.bulkIndex methods", "heading_level": 3, "file_order": 18, "section_index": 5, "content_hash": "d3ce2a266fd3a0d371cca5de7d634958491bc2ebaf4b60858083d9c9c6b143f4", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.0-4.1.adoc"}}
{"id": "sha256:c85c9587b3fb71f4d741354b8bc91d27bfea422750b60809abbe76671f03af28", "content": "[[elasticsearch-migration-guide-4.1-4.2]]\n\nThis section describes breaking changes from version 4.1.x to 4.2.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-4.1-4.2.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "migration-guide-4.1-4.2", "heading_level": 1, "file_order": 19, "section_index": 0, "content_hash": "c85c9587b3fb71f4d741354b8bc91d27bfea422750b60809abbe76671f03af28", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:0e6d80e97aa976f0fcefbd8db7a6b4334252f9cac6b3a11f2861439f3d0c70a9", "content": "[[elasticsearch-migration-guide-4.1-4.2.deprecations.document]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "Deprecations", "heading_level": 2, "file_order": 19, "section_index": 1, "content_hash": "0e6d80e97aa976f0fcefbd8db7a6b4334252f9cac6b3a11f2861439f3d0c70a9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:0f8813a6c4b154e9f051a9876361cca78a53754e5679ed317bde0407a86e9aaa", "content": "The parameters of the `@Document` annotation that are relevant for the index settings (`useServerConfiguration`, `shards`. `replicas`, `refreshIntervall` and `indexStoretype`) have been moved to the `@Setting` annotation. Use in `@Document` is still possible but deprecated.\n\n[[elasticsearch-migration-guide-4.1-4.2.removal]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "@Document parameters", "heading_level": 3, "file_order": 19, "section_index": 2, "content_hash": "0f8813a6c4b154e9f051a9876361cca78a53754e5679ed317bde0407a86e9aaa", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:0c14937a960d322e1635dcf449bdad55870ab4f23f5e83b7b9809b82e26f4514", "content": "The `@Score` annotation that was used to set the score return value in an entity was deprecated in version 4.0 and has been removed.\nScore values are returned in the `SearchHit` instances that encapsulate the returned entities.\n\nThe `org.springframework.data.elasticsearch.ElasticsearchException` class has been removed.\nThe remaining usages have been replaced with `org.springframework.data.mapping.MappingException` and `org.springframework.dao.InvalidDataAccessApiUsageException`.\n\nThe deprecated `ScoredPage`, `ScrolledPage` `@AggregatedPage` and implementations has been removed.\n\nThe deprecated `GetQuery` and `DeleteQuery` have been removed.\n\nThe deprecated `find` methods from `ReactiveSearchOperations` and `ReactiveDocumentOperations` have been removed.\n\n[[elasticsearch-migration-guide-4.1-4.2.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "Removals", "heading_level": 2, "file_order": 19, "section_index": 3, "content_hash": "0c14937a960d322e1635dcf449bdad55870ab4f23f5e83b7b9809b82e26f4514", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:58e960beeb482ee2641f336f0c073cf3aeff2bddec8d67d7b1d586796e773353", "content": "[[elasticsearch-migration-guide-4.1-4.2.breaking-changes.refresh-policy]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "Breaking Changes", "heading_level": 2, "file_order": 19, "section_index": 4, "content_hash": "58e960beeb482ee2641f336f0c073cf3aeff2bddec8d67d7b1d586796e773353", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:3d15e16e1674e2988306698bfff8b53e745433ace1e419477a06c663d55c55d5", "content": "[[elasticsearch-migration-guide-4.1-4.2.breaking-changes.refresh-policy.enum]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "RefreshPolicy", "heading_level": 3, "file_order": 19, "section_index": 5, "content_hash": "3d15e16e1674e2988306698bfff8b53e745433ace1e419477a06c663d55c55d5", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:917fa314177c9f138d812bf8887d2d7d57e7c87e2014787a2efd3211cb193a2d", "content": "It was possible in 4.1 to configure the refresh policy for the `ReactiveElasticsearchTemplate` by overriding the method `AbstractReactiveElasticsearchConfiguration.refreshPolicy()` in a custom configuration class.\nThe return value of this method was an instance of the class `org.elasticsearch.action.support.WriteRequest.RefreshPolicy`.\n\nNow the configuration must return `org.springframework.data.elasticsearch.core.RefreshPolicy`.\nThis enum has the same values and triggers the same behaviour as before, so only the `import` statement has to be adjusted.\n\n[[elasticsearch-migration-guide-4.1-4.2.breaking-changes.refresh-policy.behaviour]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "Enum package changed", "heading_level": 4, "file_order": 19, "section_index": 6, "content_hash": "917fa314177c9f138d812bf8887d2d7d57e7c87e2014787a2efd3211cb193a2d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:e6ea6728fb27abb80289413eef3e71b093e6d82b0b1255ba94dc193e57ad809f", "content": "`ElasticsearchOperations` and `ReactiveElasticsearchOperations` now explicitly use the `RefreshPolicy` set on the template for write requests if not null.\nIf the refresh policy is null, then nothing special is done, so the cluster defaults are used. `ElasticsearchOperations` was always using the cluster default before this version.\n\nThe provided implementations for `ElasticsearchRepository` and `ReactiveElasticsearchRepository` will do an explicit refresh when the refresh policy is null.\nThis is the same behaviour as in previous versions.\nIf a refresh policy is set, then it will be used by the repositories as well.\n\n[[elasticsearch-migration-guide-4.1-4.2.breaking-changes.refresh-policy.configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "Refresh behaviour", "heading_level": 4, "file_order": 19, "section_index": 7, "content_hash": "e6ea6728fb27abb80289413eef3e71b093e6d82b0b1255ba94dc193e57ad809f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:5336340953fc8095da745d70bf0f6acd3e46461fd4b21208368c284bca71f8df", "content": "When configuring Spring Data Elasticsearch like described in xref:elasticsearch/clients.adoc[Elasticsearch Clients] by using `ElasticsearchConfigurationSupport`, `AbstractElasticsearchConfiguration` or `AbstractReactiveElasticsearchConfiguration` the refresh policy will be initialized to `null`.\nPreviously the reactive code initialized this to `IMMEDIATE`, now reactive and non-reactive code show the same behaviour.\n\n[[elasticsearch-migration-guide-4.1-4.2.breaking-changes.method-return-types]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "Refresh configuration", "heading_level": 4, "file_order": 19, "section_index": 8, "content_hash": "5336340953fc8095da745d70bf0f6acd3e46461fd4b21208368c284bca71f8df", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:8e3a17d3ddb7f6009cc53d28e2d179c2b2d401986bea254389541a6a9faa8b96", "content": "[[elasticsearch-migration-guide-4.1-4.2.breaking-changes.method-return-types.delete]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "Method return types", "heading_level": 3, "file_order": 19, "section_index": 9, "content_hash": "8e3a17d3ddb7f6009cc53d28e2d179c2b2d401986bea254389541a6a9faa8b96", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:d7fe2161e3d7e90a822264d5166f4c6ddcf4f7eefe4c09f13382ad7a5855ba1c", "content": "The reactive methods previously returned a `Mono<Long>` with the number of deleted documents, the non reactive versions were void. They now return a `Mono<ByQueryResponse>` which contains much more detailed information about the deleted documents and errors that might have occurred.\n\n[[elasticsearch-migration-guide-4.1-4.2.breaking-changes.method-return-types.multiget]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "delete methods that take a Query", "heading_level": 4, "file_order": 19, "section_index": 10, "content_hash": "d7fe2161e3d7e90a822264d5166f4c6ddcf4f7eefe4c09f13382ad7a5855ba1c", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:b98183f92fc0882af9aa66d12a53276b4fcc1ca3f347ef9f7615e811911102bf", "content": "The implementations of _multiget_ previousl only returned the found entities in a `List<T>` for non-reactive implementations and in a `Flux<T>` for reactive implementations. If the request contained ids that were not found, the information that these are missing was not available. The user needed to compare the returned ids to the requested ones to find\nwhich ones were missing.\n\nNow the `multiget` methods return a `MultiGetItem` for every requested id. This contains information about failures (like non existing indices) and the information if the item existed (then it is contained in the `MultiGetItem) or not.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc", "title": "migration-guide-4.1-4.2", "heading": "multiget methods", "heading_level": 4, "file_order": 19, "section_index": 11, "content_hash": "b98183f92fc0882af9aa66d12a53276b4fcc1ca3f347ef9f7615e811911102bf", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.1-4.2.adoc"}}
{"id": "sha256:5649df08af8a074134cf723e0a460f8d443319eae0c794e960d15369eb8b01a6", "content": "[[elasticsearch-migration-guide-4.2-4.3]]\n\nThis section describes breaking changes from version 4.2.x to 4.3.x and how removed features can be replaced by new introduced features.\n\n[NOTE]\n====\nElasticsearch is working on a new Client that will replace the `RestHighLevelClient` because the `RestHighLevelClient` uses code from Elasticsearch core libraries which are not Apache 2 licensed anymore.\nSpring Data Elasticsearch is preparing for this change as well.\nThis means that internally the implementations for the `*Operations` interfaces need to change - which should be no problem if users program against the interfaces like `ElasticsearchOperations` or `ReactiveElasticsearchOperations`.\nIf you are using the implementation classes like `ElasticsearchRestTemplate` directly, you will need to adapt to these changes.\n\nSpring Data Elasticsearch also removes or replaces the use of classes from the `org.elasticsearch` packages in it's API classes and methods, only using them in the implementation where the access to Elasticsearch is implemented.\nFor the user that means, that some enum classes that were used are replaced by enums that live in `org.springframework.data.elasticsearch` with the same values, these are internally mapped onto the Elasticsearch ones.\n\nPlaces where classes are used that cannot easily be replaced, this usage is marked as deprecated, we are working on replacements.\n\nCheck the sections on xref:migration-guides/migration-guide-4.2-4.3.adoc#elasticsearch-migration-guide-4.2-4.3.deprecations[Deprecations] and xref:migration-guides/migration-guide-4.2-4.3.adoc#elasticsearch-migration-guide-4.2-4.3.breaking-changes[Breaking Changes] for further details.\n====\n\n[[elasticsearch-migration-guide-4.2-4.3.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "migration-guide-4.2-4.3", "heading_level": 1, "file_order": 20, "section_index": 0, "content_hash": "5649df08af8a074134cf723e0a460f8d443319eae0c794e960d15369eb8b01a6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:f670092ae606cfdc121ca129d01f3b0b6ad89cb8029d24a970d33182912240c7", "content": "[[elasticsearch-migration-guide-4.2-4.3.deprecations.suggest]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "Deprecations", "heading_level": 2, "file_order": 20, "section_index": 1, "content_hash": "f670092ae606cfdc121ca129d01f3b0b6ad89cb8029d24a970d33182912240c7", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:fc0bfa8b031d04b28a758e3d94d10e66daef128f26702521eb09e07f3638452d", "content": "In `SearchOperations`, and so in `ElasticsearchOperations` as well, the `suggest` methods taking a `org.elasticsearch.search.suggest.SuggestBuilder` as argument and returning a `org.elasticsearch.action.search.SearchResponse` have been deprecated.\nUse `SearchHits<T> search(Query query, Class<T> clazz)` instead, passing in a `NativeSearchQuery` which can contain a `SuggestBuilder` and read the suggest results from the returned `SearchHit<T>`.\n\nIn `ReactiveSearchOperations` the new `suggest` methods return a `Mono<org.springframework.data.elasticsearch.core.suggest.response.Suggest>` now.\nHere as well the old methods are deprecated.\n\n[[elasticsearch-migration-guide-4.2-4.3.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "suggest methods", "heading_level": 3, "file_order": 20, "section_index": 2, "content_hash": "fc0bfa8b031d04b28a758e3d94d10e66daef128f26702521eb09e07f3638452d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:2da823d281002b24ac5ea6b23dec0677b9b0513247e56087586684515407c15b", "content": "[[elasticsearch-migration-guide-4.2-4.3.breaking-changes.1]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "Breaking Changes", "heading_level": 2, "file_order": 20, "section_index": 3, "content_hash": "2da823d281002b24ac5ea6b23dec0677b9b0513247e56087586684515407c15b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:bde90350d67140da311b62ba521ed56fc465fb7d708ea2a5fdb8b17e472cdd7e", "content": "* In the `org.springframework.data.elasticsearch.annotations.CompletionContext` annotation the property `type()` has changed from `org.elasticsearch.search.suggest.completion.context.ContextMapping.Type` to `org.springframework.data.elasticsearch.annotations.CompletionContext.ContextMappingType`, the available enum values are the same.\n* In the `org.springframework.data.elasticsearch.annotations.Document` annotation the `versionType()` property has changed to `org.springframework.data.elasticsearch.annotations.Document.VersionType`, the available enum values are the same.\n* In the `org.springframework.data.elasticsearch.core.query.Query` interface the `searchType()` property has changed to `org.springframework.data.elasticsearch.core.query.Query.SearchType`, the available enum values are the same.\n* In the `org.springframework.data.elasticsearch.core.query.Query` interface the return value of `timeout()` was changed to `java.time.Duration`.\n* The `SearchHits<T>`class does not contain the `org.elasticsearch.search.aggregations.Aggregations` anymore.\nInstead it now contains an instance of the `org.springframework.data.elasticsearch.core.AggregationsContainer<T>` class where `T` is the concrete aggregations type from the underlying client that is used.\nCurrently this will be a `org\n.springframework.data.elasticsearch.core.clients.elasticsearch7.ElasticsearchAggregations` object; later different implementations will be available.\nThe same change has been done to the `ReactiveSearchOperations.aggregate()` functions, the now return a `Flux<AggregationContainer<?>>`.\nPrograms using the aggregations need to be changed to cast the returned value to the appropriate class to further proces it.\n* methods that might have thrown a `org.elasticsearch.ElasticsearchStatusException` now will throw `org.springframework.data.elasticsearch.RestStatusException` instead.\n\n[[elasticsearch-migration-guide-4.2-4.3.breaking-changes.2]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "Removal of `org.elasticsearch` classes from the API.", "heading_level": 3, "file_order": 20, "section_index": 4, "content_hash": "bde90350d67140da311b62ba521ed56fc465fb7d708ea2a5fdb8b17e472cdd7e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:91adea6ac32341975a0897e1b7682af5bcda17fd46e9d87d458cec0dd66a4f14", "content": "Up to version 4.2 the `fields` property of a `Query` was interpreted and added to the include list of the `sourceFilter`.\nThis was not correct, as these are different things for Elasticsearch.\nThis has been corrected.\nAs a consequence code might not work anymore that relies on using `fields` to specify which fields should be returned from the document's `_source' and should be changed to use the `sourceFilter`.\n\n[[elasticsearch-migration-guide-4.2-4.3.breaking-changes.3]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "Handling of field and sourceFilter properties of Query", "heading_level": 3, "file_order": 20, "section_index": 5, "content_hash": "91adea6ac32341975a0897e1b7682af5bcda17fd46e9d87d458cec0dd66a4f14", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:e86adfff803644ff70c6884ab4ea897f6357dc02f4e452afaad0a54e3f7d5510", "content": "The default value for the `search_type` in Elasticsearch is `query_then_fetch`.\nThis now is also set as default value in the `Query` implementations, it was previously set to `dfs_query_then_fetch`.\n\n[[elasticsearch-migration-guide-4.2-4.3.breaking-changes.4]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "search_type default value", "heading_level": 3, "file_order": 20, "section_index": 6, "content_hash": "e86adfff803644ff70c6884ab4ea897f6357dc02f4e452afaad0a54e3f7d5510", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:0dfbc8a9a74cc6160d9e75f8f7b2f69ad1b022bc0ab38782e353e0dae8497862", "content": "Some properties of the `org.springframework.data.elasticsearch.core.query.BulkOptions` class have changed their type:\n\n* the type of the `timeout` property has been changed to `java.time.Duration`.\n* the type of the`refreshPolicy` property has been changed to `org.springframework.data.elasticsearch.core.RefreshPolicy`.\n\n[[elasticsearch-migration-guide-4.2-4.3.breaking-changes.5]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "BulkOptions changes", "heading_level": 3, "file_order": 20, "section_index": 7, "content_hash": "0dfbc8a9a74cc6160d9e75f8f7b2f69ad1b022bc0ab38782e353e0dae8497862", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:b1318e12059835fe81be6adfcb6e6e886b599240e3a017d56b1c823b9fad3477", "content": "Spring Data Elasticsearch now uses `org.springframework.data.elasticsearch.core.query.IndicesOptions` instead of `org.elasticsearch.action.support.IndicesOptions`.\n\n[[elasticsearch-migration-guide-4.2-4.3.breaking-changes.6]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "IndicesOptions change", "heading_level": 3, "file_order": 20, "section_index": 8, "content_hash": "b1318e12059835fe81be6adfcb6e6e886b599240e3a017d56b1c823b9fad3477", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:2b419ce3d30d2cd226f02aa668dcdea9973eb012c43cd2394b7b5a5a18c7fdb6", "content": "The classes from the package `org.springframework.data.elasticsearch.core.completion` have been moved to `org.springframework.data.elasticsearch.core.suggest`.\n\n[[elasticsearch-migration-guide-4.2-4.3.breaking-changes.7]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "Completion classes", "heading_level": 3, "file_order": 20, "section_index": 9, "content_hash": "2b419ce3d30d2cd226f02aa668dcdea9973eb012c43cd2394b7b5a5a18c7fdb6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:75288a1da4d81b4649865dbb99fd7e1e10bcf8417fd97eee144e342ceac1914d", "content": "The `org.springframework.data.elasticsearch.core.mapping.ElasticsearchPersistentPropertyConverter` interface has been renamed to `org.springframework.data.elasticsearch.core.mapping.PropertyValueConverter`.\nLikewise the implementations classes named _XXPersistentPropertyConverter_ have been renamed to _XXPropertyValueConverter_.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc", "title": "migration-guide-4.2-4.3", "heading": "Other renamings", "heading_level": 3, "file_order": 20, "section_index": 10, "content_hash": "75288a1da4d81b4649865dbb99fd7e1e10bcf8417fd97eee144e342ceac1914d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.2-4.3.adoc"}}
{"id": "sha256:4c8abd4748e0638cec18f5bf8fec387709265adf1124ea6d41dc1555491927ec", "content": "[[elasticsearch-migration-guide-4.3-4.4]]\n\nThis section describes breaking changes from version 4.3.x to 4.4.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-4.3-4.4.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "migration-guide-4.3-4.4", "heading_level": 1, "file_order": 21, "section_index": 0, "content_hash": "4c8abd4748e0638cec18f5bf8fec387709265adf1124ea6d41dc1555491927ec", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:238fba3fd4afc0fd5c5123055dcf176025c881b755d31a59d8de23f864a33d9a", "content": "[[elasticsearch-migration-guide-4.3-4.4.deprecations.reactive-operations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Deprecations", "heading_level": 2, "file_order": 21, "section_index": 1, "content_hash": "238fba3fd4afc0fd5c5123055dcf176025c881b755d31a59d8de23f864a33d9a", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:846ffba4adafc343988015c00c02f784563510eaa6b76d8165ed44a277888ace", "content": "The method `<T> Publisher<T> execute(ClientCallback<Publisher<T>> callback)` has been deprecated.\nAs there now are multiple implementations using different client libraries the `execute` method is still available in the different implementations, but there is no more method in the interface, because there is no common callback interface for the different clients.\n\n[[elasticsearch-migration-guide-4.3-4.4.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "org.springframework.data.elasticsearch.core.ReactiveElasticsearchOperations", "heading_level": 3, "file_order": 21, "section_index": 2, "content_hash": "846ffba4adafc343988015c00c02f784563510eaa6b76d8165ed44a277888ace", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:04b60f03ecc5e59cbb6a70af22d8d80f95896b7b956dbac2100cbd29a55afb02", "content": "[[elasticsearch-migration-guide-4.3-4.4.breaking-changes.1]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Breaking Changes", "heading_level": 2, "file_order": 21, "section_index": 3, "content_hash": "04b60f03ecc5e59cbb6a70af22d8d80f95896b7b956dbac2100cbd29a55afb02", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:1ea4ac73eccf81ab55329392a2ae0261de5eb7cb95b36b32623b55b3de0ddd10", "content": "[[org-springframework-data-elasticsearch-core-elasticsearchtemplate-has-been-removed]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Removal of deprecated classes", "heading_level": 3, "file_order": 21, "section_index": 4, "content_hash": "1ea4ac73eccf81ab55329392a2ae0261de5eb7cb95b36b32623b55b3de0ddd10", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:85e78aa35abf4445028cc58a4155339982e43d8369739e184485abafd9bef241", "content": "As of version 4.4 Spring Data Elasticsearch does not use the `TransportClient` from Elasticsearch anymore (which itself is deprecated since Elasticsearch 7.0).\nThis means that the `org.springframework.data.elasticsearch.core.ElasticsearchTemplate` class which was deprecated since Spring Data Elasticsearch 4.0 has been removed.\nThis was the implementation of the `ElasticsearchOperations` interface that was using the `TransportClient`.\nConnections to Elasticsearch must be made using either the imperative `ElasticsearchRestTemplate` or the reactive `ReactiveElasticsearchTemplate`.\n\n[[elasticsearch-migration-guide-4.3-4.4.breaking-changes.2]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "`org.springframework.data.elasticsearch.core.ElasticsearchTemplate` has been removed", "heading_level": 4, "file_order": 21, "section_index": 5, "content_hash": "85e78aa35abf4445028cc58a4155339982e43d8369739e184485abafd9bef241", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:e2a6e395162beeb05db92718189a20c45a5adfbc542ac30662b3b9a50fdbaf9e", "content": "In 4.3 two classes (`ElasticsearchAggregations` and `ElasticsearchAggregation`) had been moved to the `org.springframework.data.elasticsearch.core.clients.elasticsearch7` package in preparation for the integration of the new Elasticsearch client.\nThe were moved back to the `org.springframework.data.elasticsearch.core` package as we keep the classes use the old Elasticsearch client where they were.\n\n[[elasticsearch-migration-guide-4.3-4.4.breaking-changes.3]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Package changes", "heading_level": 3, "file_order": 21, "section_index": 6, "content_hash": "e2a6e395162beeb05db92718189a20c45a5adfbc542ac30662b3b9a50fdbaf9e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:9a5c5c5cc1b4db6573c953ab946a91c4c479d4d1a0c995e0ddf5058b1c3ae6ce", "content": "The `ReactiveElasticsearchTemplate`, when created directly or by Spring Boot configuration had a default refresh policy of IMMEDIATE.\nThis could cause performance issues on heavy indexing and was different than the default behaviour of Elasticsearch.\nThis has been changed to that now the default refresh policy is NONE.\nWhen the\n`ReactiveElasticsearchTemplate` was provided by using the configuration like described in xref:elasticsearch/clients.adoc#elasticsearch.clients.reactiverestclient[Reactive REST Client] the default refresh policy already was set to NONE.\n\n[[elasticsearch-migration-guide-4.3-4.4.new-clients]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Behaviour change", "heading_level": 3, "file_order": 21, "section_index": 7, "content_hash": "9a5c5c5cc1b4db6573c953ab946a91c4c479d4d1a0c995e0ddf5058b1c3ae6ce", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:367f930a7376604a236fb9652c883e27e9832f25cc0a27016f226d953d61b650", "content": "Elasticsearch has introduced it's new `ElasticsearchClient` and has deprecated the previous `RestHighLevelClient`.\nSpring Data Elasticsearch 4.4 still uses the old client as the default client for the following reasons:\n\n* The new client forces applications to use the `jakarta.json.spi.JsonProvider` package whereas Spring Boot will stick to `javax.json.spi.JsonProvider` until version 3. So switching the default implementaiton in Spring Data Elasticsearch can only come with Spring Data Elasticsearch 5 (Spring Data 3, Spring 6).\n* There are still some bugs in the Elasticsearch client which need to be resolved\n* The implementation using the new client in Spring Data Elasticsearch is not yet complete, due to limited resources working on that - remember Spring Data Elasticsearch is a community driven project that lives from public contributions.\n\n[[elasticsearch-migration-guide-4.3-4.4.new-clients.how-to]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "New Elasticsearch client", "heading_level": 2, "file_order": 21, "section_index": 8, "content_hash": "367f930a7376604a236fb9652c883e27e9832f25cc0a27016f226d953d61b650", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:9cd122ce5ee362d46f8d5cf6891ab9dd43107a14aa53bbecc9754e13020710f1", "content": "CAUTION: The implementation using the new client is not complete, some operations will throw a `java.lang.UnsupportedOperationException` or might throw NPE (for example when the Elasticsearch cannot parse a response from the server, this still happens sometimes) +\nUse the new client to test the implementations but do not use it in productive code yet!\n\nIn order to try and use the new client the following steps are necessary:\n\n[[elasticsearch-migration-guide-4.3-4.4.new-clients.how-to.not]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "How to use the new client", "heading_level": 3, "file_order": 21, "section_index": 9, "content_hash": "9cd122ce5ee362d46f8d5cf6891ab9dd43107a14aa53bbecc9754e13020710f1", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:a8c47a7a4460a6ba0c2a7681454460f377b84e0c89a67ddcc6aa83ea40b2c0b6", "content": "If using Spring Boot, exclude Spring Data Elasticsearch from the autoconfiguration\n\n====\n[source,java]\n----\n@SpringBootApplication(exclude = ElasticsearchDataAutoConfiguration.class)\npublic class SpringdataElasticTestApplication {\n\t// ...\n}\n\n----\n====\n\nRemove Spring Data Elasticsearch related properties from your application configuration.\nIf Spring Data Elasticsearch was configured using a programmatic configuration (see xref:elasticsearch/clients.adoc[Elasticsearch Clients]), remove these beans from the Spring application context.\n\n[[elasticsearch-migration-guide-4.3-4.4.new-clients.how-to.dependencies]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Make sure not to configure the existing default client", "heading_level": 4, "file_order": 21, "section_index": 10, "content_hash": "a8c47a7a4460a6ba0c2a7681454460f377b84e0c89a67ddcc6aa83ea40b2c0b6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:e77677b603d74ba2681659edc1887b93a04caa8d705b3571e8987a967d2588d6", "content": "The dependencies for the new Elasticsearch client are still optional in Spring Data Elasticsearch so they need to be added explicitly:\n\n====\n[source,xml]\n----\n<dependencies>\n <dependency>\n <groupId>co.elastic.clients</groupId>\n <artifactId>elasticsearch-java</artifactId>\n <version>7.17.3</version>\n <exclusions>\n <exclusion>\n <groupId>commons-logging</groupId>\n <artifactId>commons-logging</artifactId>\n </exclusion>\n </exclusions>\n </dependency>\n <dependency>\n <groupId>org.elasticsearch.client</groupId>\n <artifactId>elasticsearch-rest-client</artifactId> <!-- is Apache 2-->\n <version>7.17.3</version>\n <exclusions>\n <exclusion>\n <groupId>commons-logging</groupId>\n <artifactId>commons-logging</artifactId>\n </exclusion>\n </exclusions>\n </dependency>\n</dependencies>\n----\n====\n\nWhen using Spring Boot, it is necessary to set the following property in the _pom.xml_.\n\n====\n[source,xml]\n----\n<properties>\n <jakarta-json.version>2.0.1</jakarta-json.version>\n</properties>\n----\n====\n\n[[elasticsearch-migration-guide-4.3-4.4.new-clients.how-to.configuration]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Add dependencies", "heading_level": 4, "file_order": 21, "section_index": 11, "content_hash": "e77677b603d74ba2681659edc1887b93a04caa8d705b3571e8987a967d2588d6", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:44782e47b3807f05a6916326f0eeab8abe352fc0a6d798f78b0d0fc1747c707b", "content": "[[elasticsearch-migration-guide-4.3-4.4.new-clients.how-to.configuration.imperative]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "New configuration classes", "heading_level": 4, "file_order": 21, "section_index": 12, "content_hash": "44782e47b3807f05a6916326f0eeab8abe352fc0a6d798f78b0d0fc1747c707b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:a71b6eb258a9f253f3ce106a31bb308e909b0f01f6e3401dbb940e855ae7d81b", "content": "In order configure Spring Data Elasticsearch to use the new client, it is necessary to create a configuration bean that derives from `org.springframework.data.elasticsearch.client.elc.ElasticsearchConfiguration`:\n\n====\n[source,java]\n----\n@Configuration\npublic class NewRestClientConfig extends ElasticsearchConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() //\n .connectedTo(\"localhost:9200\") //\n .build();\n\t}\n}\n----\n====\n\nThe configuration is done in the same way as with the old client, but it is not necessary anymore to create more than the configuration bean.\nWith this configuration, the following beans will be available in the Spring application context:\n\n* a `RestClient` bean, that is the configured low level `RestClient` that is used by the Elasticsearch client\n* an `ElasticsearchClient` bean, this is the new client that uses the `RestClient`\n* an `ElasticsearchOperations` bean, available with the bean names _elasticsearchOperations_ and _elasticsearchTemplate_, this uses the `ElasticsearchClient`\n\n[[elasticsearch-migration-guide-4.3-4.4.new-clients.how-to.configuration.reactive]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Imperative style", "heading_level": 5, "file_order": 21, "section_index": 13, "content_hash": "a71b6eb258a9f253f3ce106a31bb308e909b0f01f6e3401dbb940e855ae7d81b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:0bdcbd194a9a068ff5ddc9a1f75a107b0ee504479c89fcbae02e3c104f7573dd", "content": "To use the new client in a reactive environment the only difference is the class from which to derive the configuration:\n\n====\n[source,java]\n----\n@Configuration\npublic class NewRestClientConfig extends ReactiveElasticsearchConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() //\n .connectedTo(\"localhost:9200\") //\n .build();\n\t}\n}\n----\n====\n\nWith this configuration, the following beans will be available in the Spring application context:\n\n* a `RestClient` bean, that is the configured low level `RestClient` that is used by the Elasticsearch client\n* an `ReactiveElasticsearchClient` bean, this is the new reactive client that uses the `RestClient`\n* an `ReactiveElasticsearchOperations` bean, available with the bean names _reactiveElasticsearchOperations_ and _reactiveElasticsearchTemplate_, this uses the `ReactiveElasticsearchClient`", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc", "title": "migration-guide-4.3-4.4", "heading": "Reactive style", "heading_level": 5, "file_order": 21, "section_index": 14, "content_hash": "0bdcbd194a9a068ff5ddc9a1f75a107b0ee504479c89fcbae02e3c104f7573dd", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.3-4.4.adoc"}}
{"id": "sha256:8f88b3b737a2e0d4e4debb88c59e1aa0456260cae1790a817e61b112f247c4dd", "content": "[[elasticsearch-migration-guide-4.4-5.0]]\n\nThis section describes breaking changes from version 4.4.x to 5.0.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-4.4-4.5.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "migration-guide-4.4-5.0", "heading_level": 1, "file_order": 22, "section_index": 0, "content_hash": "8f88b3b737a2e0d4e4debb88c59e1aa0456260cae1790a817e61b112f247c4dd", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:1c5fa90db787ec5743d763af6ac87981abdd2c04cf14bbdb4f14fa10da6cfc05", "content": "[[custom-trace-level-logging]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Deprecations", "heading_level": 2, "file_order": 22, "section_index": 1, "content_hash": "1c5fa90db787ec5743d763af6ac87981abdd2c04cf14bbdb4f14fa10da6cfc05", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:aa4947dbeaca8cee391ccdd78780390579beca7a640b7681f880d743047844eb", "content": "Logging by setting the property `logging.level.org.springframework.data.elasticsearch.client.WIRE=trace` is deprecated now, the Elasticsearch `RestClient` provides a better solution that can be activated by setting the logging level of the `tracer` package to \"trace\".\n\n[[elasticsearch-migration-guide-4.4-4.5.deprecations.package]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Custom trace level logging", "heading_level": 3, "file_order": 22, "section_index": 2, "content_hash": "aa4947dbeaca8cee391ccdd78780390579beca7a640b7681f880d743047844eb", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:bd83833dac84a72fd6a99f3a07a40ef0644b694c82e40c03ccf0cc1c8e756d7b", "content": "See xref:migration-guides/migration-guide-4.4-5.0.adoc#elasticsearch-migration-guide-4.4-5.0.breaking-changes-packages[Package changes], all classes in this package have been deprecated, as the default client implementations to use are the ones based on the new Java Client from Elasticsearch, see xref:migration-guides/migration-guide-4.4-5.0.adoc#elasticsearch-migration-guide-4.4-5.0.new-clients[New Elasticsearch client]\n\n[[elasticsearch-migration-guide-4.4-4.5.deprecations.code]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "`org.springframework.data.elasticsearch.client.erhlc` package", "heading_level": 3, "file_order": 22, "section_index": 3, "content_hash": "bd83833dac84a72fd6a99f3a07a40ef0644b694c82e40c03ccf0cc1c8e756d7b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:577891a8c6e78013499fc73eaddcdbd08c2f6ed9d6768164eafc1bf2373d5da0", "content": "`DateFormat.none` and `DateFormat.custom` had been deprecated since version 4.2 and have been removed.\n\nThe properties of `@Document` that were deprecated since 4.2 have been removed.\nUse the `@Settings` annotation for these.\n\n`@DynamicMapping` and `@DynamicMappingValue` have been removed.\nUse `@Document.dynamic` or `@Field.dynamic` instead.\n\n[[elasticsearch-migration-guide-4.4-5.0.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Removal of deprecated code", "heading_level": 3, "file_order": 22, "section_index": 4, "content_hash": "577891a8c6e78013499fc73eaddcdbd08c2f6ed9d6768164eafc1bf2373d5da0", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:58b328da764849acb10b101c454ff66a1da7f2ebbaa3fcd952eed70de377f00b", "content": "[[elasticsearch-migration-guide-4.4-5.0.breaking-changes.deprecated-calls]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Breaking Changes", "heading_level": 2, "file_order": 22, "section_index": 5, "content_hash": "58b328da764849acb10b101c454ff66a1da7f2ebbaa3fcd952eed70de377f00b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:103935527ffbff2f6220d20cac01d5bfb158514cca3600c2a61f333e320c07d1", "content": "[[elasticsearch-migration-guide-4.4-5.0.breaking-changes.deprecated-calls.1]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Removal of deprecated calls", "heading_level": 3, "file_order": 22, "section_index": 6, "content_hash": "103935527ffbff2f6220d20cac01d5bfb158514cca3600c2a61f333e320c07d1", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:45cb7066c5c0e926739e1a0acaf1b4d6af239d0a60987f8f15c8f78bd41e49da", "content": "Both `SearchOperations` and `ReactiveSearchOperations` had deprecated calls that were using Elasticsearch classes as parameters.\nThese now have been removed and so the dependency on Elasticsearch classes in these APIs has been cleaned.\n\n[[elasticsearch-migration-guide-4.4-5.0.breaking-changes-packages]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "suggest calls in operations interfaces have been removed", "heading_level": 4, "file_order": 22, "section_index": 7, "content_hash": "45cb7066c5c0e926739e1a0acaf1b4d6af239d0a60987f8f15c8f78bd41e49da", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:1fbf26c4beabd94c2b493b31e990da5b419b8f6b2ae853feee149861a0616ec1", "content": "All the classes that are using or depend on the deprecated Elasticsearch `RestHighLevelClient` have been moved to the package `org.springframework.data.elasticsearch.client.erhlc`.\nBy this change we now have a clear separation of code using the old deprecated Elasticsearch libraries, code using the new Elasticsearch client and code that is independent of the client implementation.\nAlso the reactive implementation that was provided up to now has been moved here, as this implementation contains code that was copied and adapted from Elasticsearch libraries.\n\nIf you are using `ElasticsearchRestTemplate` directly and not the `ElasticsearchOperations` interface you'll need to adjust your imports as well.\n\nWhen working with the `NativeSearchQuery` class, you'll need to switch to the `NativeQuery` class, which can take a\n`Query` instance coming from the new Elasticsearch client libraries.\nYou'll find plenty of examples in the test code.\n\n[[elasticsearch-migration-guide-4.4-5.0.breaking-changes-records]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Package changes", "heading_level": 3, "file_order": 22, "section_index": 8, "content_hash": "1fbf26c4beabd94c2b493b31e990da5b419b8f6b2ae853feee149861a0616ec1", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:4ea8f5c1512d8373772eb14ad1979265986bd9828924c6ab3b81e8c1eb35075f", "content": "The following classes have been converted to `Record`, you might need to adjust the use of getter methods from\n`getProp()` to `prop()`:\n\n* `org.springframework.data.elasticsearch.core.AbstractReactiveElasticsearchTemplate.IndexResponseMetaData`\n* `org.springframework.data.elasticsearch.core.ActiveShardCount`\n* `org.springframework.data.elasticsearch.support.Version`\n* `org.springframework.data.elasticsearch.support.ScoreDoc`\n* `org.springframework.data.elasticsearch.core.query.ScriptData`\n* `org.springframework.data.elasticsearch.core.query.SeqNoPrimaryTerm`\n\n[[elasticsearch-migration-guide-4.4-5.0.breaking-changes-http-headers]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Conversion to Java 17 records", "heading_level": 3, "file_order": 22, "section_index": 9, "content_hash": "4ea8f5c1512d8373772eb14ad1979265986bd9828924c6ab3b81e8c1eb35075f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:0a427536cd1f86f2a976bfd0a14ca6822cb77af2fe777e7e67902fdb52c417d0", "content": "Until version 4.4 the client configuration used the `HttpHeaders` class from the `org.springframework:spring-web`\nproject.\nThis introduces a dependency on that artifact.\nUsers that do not use spring-web then face an error as this class cannot be found.\n\nIn version 5.0 we introduce our own `HttpHeaders` to configure the clients.\n\nSo if you are using headers in the client configuration, you need to replace `org.springframework.http.HttpHeaders`\nwith `org.springframework.data.elasticsearch.support.HttpHeaders`.\n\nHint: You can pass a `org.springframework.http\n.HttpHeaders` to the `addAll()` method of `org.springframework.data.elasticsearch.support.HttpHeaders`.\n\n[[elasticsearch-migration-guide-4.4-5.0.new-clients]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "New HttpHeaders class", "heading_level": 3, "file_order": 22, "section_index": 10, "content_hash": "0a427536cd1f86f2a976bfd0a14ca6822cb77af2fe777e7e67902fdb52c417d0", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:7f7398afdec766e7782f5bcd99d47394eea44100150543d6f80945f9cf05b9b7", "content": "Spring Data Elasticsearch now uses the new `ElasticsearchClient` and has deprecated the use of the previous `RestHighLevelClient`.\n\n[[elasticsearch-migration-guide-4.4-5.0.new-clients.imperative]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "New Elasticsearch client", "heading_level": 2, "file_order": 22, "section_index": 11, "content_hash": "7f7398afdec766e7782f5bcd99d47394eea44100150543d6f80945f9cf05b9b7", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:ad8c6892f0b6ed47f1f6f43fb3803db0334f873ac9d3c3698bb5b520fe430bd2", "content": "To configure Spring Data Elasticsearch to use the new client, it is necessary to create a configuration bean that derives from `org.springframework.data.elasticsearch.client.elc.ElasticsearchConfiguration`:\n\n====\n[source,java]\n----\n@Configuration\npublic class NewRestClientConfig extends ElasticsearchConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() //\n .connectedTo(\"localhost:9200\") //\n .build();\n\t}\n}\n----\n====\n\nThe configuration is done in the same way as with the old client, but it is not necessary anymore to create more than the configuration bean.\nWith this configuration, the following beans will be available in the Spring application context:\n\n* a `RestClient` bean, that is the configured low level `RestClient` that is used by the Elasticsearch client\n* an `ElasticsearchClient` bean, this is the new client that uses the `RestClient`\n* an `ElasticsearchOperations` bean, available with the bean names _elasticsearchOperations_ and _elasticsearchTemplate_, this uses the `ElasticsearchClient`\n\n[[elasticsearch-migration-guide-4.4-5.0.new-clients.reactive]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Imperative style configuration", "heading_level": 3, "file_order": 22, "section_index": 12, "content_hash": "ad8c6892f0b6ed47f1f6f43fb3803db0334f873ac9d3c3698bb5b520fe430bd2", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:9f3f48a6ec8bc1ae62bd43f679a056d9d92e067fe1854ec1674601863accf301", "content": "To use the new client in a reactive environment the only difference is the class from which to derive the configuration:\n\n====\n[source,java]\n----\n@Configuration\npublic class NewRestClientConfig extends ReactiveElasticsearchConfiguration {\n\n\t@Override\n\tpublic ClientConfiguration clientConfiguration() {\n return ClientConfiguration.builder() //\n .connectedTo(\"localhost:9200\") //\n .build();\n\t}\n}\n----\n====\n\nWith this configuration, the following beans will be available in the Spring application context:\n\n* a `RestClient` bean, that is the configured low level `RestClient` that is used by the Elasticsearch client\n* an `ReactiveElasticsearchClient` bean, this is the new reactive client that uses the `RestClient`\n* an `ReactiveElasticsearchOperations` bean, available with the bean names _reactiveElasticsearchOperations_ and _reactiveElasticsearchTemplate_, this uses the `ReactiveElasticsearchClient`\n\n[[elasticsearch-migration-guide-4.4-5.0.old-client]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Reactive style configuration", "heading_level": 3, "file_order": 22, "section_index": 13, "content_hash": "9f3f48a6ec8bc1ae62bd43f679a056d9d92e067fe1854ec1674601863accf301", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:228dbf1d82b8c9b40fdc5a159f6107043d59dbedb301c4b4b415b452ee5bc7e9", "content": "The old deprecated `RestHighLevelClient` can still be used, but you will need to add the dependency explicitly to your application as Spring Data Elasticsearch does not pull it in automatically anymore:\n\n====\n[source,xml]\n----\n<!-- include the RHLC, specify version explicitly\t-->\n<dependency>\n\t<groupId>org.elasticsearch.client</groupId>\n\t<artifactId>elasticsearch-rest-high-level-client</artifactId>\n\t<version>7.17.5</version>\n\t<exclusions>\n <exclusion>\n <groupId>commons-logging</groupId>\n <artifactId>commons-logging</artifactId>\n </exclusion>\n\t</exclusions>\n</dependency>\n----\n====\n\nMake sure to specify the version 7.17.6 explicitly, otherwise maven will resolve to 8.5.0, and this does not exist.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc", "title": "migration-guide-4.4-5.0", "heading": "Still want to use the old client?", "heading_level": 3, "file_order": 22, "section_index": 14, "content_hash": "228dbf1d82b8c9b40fdc5a159f6107043d59dbedb301c4b4b415b452ee5bc7e9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-4.4-5.0.adoc"}}
{"id": "sha256:554bcdebd10c3bfa9bffadaa6c2e4d6f5e8586152bd99d37e169bd72458b83ad", "content": "[[elasticsearch-migration-guide-5.0-5.1]]\n\nThis section describes breaking changes from version 5.0.x to 5.1.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-5.0-5.1.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc", "title": "migration-guide-5.0-5.1", "heading": "migration-guide-5.0-5.1", "heading_level": 1, "file_order": 23, "section_index": 0, "content_hash": "554bcdebd10c3bfa9bffadaa6c2e4d6f5e8586152bd99d37e169bd72458b83ad", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc"}}
{"id": "sha256:84a0883076dee9331ea1e1ee01b2cf2a640dae05cd0b0f202110321b0670f175", "content": "In the `org.springframework.data.elasticsearch.core.index.AliasData` class, which is used for alias information returned from Elasticsearch, the property `filter` (of type `Document`) is replaced by `filterQuery` which is of type\n`org.springframework.data.elasticsearch.core.query.Query`.\n\n`org.springframework.data.elasticsearch.annotations.Similarity` was an enum class until 5.1. This enum was used in the `@Field` annotation to specify a similarity value.\nBut besides the values defined by the enum, it is possible to have similarities with custom names in Elasticsearch.\nTherefore, the annotation property was changed from the type of the enum to a simple `String`.\nThe previous enum values like `Similarity.Default` do still exist as String constants, so existing code will compile unmodified.\nAdaptions are necessary when this enum was used at other places than as a property of the `@Field` annotation.\n\n[[elasticsearch-migration-guide-5.0-5.1.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc", "title": "migration-guide-5.0-5.1", "heading": "Breaking Changes", "heading_level": 2, "file_order": 23, "section_index": 1, "content_hash": "84a0883076dee9331ea1e1ee01b2cf2a640dae05cd0b0f202110321b0670f175", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc"}}
{"id": "sha256:464db0ed9c5814dd42feb8c479f5042ae28286b986bb1064f3c37ec05392062d", "content": "[[template-functions]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc", "title": "migration-guide-5.0-5.1", "heading": "Deprecations", "heading_level": 2, "file_order": 23, "section_index": 2, "content_hash": "464db0ed9c5814dd42feb8c479f5042ae28286b986bb1064f3c37ec05392062d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc"}}
{"id": "sha256:463b86023108339131dccdd485daec27c975d2eb311384bce9e1b013aba85f65", "content": "The functions in the `IndexOperations` and `ReactiverIndexOperations` to manage index templates that were introduced in Spring Data Elasticsearch 4.1\nhave been deprecated. They were using the old Elasticsearch API that was deprecated in Elasticsearch version 7.8.\n\nPlease use the new functions that are based on the composable index template API instead.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc", "title": "migration-guide-5.0-5.1", "heading": "template functions", "heading_level": 3, "file_order": 23, "section_index": 3, "content_hash": "463b86023108339131dccdd485daec27c975d2eb311384bce9e1b013aba85f65", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.0-5.1.adoc"}}
{"id": "sha256:dd32bd88c3ab928f92562043cd063750d117cc13a400299a1eea7cfdd43b62e9", "content": "[[elasticsearch-migration-guide-5.1-5.2]]\n\nThis section describes breaking changes from version 5.1.x to 5.2.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-5.1-5.2.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc", "title": "migration-guide-5.1-5.2", "heading": "migration-guide-5.1-5.2", "heading_level": 1, "file_order": 24, "section_index": 0, "content_hash": "dd32bd88c3ab928f92562043cd063750d117cc13a400299a1eea7cfdd43b62e9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc"}}
{"id": "sha256:43749c19b03bd3662d43026d678a50f33f984c1426ec4ac027767fdefe0a0cac", "content": "[[bulk-failures]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc", "title": "migration-guide-5.1-5.2", "heading": "Breaking Changes", "heading_level": 2, "file_order": 24, "section_index": 1, "content_hash": "43749c19b03bd3662d43026d678a50f33f984c1426ec4ac027767fdefe0a0cac", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc"}}
{"id": "sha256:a2e7360311b2826adbebf7beb4e3569251fed0faa1fb9837dce884d446db66bb", "content": "In the `org.springframework.data.elasticsearch.BulkFailureException` class, the return type of the `getFailedDocuments` is changed from `Map<String, String>`\nto `Map<String, FailureDetails>`, which allows to get additional details about failure reasons.\n\nThe definition of the `FailureDetails` class (inner to `BulkFailureException`):\n[source,java]\npublic record FailureDetails(Integer status, String errorMessage) {\n}\n\n[[scripted-and-runtime-fields]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc", "title": "migration-guide-5.1-5.2", "heading": "Bulk failures", "heading_level": 3, "file_order": 24, "section_index": 2, "content_hash": "a2e7360311b2826adbebf7beb4e3569251fed0faa1fb9837dce884d446db66bb", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc"}}
{"id": "sha256:e45a7b911ce6260d3e6561b1a1c5c03a47e6dd3165639903a496cd71b09cc67d", "content": "The classes `org.springframework.data.elasticsearch.core.RuntimeField` and `org.springframework.data.elasticsearch.core.query.ScriptType` have been moved to the subpackage `org.springframework.data.elasticsearch.core.query`.\n\nThe `type` parameter of the `ScriptData` constructor is not nullable any longer.\n\n[[elasticsearch-migration-guide-5.1-5.2.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc", "title": "migration-guide-5.1-5.2", "heading": "scripted and runtime fields", "heading_level": 3, "file_order": 24, "section_index": 3, "content_hash": "e45a7b911ce6260d3e6561b1a1c5c03a47e6dd3165639903a496cd71b09cc67d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc"}}
{"id": "sha256:2925dc86ab351308af7f961546acb28d93b7fe9f5b7690dbfd57487823c06f1b", "content": "[[removal-of-deprecated-code]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc", "title": "migration-guide-5.1-5.2", "heading": "Deprecations", "heading_level": 2, "file_order": 24, "section_index": 4, "content_hash": "2925dc86ab351308af7f961546acb28d93b7fe9f5b7690dbfd57487823c06f1b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc"}}
{"id": "sha256:7eb01d9bd675e99fff522510a3806e44e9cc6f147f6b6657a05955b9b67419b1", "content": "* All the code using the old deprecated `RestHighLevelClient` has been removed.\nThe default Elasticsearch client used since version 5.0 is the (not so) new Elasticsearch Java client.\n* The `org.springframework.data.elasticsearch.client.ClientLogger` class has been removed.\nThis logger was configured with the `org.springframework.data.elasticsearch.client.WIRE` setting, but was not working with all clients.\nFrom version 5 on, use the trace logger available in the Elasticsearch Java client, see xref:elasticsearch/clients.adoc#elasticsearch.clients.logging[Client Logging].\n* The method `org.springframework.data.elasticsearch.core.ElasticsearchOperations.stringIdRepresentation(Object)` has been removed, use the `convertId(Object)` method defined in the same interface instead.\n* The class `org.springframework.data.elasticsearch.core.Range` has been removed, use `org.springframework.data.domain.Range` instead.\n* The methods `org.springframework.data.elasticsearch.core.query.IndexQuery.getParentId() and `setParentId(String)` have been removed, they weren't used anymore and were no-ops.\nIt has been removed from the `org.springframework.data.elasticsearch.core.query.IndexQuery` class as well.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc", "title": "migration-guide-5.1-5.2", "heading": "Removal of deprecated code", "heading_level": 3, "file_order": 24, "section_index": 5, "content_hash": "7eb01d9bd675e99fff522510a3806e44e9cc6f147f6b6657a05955b9b67419b1", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.1-5.2.adoc"}}
{"id": "sha256:e3fd3c5aeebf74762e3ba64e42c6d0db6b73076b6466797a22511d0fbc48d11b", "content": "[[elasticsearch-migration-guide-5.2-5.3]]\n\nThis section describes breaking changes from version 5.2.x to 5.3.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-5.2-5.3.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.2-5.3.adoc", "title": "migration-guide-5.2-5.3", "heading": "migration-guide-5.2-5.3", "heading_level": 1, "file_order": 25, "section_index": 0, "content_hash": "e3fd3c5aeebf74762e3ba64e42c6d0db6b73076b6466797a22511d0fbc48d11b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.2-5.3.adoc"}}
{"id": "sha256:c2a7df95efda027bd2a4718c2b56036b18a212b61937d315c2322baca62b54a5", "content": "During the parameter replacement in `@Query` annotated repository methods previous versions wrote the String `\"null\"` into the query that was sent to Elasticsearch when the actual parameter value was `null`.\nAs Elasticsearch does not store `null` values, this behaviour could lead to problems, for example whent the fields to be searched contains the string `\"null\"`.\nIn Version 5.3 a `null` value in a parameter will cause a `ConversionException` to be thrown.\nIf you are using `\"null\"` as the\n`null_value` defined in a field mapping, then pass that string into the query instead of a Java `null`.\n\n[[elasticsearch-migration-guide-5.2-5.3.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.2-5.3.adoc", "title": "migration-guide-5.2-5.3", "heading": "Breaking Changes", "heading_level": 2, "file_order": 25, "section_index": 1, "content_hash": "c2a7df95efda027bd2a4718c2b56036b18a212b61937d315c2322baca62b54a5", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.2-5.3.adoc"}}
{"id": "sha256:72ffe854a829e33adaaee8e3e287fa65a9553d073dcec42522d7adb204d018db", "content": "The deprecated classes `org.springframework.data.elasticsearch.ELCQueries`\nand `org.springframework.data.elasticsearch.client.elc.QueryBuilders` have been removed, use `org.springframework.data.elasticsearch.client.elc.Queries` instead.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.2-5.3.adoc", "title": "migration-guide-5.2-5.3", "heading": "Removals", "heading_level": 3, "file_order": 25, "section_index": 2, "content_hash": "72ffe854a829e33adaaee8e3e287fa65a9553d073dcec42522d7adb204d018db", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.2-5.3.adoc"}}
{"id": "sha256:63d30723015ec12fea6b24dea1348723a6c6bb682f08cd8d0a66bd32a7c61f4b", "content": "[[elasticsearch-migration-guide-5.3-5.4]]\n\nThis section describes breaking changes from version 5.3.x to 5.4.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-5.3-5.4.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.3-5.4.adoc", "title": "migration-guide-5.3-5.4", "heading": "migration-guide-5.3-5.4", "heading_level": 1, "file_order": 26, "section_index": 0, "content_hash": "63d30723015ec12fea6b24dea1348723a6c6bb682f08cd8d0a66bd32a7c61f4b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.3-5.4.adoc"}}
{"id": "sha256:a38f09899424f2be268738759cc0ff84a3de8475c3425fe9d454f66c205d7ec9", "content": "[[elasticsearch-migration-guide-5.3-5.4.breaking-changes.knn-search]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.3-5.4.adoc", "title": "migration-guide-5.3-5.4", "heading": "Breaking Changes", "heading_level": 2, "file_order": 26, "section_index": 1, "content_hash": "a38f09899424f2be268738759cc0ff84a3de8475c3425fe9d454f66c205d7ec9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.3-5.4.adoc"}}
{"id": "sha256:64dfda1d6c54d32c3478cc24b01b5bd1122974277c15efb50afdc880f60f31d2", "content": "The `withKnnQuery` method in `NativeQueryBuilder` has been replaced with `withKnnSearches` to build a `NativeQuery` with knn search.\n\n`KnnQuery` and `KnnSearch` are two different classes in elasticsearch java client and are used for different queries, with different parameters supported:\n\n- `KnnSearch`: is https://www.elastic.co/guide/en/elasticsearch/reference/8.13/search-search.html#search-api-knn[the top level `knn` query] in the elasticsearch request;\n- `KnnQuery`: is https://www.elastic.co/guide/en/elasticsearch/reference/current/query-dsl-knn-query.html[the `knn` query inside `query` clause];\n\nIf `KnnQuery` is still preferable, please be sure to construct it inside `query` clause manually, by means of `withQuery(co.elastic.clients.elasticsearch._types.query_dsl.Query query)` clause in `NativeQueryBuilder`.\n\n[[elasticsearch-migration-guide-5.3-5.4.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.3-5.4.adoc", "title": "migration-guide-5.3-5.4", "heading": "knn search", "heading_level": 3, "file_order": 26, "section_index": 2, "content_hash": "64dfda1d6c54d32c3478cc24b01b5bd1122974277c15efb50afdc880f60f31d2", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.3-5.4.adoc"}}
{"id": "sha256:f851d7c54f93a8366f3561eaf1ae467f804ba4a5672817b1e0aa9d72dd813e98", "content": "[[elasticsearch-migration-guide-5.4-5.5]]\n\nThis section describes breaking changes from version 5.4.x to 5.5.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-5.4-5.5.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc", "title": "migration-guide-5.4-5.5", "heading": "migration-guide-5.4-5.5", "heading_level": 1, "file_order": 27, "section_index": 0, "content_hash": "f851d7c54f93a8366f3561eaf1ae467f804ba4a5672817b1e0aa9d72dd813e98", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc"}}
{"id": "sha256:a5c2aefbfdfa6345a139f292e0728b4bfdf13b4096ddad82ef8d66871c6b337b", "content": "[[elasticsearch-migration-guide-5.4-5.5.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc", "title": "migration-guide-5.4-5.5", "heading": "Breaking Changes", "heading_level": 2, "file_order": 27, "section_index": 1, "content_hash": "a5c2aefbfdfa6345a139f292e0728b4bfdf13b4096ddad82ef8d66871c6b337b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc"}}
{"id": "sha256:5346cf55368c1aa34e654a324fc162a2729ea4ae1ae153e80de45c8643a7892f", "content": "Some classes that probably are not used by a library user have been renamed, the classes with the old names are still there, but are deprecated:\n\n|===\n|old name|new name\n\n|ElasticsearchPartQuery|RepositoryPartQuery\n|ElasticsearchStringQuery|RepositoryStringQuery\n|ReactiveElasticsearchStringQuery|ReactiveRepositoryStringQuery\n|===", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc", "title": "migration-guide-5.4-5.5", "heading": "Deprecations", "heading_level": 2, "file_order": 27, "section_index": 2, "content_hash": "5346cf55368c1aa34e654a324fc162a2729ea4ae1ae153e80de45c8643a7892f", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc"}}
{"id": "sha256:8a1bb731771d630562ea048e5270f9472aaebd3447955bd9b9ff5aa7a8685cc2", "content": "The following methods that had been deprecated since release 5.3 have been removed:\n```\nDocumentOperations.delete(Query, Class<?>)\nDocumentOperations.delete(Query, Class<?>, IndexCoordinates)\nReactiveDocumentOperations.delete(Query, Class<?>)\nReactiveDocumentOperations.delete(Query, Class<?>, IndexCoordinates)\n```", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc", "title": "migration-guide-5.4-5.5", "heading": "Removals", "heading_level": 3, "file_order": 27, "section_index": 3, "content_hash": "8a1bb731771d630562ea048e5270f9472aaebd3447955bd9b9ff5aa7a8685cc2", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.4-5.5.adoc"}}
{"id": "sha256:2399934b4e1730b981950b94c2e05df1ee100b8b5684674e85c78b300408ec52", "content": "[[elasticsearch-migration-guide-5.5-6.0]]\n\nThis section describes breaking changes from version 5.5.x to 6.0.x and how removed features can be replaced by new introduced features.\n\n[[elasticsearch-migration-guide-5.5-6.0.breaking-changes]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc", "title": "migration-guide-5.5-6.0", "heading": "migration-guide-5.5-6.0", "heading_level": 1, "file_order": 28, "section_index": 0, "content_hash": "2399934b4e1730b981950b94c2e05df1ee100b8b5684674e85c78b300408ec52", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc"}}
{"id": "sha256:a45f8ed2b9288bc0c18c25716b95c4be904e11116b1f734e511c4161a979e768", "content": "From version 6.0 on, Spring Data Elasticsearch uses the Elasticsearch 9 libraries and as default the new `Rest5Client` provided by these libraries. It is still possible to use the old `RestClient`, check xref:elasticsearch/clients.adoc[Elasticsearch clients] for information. The configuration callbacks for this `RestClient` have been moved from `org.springframework.data.elasticsearch.client.elc.ElasticsearchClients` to the `org.springframework.data.elasticsearch.client.elc.rest_client.RestClients` class.\n\nIn the `org.springframework.data.elasticsearch.core.query.UpdateQuery` class the type of the two fields `ifSeqNo` and `ifPrimaryTerm` has changed from `Integer` to `Long` to align with the normal query and the underlying Elasticsearch client.\n\n[[elasticsearch-migration-guide-5.5-6.0.deprecations]]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc", "title": "migration-guide-5.5-6.0", "heading": "Breaking Changes", "heading_level": 2, "file_order": 28, "section_index": 1, "content_hash": "a45f8ed2b9288bc0c18c25716b95c4be904e11116b1f734e511c4161a979e768", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc"}}
{"id": "sha256:4cece51d7f9cb4994d613a56110488e66efbee1ec2f49ba764cc96560580731e", "content": "All the code using the old `RestClient` has been moved to the `org.springframework.data.elasticsearch.client.elc.rest_client` package and has been deprecated. Users should switch to the classes from the `org.springframework.data.elasticsearch.client.elc.rest5_client` package.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc", "title": "migration-guide-5.5-6.0", "heading": "Deprecations", "heading_level": 2, "file_order": 28, "section_index": 2, "content_hash": "4cece51d7f9cb4994d613a56110488e66efbee1ec2f49ba764cc96560580731e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc"}}
{"id": "sha256:e6de00f6aa875f5a6887166bc2d8ef11afa42e5c2f28fabdc4b4885dba7c592e", "content": "The `org.springframework.data.elasticsearch.core.query.ScriptType` enum has been removed. To distinguish between an inline and a stored script set the appropriate values in the `org.springframework.data.elasticsearch.core.query.ScriptData` record.\n\nThese methods have been removed because the Elasticsearch Client 9 does not support them anymore:\n```\norg.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchIndicesClient.unfreeze(UnfreezeRequest)\norg.springframework.data.elasticsearch.client.elc.ReactiveElasticsearchIndicesClient.unfreeze(Function<UnfreezeRequest.Builder, ObjectBuilder<UnfreezeRequest>>)\n```", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc", "title": "migration-guide-5.5-6.0", "heading": "Removals", "heading_level": 3, "file_order": 28, "section_index": 3, "content_hash": "e6de00f6aa875f5a6887166bc2d8ef11afa42e5c2f28fabdc4b4885dba7c592e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides/migration-guide-5.5-6.0.adoc"}}
{"id": "sha256:14a396628065ecab7f160ee6afcf79b47510686a23aaedaba5c4b7d7307ee650", "content": "include::{commons}@data-commons::page$repositories/core-concepts.adoc[]\n\n[[elasticsearch.entity-persistence.state-detection-strategies]]\ninclude::{commons}@data-commons::page$is-new-state-detection.adoc[leveloffset=+1]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/core-concepts.adoc", "title": "core-concepts", "heading": "core-concepts", "heading_level": 1, "file_order": 29, "section_index": 0, "content_hash": "14a396628065ecab7f160ee6afcf79b47510686a23aaedaba5c4b7d7307ee650", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/core-concepts.adoc"}}
{"id": "sha256:81e019ce75dee61eea59094a236a3871f4c9af62f0fcd3a5c7a87af4b30030f9", "content": "include::{commons}@data-commons::page$repositories/core-domain-events.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/core-domain-events.adoc", "title": "core-domain-events", "heading": "core-domain-events", "heading_level": 1, "file_order": 30, "section_index": 0, "content_hash": "81e019ce75dee61eea59094a236a3871f4c9af62f0fcd3a5c7a87af4b30030f9", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/core-domain-events.adoc"}}
{"id": "sha256:64aa7d024c0d4411af2a39c72ec3db2ed9b849e1a6db2f27c6bebd29fb12b71b", "content": "include::{commons}@data-commons::page$repositories/core-extensions.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/core-extensions.adoc", "title": "core-extensions", "heading": "core-extensions", "heading_level": 1, "file_order": 31, "section_index": 0, "content_hash": "64aa7d024c0d4411af2a39c72ec3db2ed9b849e1a6db2f27c6bebd29fb12b71b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/core-extensions.adoc"}}
{"id": "sha256:bac28174cb786cac49ffd811dcd631b892f0813fc0fc9743e93def55346e1e58", "content": "include::{commons}@data-commons::page$repositories/create-instances.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/create-instances.adoc", "title": "create-instances", "heading": "create-instances", "heading_level": 1, "file_order": 32, "section_index": 0, "content_hash": "bac28174cb786cac49ffd811dcd631b892f0813fc0fc9743e93def55346e1e58", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/create-instances.adoc"}}
{"id": "sha256:bcf8fe4d0728082fd278624d23223ff29157e4fb465061471d2d50f2f401bc0d", "content": "include::{commons}@data-commons::page$repositories/custom-implementations.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/custom-implementations.adoc", "title": "custom-implementations", "heading": "custom-implementations", "heading_level": 1, "file_order": 33, "section_index": 0, "content_hash": "bcf8fe4d0728082fd278624d23223ff29157e4fb465061471d2d50f2f401bc0d", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/custom-implementations.adoc"}}
{"id": "sha256:661a93bfb9c9780b8bb205b092562b371e697955026e3abea11cc0abb0a3fc20", "content": "include::{commons}@data-commons::page$repositories/definition.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/definition.adoc", "title": "definition", "heading": "definition", "heading_level": 1, "file_order": 34, "section_index": 0, "content_hash": "661a93bfb9c9780b8bb205b092562b371e697955026e3abea11cc0abb0a3fc20", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/definition.adoc"}}
{"id": "sha256:8ca895bfddcd8ee24e8f9d5197f423b2399d74f11d14249d9f906762f4b72806", "content": "include::{commons}@data-commons::page$repositories/null-handling.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/null-handling.adoc", "title": "null-handling", "heading": "null-handling", "heading_level": 1, "file_order": 35, "section_index": 0, "content_hash": "8ca895bfddcd8ee24e8f9d5197f423b2399d74f11d14249d9f906762f4b72806", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/null-handling.adoc"}}
{"id": "sha256:65cdbeb87eebdc3626289d64eda172cf712b3eef3bf9e452d090eb402f843675", "content": "[[elasticsearch.projections]]\n\ninclude::{commons}@data-commons::page$repositories/projections.adoc[leveloffset=+1]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/projections.adoc", "title": "projections", "heading": "projections", "heading_level": 1, "file_order": 36, "section_index": 0, "content_hash": "65cdbeb87eebdc3626289d64eda172cf712b3eef3bf9e452d090eb402f843675", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/projections.adoc"}}
{"id": "sha256:7e953260056fa458d00ccd6d3916965e33c635a0e5a9c1068e6d4c915b4642be", "content": "include::{commons}@data-commons::page$repositories/query-keywords-reference.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/query-keywords-reference.adoc", "title": "query-keywords-reference", "heading": "query-keywords-reference", "heading_level": 1, "file_order": 37, "section_index": 0, "content_hash": "7e953260056fa458d00ccd6d3916965e33c635a0e5a9c1068e6d4c915b4642be", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/query-keywords-reference.adoc"}}
{"id": "sha256:2931a4be98bc609c2eb349faa7f3ea7d07742930fa4e31487a2957e5874e0633", "content": "include::{commons}@data-commons::page$repositories/query-methods-details.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/query-methods-details.adoc", "title": "query-methods-details", "heading": "query-methods-details", "heading_level": 1, "file_order": 38, "section_index": 0, "content_hash": "2931a4be98bc609c2eb349faa7f3ea7d07742930fa4e31487a2957e5874e0633", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/query-methods-details.adoc"}}
{"id": "sha256:8586bea837d1b2b190fc36059384044b5c88fe73a8012f0e6782feb992f85865", "content": "include::{commons}@data-commons::page$repositories/query-return-types-reference.adoc[]", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories/query-return-types-reference.adoc", "title": "query-return-types-reference", "heading": "query-return-types-reference", "heading_level": 1, "file_order": 39, "section_index": 0, "content_hash": "8586bea837d1b2b190fc36059384044b5c88fe73a8012f0e6782feb992f85865", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories/query-return-types-reference.adoc"}}
{"id": "sha256:8f55f2a387a7d3f506e9c69434fff8e909114f4b2b47b156411b3006531cd0fe", "content": "[[elasticsearch.core]]\n\nSpring Data support for Elasticsearch contains a wide range of features:\n\n* Spring configuration support for various xref:elasticsearch/clients.adoc[Elasticsearch clients].\n* The xref:elasticsearch/template.adoc[`ElasticsearchTemplate` and `ReactiveElasticsearchTemplate`] helper classes that provide object mapping between Elasticsearch index operations and POJOs.\n* xref:elasticsearch/template.adoc#exception-translation[Exception translation] into Spring's portable {springDocsUrl}data-access.html#dao-exceptions[Data Access Exception Hierarchy].\n* Feature rich xref:elasticsearch/object-mapping.adoc[object mapping] integrated with _Spring's_ {springDocsUrl}core.html#core-convert[Conversion Service].\n* xref:elasticsearch/object-mapping.adoc#elasticsearch.mapping.meta-model.annotations[Annotation-based mapping] metadata that is extensible to support other metadata formats.\n* Java-based xref:elasticsearch/template.adoc#cassandra.template.query[query, criteria, and update DSLs].\n* Automatic implementation of xref:repositories.adoc[imperative and reactive `Repository` interfaces] including support for xref:repositories/custom-implementations.adoc[custom query methods].\n\nFor most data-oriented tasks, you can use the `[Reactive]ElasticsearchTemplate` or the `Repository` support, both of which use the rich object-mapping functionality.\nSpring Data Elasticsearch uses consistent naming conventions on objects in various APIs to those found in the DataStax Java Driver so that they are familiar and so that you can map your existing knowledge onto the Spring APIs.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/elasticsearch.adoc", "title": "elasticsearch", "heading": "elasticsearch", "heading_level": 1, "file_order": 40, "section_index": 0, "content_hash": "8f55f2a387a7d3f506e9c69434fff8e909114f4b2b47b156411b3006531cd0fe", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/elasticsearch.adoc"}}
{"id": "sha256:6be194c63e2a32174b3dc0626808a6e3bd43b0cc2ab0a5263626b18b57c6a877", "content": "[[spring-data-elasticsearch-reference-documentation]]\n\n_Spring Data Elasticsearch provides repository support for the Elasticsearch database.\nIt eases development of applications with a consistent programming model that need to access Elasticsearch data sources._\n\n[horizontal]\nxref:elasticsearch/versions.adoc[Versions] :: Version Compatibility Matrix\nxref:elasticsearch/clients.adoc[Clients] :: Elasticsearch Client Configuration\nxref:elasticsearch.adoc[Elasticsearch] :: Elasticsearch support\nxref:repositories.adoc[Repositories] :: Elasticsearch Repositories\nxref:migration-guides.adoc[Migration] :: Migration Guides\nhttps://github.com/spring-projects/spring-data-commons/wiki[Wiki] :: What's New, Upgrade Notes, Supported Versions, additional cross-version information.\n\nBioMed Central Development Team; Oliver Drotbohm; Greg Turnquist; Christoph Strobl; Peter-Josef Meisch\n\n(C) 2008-{copyright-year} VMware, Inc.\n\nCopies of this document may be made for your own use and for distribution to others, provided that you do not charge any fee for such copies and further provided that each copy contains this Copyright Notice, whether distributed in print or electronically.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/index.adoc", "title": "index", "heading": "index", "heading_level": 1, "file_order": 41, "section_index": 0, "content_hash": "6be194c63e2a32174b3dc0626808a6e3bd43b0cc2ab0a5263626b18b57c6a877", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/index.adoc"}}
{"id": "sha256:a5f766f06aeb0f81ac1535f4838f30cdf8b7eec7daad8977a41df3680cdaa91e", "content": "[[elasticsearch.migration]]\n\nThis section contains version-specific migration guides explaining how to upgrade across versions.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/migration-guides.adoc", "title": "migration-guides", "heading": "migration-guides", "heading_level": 1, "file_order": 42, "section_index": 0, "content_hash": "a5f766f06aeb0f81ac1535f4838f30cdf8b7eec7daad8977a41df3680cdaa91e", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/migration-guides.adoc"}}
{"id": "sha256:1bcea358a56013ffa70ea649a80772d7557aca77df2e9b693b062a47f0c5144b", "content": "[[elasticsearch.repositories]]\n\nThis chapter explains the basic foundations of Spring Data repositories and Elasticsearch specifics.\nBefore continuing to the Elasticsearch specifics, make sure you have a sound understanding of the basic concepts.\n\nThe goal of the Spring Data repository abstraction is to significantly reduce the amount of boilerplate code required to implement data access layers for various persistence stores.", "metadata": {"source_type": "repo_asciidoc", "project": "spring-data-elasticsearch", "path": "antora/modules/ROOT/pages/repositories.adoc", "title": "repositories", "heading": "repositories", "heading_level": 1, "file_order": 43, "section_index": 0, "content_hash": "1bcea358a56013ffa70ea649a80772d7557aca77df2e9b693b062a47f0c5144b", "source_url": "https://github.com/spring-projects/spring-data-elasticsearch/blob/2c77df67c3f6054dbb0f2488d56aba01d1c0a5c8/src/main/antora/modules/ROOT/pages/repositories.adoc"}}
